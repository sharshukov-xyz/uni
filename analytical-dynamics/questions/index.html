<!DOCTYPE html>
<html>

  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>АДУС &mdash; 06 &mdash; Вопросы</title>

    <link href="/assets/css/styles.css" rel="stylesheet">
    <script defer src="/assets/js/core.js"></script>
    <script defer src="/assets/js/questions.js"></script>
    <script defer src="/assets/js/controls.js"></script>

    <link rel="stylesheet" href="/assets/katex/katex.min.css">
    <script defer src="/assets/katex/katex.min.js"></script>
    <script defer src="/assets/katex/auto-render.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false },
            { left: '\\(', right: '\\)', display: false },
            { left: '\\[', right: '\\]', display: true }
          ],
          // • rendering keys, e.g.:
          throwOnError: false
        });
      });
    </script>
  </head>

  <body>
    <h1 id="title">АДУС &mdash; 06 &mdash; Вопросы</h1>
    <nav>
      <a href="/">Домой</a>
      <a href="..">АДУС</a>
      <a href="/links">Ссылки</a>
      <a href="/about">Контакты</a>
    </nav>

    <div class="controls">
      <button onclick="HideQuestions()">Скрыть вопросы</button>
      <button onclick="ShowQuestions()">Показать вопросы</button>
      <button onclick="HideAnswers()">Скрыть ответы</button>
      <button onclick="ShowAnswers()">Показать ответы</button>
      <button onclick="HideProofs()">Скрыть доказательства</button>
      <button onclick="ShowProofs()">Показать доказательства</button>
      <button onclick="ShowRandomElement(HideQuestions)">
        Показать случайный вопрос
      </button>
    </div>

    <div class="proof-type">
      Показывать
      <select id="select-proof-type" name="select-proof-type">
        <option value="proofs">доказательства полностью</option>
        <option value="ideas">только идеи доказательств</option>
      </select>
    </div>

    <div style="display:none">
      $\global\def\at#1#2{\left. #1 \right\rvert_{#2}}$
      $\global\def\abs#1{\left\lvert #1 \right\rvert}$
      $\global\def\norm#1{\left\lVert #1 \right\rVert}$
      $\global\def\bvec#1{\mathbf{#1}}$
      $\global\def\floor#1{\left\lfloor #1 \right\rfloor}$

      $\global\def\limto#1{\underset{#1}{\longrightarrow}}$
      $\global\def\prob#1{\mathbb{P} \left\{ #1 \right\}}$
      $\global\def\mean#1{\mathbb{E} \left[ #1 \right]}$
      $\global\def\disp#1{D \left[ #1 \right]}$

      $\global\def\dp#1#2{#1 \cdot #2\,}$
      $\global\def\vp#1#2{#1 \times #2\,}$

      $\global\def\dv#1#2{\frac{d #1}{d #2}}$
      $\global\def\rdv#1#2{\frac{d' #1}{d #2}}$ <!-- относительная производная -->
      $\global\def\pd#1#2{\frac{\partial #1}{\partial #2}}$
      $\global\def\pdv2#1#2{\frac{\partial^2 #1}{\partial #2^2}}$
      $\global\def\pdvk#1#2#3{\frac{\partial^#1 #2}{\partial #3^#1}}$
      $\global\def\ppdv#1#2#3{\frac{\partial^2 #1}{\partial #2 \partial #3}}$

      $\global\def\pois#1{\left\{ #1 \right\}}$
      $\global\def\paren#1{\left( #1 \right)}$
      $\global\def\bydef#1{\overset{\mathrm{def}}{#1}}$

      $\global\def\mbox#1{\text{#1}}$

      $\global\def\div{\text{div}\,}$
      $\global\def\dsum{\displaystyle\sum\,}$
      $\global\def\grad{\text{grad}\,}$
      $\global\def\rot{\text{rot}\,}$

      $\global\def\vb#1{\textbf{#1}}$

      $\global\def\op#1{\mathrm{#1}\,}$

      $\global\def\Im{\text{Im}\,}$
      $\global\def\Res{\text{Res}\,}$
      $\global\def\Re{\text{Re}\,}$
      $\global\def\argtg{\text{argtg}\,}$
      $\global\def\ch{\text{ch}\,}$
      $\global\def\const{\text{const}\,}$
      $\global\def\degree{\text{degree}\,}$
      $\global\def\proj{\operatorname{proj}}$
      $\global\def\rank{\operatorname{rank}}$
      $\global\def\res{\text{res}\,}$
      $\global\def\sh{\text{sh}\,}$
      $\global\def\sign{\operatorname{sign}}$
      $\global\def\tg{\operatorname{tg}}$

      <!-- эллиптические функции -->
      $\global\def\am{\operatorname{am}}$
      $\global\def\sn{\operatorname{sn}}$
      $\global\def\cn{\operatorname{cn}}$
      $\global\def\dn{\operatorname{dn}}$
    </div>

    <ol id="questions">
      <li class="question">
        <div class="name">
          Классификация связей
        </div>
        <div class="content">
          Рассмотрим произвольную систему $n$ материальных точек $M_i$ с
          обобщёнными координатами $q_1, \dots, q_r$.

          <div class="definition">
            Если материальная система не свободна, то её обобщённые координаты
            $q_1, \dots, q_r$, так же как и обобщённые скорости $\dot q_1,
            \dots, \dot q_r$, подчиняются ограничительным условиям, которые
            называют <i>связями</i>.
          </div>

          <div class="definition">
            Связи, выражаемые аналитические уравнениями вида
            \[
            \begin{aligned}
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r) &= 0 \\
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r)
            &\leqslant 0 \\
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r)
            &\geqslant 0,
            \end{aligned}
            \]
            называют <i>кинематическими</i>.
          </div>

          <div class="definition">
            Если время не входит явно в уравнения связей, то такие связи
            называют <i>стационарными</i>, в противном случае &mdash;
            <i>нестационарными</i>.
          </div>

          <div class="definition">
            Кинематические связи, уравнения которых не содержат обобщённых
            скоростей или путём интегрирования могут быть к такому виду
            приведены, называют <i>голономными</i>, в противном случае &mdash;
            <i>неголономными</i>.
          </div>

          <div class="definition">
            Связи, заданные неравенствами
            \[
            \begin{aligned}
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r)
            &\leqslant 0 \\
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r)
            &\geqslant 0,
            \end{aligned}
            \]
            называют <i>освобождающими</i> (<i>неудерживающими,
              односторонними</i>).
            <br><br>
            Связи, заданные равенствами
            \[
            \Phi_\alpha (t; q_1, \dots, q_r; \dot q_1, \dots, \dot q_r) = 0,
            \]
            называют <i>неосвобождающими</i> (<i>удерживающими,
              двусторонними</i>).
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: истинное перемещение, виртуальное перемещение
        </div>
        <div class="content">
          Рассмотрим бесконечно малые перемещения точек системы, совместимые со
          связями, наложенными на эту систему.

          <div class="definition">
            Перемещения точек системы, осуществляемые за данный бесконечно малый
            промежуток времени точками несвободной системы в их действительном
            движении под действием приложенных сил, называют <i>истинными</i>
            (<i>действительными</i>).

            <div class="notation">
              $d\bvec{r}(t), dx, dy, dz, dt$.
            </div>
          </div>

          Если связи нестационарны, то бесконечно малые перемещения точек
          системы можно представить себе разложенными на два слагаемых:
          <ol>
            <li>
              совместимые со связями бесконечно малые перемещения, которые имели
              бы место, если бы связи на мгновение перестали изменяться;
            </li>

            <li>
              перемещения, обусловленные изменением самих связей.
            </li>
          </ol>

          <div class="definition">
            Бесконечно малые перемещения точек системы, совместимые со связями,
            зафиксированными в данный момент времени, называют
            <i>виртуальными</i>.

            <div class="notation">
              $\delta \bvec{r}(t), \delta x, \delta y, \delta z$.
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          При каких условиях истинные перемещения совпадают с виртуальными?
        </div>
        <div class="content">
          <div class="statement">
            Истинные перемещения совпадают с виртуальными, если связи
            стационарны.

            <div class="proof">
              <p>
              Рассмотрим несвободную систему с удерживающей связью
              \[
              f(x,y,z,t) = 0.
              \]

              По определению виртуального перемещения, оно должно удовлетворять
              этой связи, то есть
              \[
              f(x + \delta x, y + \delta y, z + \delta z, t) = 0.
              \]

              Рассмотрим разложение функции
              $f(x + \delta x, y + \delta y, z + \delta z, t)$ в ряд в
              окрестности точки $0$:
              \[
              f(x, y, z, t) + \pd{f}{x}\delta x + \pd{f}{y} \delta y
              + \pd{f}{z} \delta z + \cdots = 0.
              \]
              Отбрасывая члены высшего порядка малости (в силу того, что
              $\delta x, \delta y, \delta z$ &mdash; бесконечно малые
              перемещения) и учитывая, что $f(x,y,z,t) = 0$ для любых $x,y,z,t$,
              получаем, что
              \[
              \pd{f}{x}\delta x + \pd{f}{y} \delta y + \pd{f}{z} \delta z = 0.
              \]
              </p>

              <p>
              Рассмотрим теперь истинное перемещение. Для него так же
              \[
              f(x + dx, y + dy, z + dz, t + dt) = 0.
              \]
              Разложение в ряд в окрестности точки 0:
              \[
              f(x, y, z, t) + \pd{f}{x} dx + \pd{f}{y} dy + \pd{f}{z} dz
              + \pd{f}{t} dt + \cdots = 0.
              \]
              Пользуясь аналогичными рассуждениями, приходим к равенству
              \[
              \pd{f}{x} dx + \pd{f}{y} dy + \pd{f}{z} dz + \pd{f}{t} dt = 0.
              \]

              Нетрудно видеть, что если связь стационарная, то
              ${\displaystyle \pd{f}{t} = 0}$, а предыдущее уравнение принимает
              вид
              \[
              \pd{f}{x} dx + \pd{f}{y} dy + \pd{f}{z} dz = 0.
              \]
              </p>
            </div>
          </div>

          <div class="remark">
            Из равенства
            \[
            \pd{f}{x} \delta x + \pd{f}{y} \delta y + \pd{f}{z} \delta z = 0
            \]
            следует, что только две вариации могут быть независимыми.
          </div>

          <div class="remark">
            Данное утверждение верно и для системы из $n$ материальных точек; в
            этом случае разложение в ряд примет вид
            \[
            \pd{f}{t} dt + \sum_{i=1}^n \paren{
            \pd{f}{x_i} dx_i + \pd{f}{y_i} dy_i + \pd{f}{z_i} dz_i
            } = 0.
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: реакции связей
        </div>
        <div class="content">
          <div class="definition">
            Ограничивая свободу движения системы, связи действуют на точки
            системы посредством сил, называемых <i>реакциями связей</i>.
          </div>

          <div class="definition">
            Силы, приложенные к точкам несвободной системы, называют
            <i>активными</i>, а реакции связей &mdash; <i>реактивными
            силами</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: идеальная связь
        </div>
        <div class="content">
          Рассмотрим систему из $N$ материальных точек, подчинённую $m$ связям.
          Обозначим равнодействующую всех реактивных сил, действующих на $j$-ую
          точку, как $\bvec{R}_j$.

          <div class="definition">
            <i>Идеальными связями</i> называют такие связи, сумма элементарных
            работ реакций которых на любом виртуальном перемещении системы равна
            нулю:
            \[
            \sum_{j=1}^N \bvec{R}_j \cdot \delta \bvec{r}_j = 0.
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Общее уравнение механики
        </div>
        <div class="content">
          Рассмотрим несвободную систему из $N$ материальных точек массами
          $m_j$. Составим уравнения движения системы:
          \[
          m_j \dv{\bvec{v}_j}{t} = \bvec{F}_j + \bvec{R}_j,
          \]
          где
          <ul>
            <li>
              $\bvec{F}_j$ &mdash; равнодействующая активных сил,
              приложенных к $j$-ой точке;
            </li>
            <li>
              $\bvec{R}_j$ &mdash; равнодействующая реактивных сил,
              приложенных к $j$-ой точке.
            </li>
          </ul>

          Рассмотрим равенство
          \[
          \sum_{j=1}^N \paren{
          m_j \dv{\bvec{v}_j}{t} - \bvec{F}_j - \bvec{R}_j
          } \delta \bvec{r}_j = 0.
          \]

          Если связи идеальны, то по определению их виртуальные работы равны
          нулю:
          \[
          \sum_{j=1}^N \bvec{R}_j \cdot \delta \bvec{r}_j = 0.
          \]
          Учитывая этот факт, приходим к <i class="important">
            общему уравнению механики</i>:
          \[
          \sum_{j=1}^N \paren{
          m_j \dv{\bvec{v_j}}{t} - \bvec{F}_j
          } \delta \bvec{r}_j = 0,
          \]
          которое также называют <i class="important">
            уравнением Даламбера-Лагранжа в декартовых координатах</i>.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Принцип возможных перемещений
        </div>
        <div class="content">
          <div class="statement">
            Необходимое и достаточное условие равновесия системы, подчинённой
            стационарным неосвобождающим идеальным связям, заключается в
            равенстве нулю суммы элементарных работ активных сил на любом
            возможном перемещении системы из рассматриваемого положения
            равновесия, т.е.
            \[
            \sum_{j=1}^N \bvec{F}_j \cdot \delta \bvec{r}_j = 0.
            \]

            <div class="proof">
              <div class="necessity">
                Предположим, что несвободная система, подчинённая стационарным
                неосвобождающим идеальным связям, находится в состоянии
                равновесия. Тогда каждая её точка $M_j$ находится в состоянии
                равновесия, и равнодействующая сил $\bvec{F}_j$ и $\bvec{R}_j$,
                приложенных к точке $M_j$, должна быть равна нулю. Равна нулю
                будет и работа этой равнодействующей, так что
                \[
                \sum_{j=1}^N \paren{
                \bvec{F}_j + \bvec{R}_j
                } \delta \bvec{r}_j = 0,
                \]
                или
                \[
                \sum_{j=1}^N \bvec{F}_j \cdot \delta \bvec{r}_j
                + \sum_{j=1}^N \bvec{R}_j \cdot \delta \bvec{r}_j = 0,
                \]
                но вторая сумма равна нулю в силу идеальности связей, и,
                следовательно,
                \[
                \sum_{j=1}^N \bvec{F}_j \cdot \delta \bvec{r}_j = 0.
                \]
              </div>

              <div class="sufficiency">
                Если выполнено условие
                \[
                \sum_{j=1}^N \bvec{F}_j \cdot \delta \bvec{r}_j = 0,
                \]
                то общее уравнение механики
                \[
                \sum_{j=1}^N \paren{
                m_j \dv{\bvec{v_j}}{t} - \bvec{F}_j
                } \delta \bvec{r}_j = 0
                \]
                примет вид
                \[
                \sum_{j=1}^N \dv{\bvec{v_j}}{t} \cdot \delta \bvec{r}_j = 0,
                \]
                откуда (в силу произвольности перемещения $\delta \bvec{r}_j$)
                следует, что
                \[
                \dv{\bvec{v_j}}{t} = 0 \qquad \forall j = \overline{1,N},
                \]
                то есть равнодействующая активных и реактивных сил, приложенных
                к каждой точке, равна нулю.
              </div>
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Уравнения Лагранжа I рода и реакции идеальных связей
        </div>
        <div class="content">
          Рассмотрим систему $N$ точек. Введём обозначения:
          <ul>
            <li>
              $m_{3j-2} = m_{3j-1} = m_{3j}$ &mdash; масса $j$-ой точки;
            </li>

            <li>
              $x_{3j-2}, x_{3j-1}, x_{3j}$ &mdash; координаты $j$-ой точки;
            </li>

            <li>
              $X_{3j-2}, X_{3j-1}, X_{3j}$ &mdash; проекции равнодействующей
              активных связей $\bvec{F}_j$, действующих на $j$-ую точку;
            </li>

            <li>
              $R_{3j-2}, R_{3j-1}, R_{3j}$ &mdash; проекции равнодействующей
              реактивных связей $\bvec{R}_j$, действующих на $j$-ую точку.
            </li>

            <li>
              $x = (x_1, \dots, x_{3N})$.
            </li>
          </ul>

          В общем виде несвободная система подчиняется как голономным
          \[
          f_j(x,t) = 0, \qquad j = \overline{1,k},
          \]
          так и неголономным связям:
          \[
          \sum_{\nu=1}^{3N} a_{\rho \nu}(t) \dot{x}_{\nu} + a_\rho(t) = 0,
          \qquad \rho = \overline{1, r}
          \]
          что вкупе со вторым законом Ньютона
          \[
          m_\nu \ddot{x}_\nu = X_\nu + R_\nu, \qquad \nu = \overline{1,3N}
          \]
          даёт $3N + k + r$ уравнений относительно $6N$ неизвестных
          $x_\nu, R_\nu$.

          <p>
          Если связи идеальны, то общее уравнение механики для данной системы
          запишется в виде
          \[
          \sum_{\nu=1}^{3N} \paren{
          m_\nu \ddot{x}_\nu - X_\nu
          } \delta x_\nu = 0.
          \]
          Связи удерживающие, поэтому они накладывают на вариации следующие
          ограничения:
          \[
          \sum_{\nu=1}^{3N} \pd{f_i}{x_\nu} \delta x_\nu = 0,
          \qquad i = \overline{1,k}.
          \]
          Умножим обе части уравнений неголономных связей на $dt$:
          \[
          \sum_{\nu=1}^{3N} a_{\rho \nu}(t) \frac{d x_\nu}{\cancel{dt}}
          \cancel{dt} + a_\rho(t) dt = 0,
          \qquad \rho = \overline{1, r}.
          \]
          Перейдём к изохронному варьированию: $\delta t = 0$, поэтому
          ограничения, накладываемые неголономными связями на вариации, примут
          следующий вид:
          \[
          \sum_{\nu=1}^{3N} a_{\rho \nu}(t) \delta x_\nu = 0,
          \qquad \rho = \overline{1, r}.
          \]

          Итак, имеем $k+r$ ограничений на вариации, следовательно, среди $3N$
          вариаций $k+r$ будут зависимыми.
          </p>

          <p>
          Введём в рассмотрение <i class="important">множители Лагранжа</i>:
          $\lambda_1(t), \dots, \lambda_k(t)$ для голономных связей и $\mu_1(t),
          \dots, \mu_r(t)$ &mdash; для неголономных. Домножим уравнения связей
          на соответствующие множители и вычтем из общего уравнения механики:
          \[
          \sum_{\mu=1}^{3N} \paren{
          m_\nu \ddot{x}_\nu - X_\nu
          - \sum_{i=1}^k \lambda_i \pd{f_i}{x_\nu}
          - \sum_{\rho=1}^r \mu_\rho a_{\rho \nu}
          } \delta x_\nu = 0.
          \]
          Выберем $\lambda_i$ и $\mu_\rho$ так, чтобы какие-либо $r+k$ скобок
          обнулились. Считая оставшиеся $3N - r-k$ вариаций независимыми,
          воспользуемся тем фактом, что сумма произведений некоторых выражений
          на произвольные величины равна нулю только в том случае, когда все эти
          выражения по отдельности обращаются в ноль. Таким образом, оставшиеся
          $3N - r-k$ выражений также равны нулю.
          </p>

          <p>
          Итак, имеем $3N+r+k$ уравнений
          \[
          \left\{
          \begin{aligned}
          m_\nu \ddot{x}_\nu - X_\nu
          - \sum_{i=1}^k \lambda_i \pd{f_i}{x_\nu}
          - \sum_{\rho=1}^r \mu_\rho a_{\rho \nu} &= 0,
          & \nu = \overline{1,3N}, \\
          f_j(x,t) &= 0,
          & j = \overline{1,k}, \\
          \sum_{\nu=1}^{3N} a_{\rho \nu}(t) \dot{x}_{\nu} + a_\rho(t) &= 0,
          & \rho = \overline{1, r}.
          \end{aligned}
          \right.
          \]
          относительно $3N+r+k$ неизвестных $x_\nu, \lambda_i, \mu_\rho$.
          </p>

          <p>
          Эти уравнения называют <i class="important">уравнениями Лагранжа I
            рода</i>.
          </p>

          <p>
          Заметим, что из второго закона Ньютона следует, что
          \[
          m_\nu \ddot{x}_\nu - X_\nu - R_\nu = 0, \qquad \nu = \overline{1,3N},
          \]
          поэтому <i class="important">реакции идеальных связей</i> (вернее, их
          проекции) можно найти из уравнений
          \[
          R_\nu = \sum_{i=1}^k \lambda_i \pd{f_i}{x_\nu}
          + \sum_{\rho=1}^r \mu_\rho a_{\rho \nu}.
          \]
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: лагранжевы координаты
        </div>
        <div class="content">
          Рассмотрим несвободную систему $N$ точек. Будем считать, что она
          подчинена только голономным связям:
          \[
          f_i(x,t) = 0, \qquad i = \overline{1,m},
          \]
          причём
          <ul>
            <li>
              $x \in M \subset \mathbb{R}^{3N}$;
            </li>

            <li>
              $f_i \in C^2 \paren{M \times [t_1, t_2]}$.
            </li>
          </ul>

          Также будем считать, что связи линейно независимы, то есть
          \[
          \rank \paren{\pd{f_i}{x_k}} = m, \qquad x \in M.
          \]
          Тогда из $3N$ вариаций зависимыми будут $m$.

          <div class="definition">
            Число $s = 3N - m$ называют <i>числом степеней свободы</i>.
          </div>

          <div class="remark">
            Если присутствуют неголономные связи или $m$ голономных связей
            линейно зависимы, то $s$, вообще говоря, не равно $3N - m$.
          </div>

          Рассмотрим $s$ координат
          $q = (q_1, \dots, q_s) \in D \subset \mathbb{R}^s$.
          <div class="definition">
            Если координаты $q = (q_1, \dots, q_s) \in D$ удовлетворяют условиям
            <ol type="a">
              <li>
                $x(q,t) \in M$;
              </li>

              <li>
                $f_i(x(q,t),t) = 0$, где $i = \overline{1,m}$,
              </li>
            </ol>
            причём $t \in (t_1, t_2)$, то их называют <i>обобщёнными
              (лагранжевыми) координатами</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div id="implicit-functions" class="name">
          Теорема о неявных функциях (без док-ва)
        </div>
        <div class="content">
          <div class="theorem">
            Если функции
            \[
            F_i(x_1, \dots, x_n, y_1, \dots, y_m), \quad i = \overline{1,m}
            \]
            непрерывно дифференцируемы в некоторой окрестности точки
            \[
            (x^0, y^0) = (x_1^0, \dots, x_n^0, y_1^0, \dots, y_m^0)
            \]
            и
            \[
            \begin{gathered}
            F_i(x_1^0, \dots, x_n^0, y_1^0, \dots, y_m^0) = 0,
            \quad i = \overline{1,m}, \\
            \at
            { \pd{ \paren{F_1, \dots, F_m} }{ \paren{y_1, \dots, y_m} } }
            { \paren{x^0, y^0} } \neq 0,
            \end{gathered}
            \]
            то существуют окрестности $U_x \subset \mathbb{R}^n$
            и $U_y \subset \mathbb{R}^m$ точек $x^0$ и $y^0$ такие, что система
            уравнений
            \[
            F_i(x_1, \dots, x_n, y_1, \dots, y_m) = 0, \quad i = \overline{1,m}
            \]
            однозначно разрешима в окрестности $U_x \times U_y$ точки
            $(x^0, y^0)$ относительно переменных $y_1, \dots, y_m$.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Доказать, что обобщённые координаты можно выразить через декартовы
        </div>
        <div class="content">
          Рассмотрим систему $N$ точек, стеснённую только голономными связями
          \[
          f_i(x, t) = 0, \qquad i = \overline{1,m}.
          \]
          Связи считаем линейно независимыми, то есть
          \[
          \rank \paren{ \pd{f_i}{x_k} } = m.
          \]
          В этом случае число степеней свободы данной системы равно
          $s = 3N - m$.

          <div class="statement">
            Если $(q,t) \in D \times (t_1, t_2)$, то
            \[
            \rank \paren{
            \pd{x_\nu}{q_i}
            } = s \neq 0.
            \]

            <div class="proof">
              Пусть
              \[
              \rank \paren{ \pd{x_\nu}{q_i} } = k \leqslant s.
              \]
              Тогда количество зависимых координат равно $3N - k$. Так как
              система стеснена только $m$ связями, то количество зависимых
              координат не может превышать $m$, то есть
              \[
              3N - k \leqslant m, \implies k \geqslant 3N - m \bydef= s,
              \]
              откуда следует, что $k = s$.
            </div>
          </div>

          Итак, в области $D \times (t_1, t_2)$
          \[
          \rank \paren{
          \pd{x_\nu}{q_i}
          } = s \neq 0,
          \]
          поэтому (<a href="#implicit-functions">по теореме о неявных
            функциях</a>) обобщённые координаты разрешимы относительно
          декартовых, то есть
          \[
          q_k = q_k(x,t), \qquad k = \overline{1,s}.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Связь вариаций декартовых и обобщённых координат. Вариации лагранжевых
          координат
        </div>
        <div class="content">
          Рассмотрим несвободную систему $N$ точек, подчинённую идеальным
          голономным удерживающим связям. Обозначим за
          $\bvec{r}_j = \bvec{r}_j(q,t)$ радиус-вектор $j$-ой точки системы.
          Тогда
          \[
          \left\{
          \begin{aligned}
          \bvec{v}_j &= \dv{\bvec{r}_j(q,t)}{t}
          = \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t},
          & j=\overline{1,N}, \\
          \dot{x}_\nu &= \dv{x_\nu(q,t)}{t}
          = \sum_{i=1}^s \pd{x_\nu}{q_i} \dot{q}_i + \pd{x_\nu}{t},
          & \nu=\overline{1,3N},
          \end{aligned}
          \right.
          \]
          или, переходя к (изохронным) вариациям,
          \[
          \left\{
          \begin{aligned}
          \delta \bvec{r}_j &=
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i + \pd{\bvec{r}_j}{t}
          \delta t = \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i,
          & j=\overline{1,N}, \\
          \delta x_\nu &=
          \sum_{i=1}^s \pd{x_\nu}{q_i} \delta q_i + \pd{x_\nu}{t} \delta t
          = \sum_{i=1}^s \pd{x_\nu}{q_i} \delta q_i,
          & \nu=\overline{1,3N},
          \end{aligned}
          \right.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Общее уравнение механики в обобщённых координатах
        </div>
        <div class="content">
          Рассмотрим общее уравнение механики в декартовых координатах для
          системы $N$ точек, подчинённой идеальным связям:
          \[
          \sum_{j=1}^N \paren{
          m_j \dv{\bvec{v}_j}{t} - \bvec{F}_j
          } \delta \bvec{r}_j = 0.
          \]
          Так как
          \[
          \delta \bvec{r}_j = \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i,
          \qquad j=\overline{1,N},
          \]
          то
          \[
          \sum_{j=1}^N \paren{
          m_j \dv{\bvec{v}_j}{t} - \bvec{F}_j
          } \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i = 0.
          \]

          <div class="statement">
            Справедливо тождество Лагранжа:
            \[
            \dv{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
            =
            \dv{}{t} \paren{ \bvec{v}_j \pd{\bvec{r}_j}{q_i} }
            -
            \bvec{v}_j \dv{}{t} \pd{\bvec{r}_j}{q_i}.
            \]

            <div class="proof">
              Действительно,
              \[
              \dv{}{t} \paren{ \bvec{v}_j \pd{\bvec{r}_j}{q_i} }
              =
              \dv{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
              +
              \bvec{v}_j \dv{}{t} \pd{\bvec{r}_j}{q_i}.
              \]
            </div>
          </div>

          Взяв от уравнений
          \[
          \bvec{v}_j =
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t},
          \qquad j=\overline{1,N},
          \]
          частную производную по $\dot{q}_i$, получим, что
          \[
          \pd{\bvec{r}_j}{q_i} = \pd{\bvec{v}_j}{\dot{q}_i}.
          \]

          <div class="statement">
            Справедливо равенство:
            \[
            \dv{}{t} \pd{\bvec{r}_j}{q_i} = \pd{\bvec{v}_j}{q_i}.
            \]

            <div class="proof">
              Так как
              \[
              \bvec{v}_j = \dot{\bvec{r}}_j =
              \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t},
              \]
              то
              \[
              \pd{\bvec{v}_j}{q_i}
              = \pd{\dot{\bvec{r}}_j}{q_k}
              = \sum_{i=1}^s \ppdv{\bvec{r}_j}{q_k}{q_i} \dot{q}_i
              + \ppdv{\bvec{r}_j}{q_k}{t},
              \]
              но
              \[
              \dv{}{t} \paren{ \pd{\bvec{r}_j}{q_k} }
              = \sum_{i=1}^s \ppdv{\bvec{r}_j}{q_k}{q_i} \dot{q}_i
              + \ppdv{\bvec{r}_j}{q_k}{t},
              \]
              откуда следует справедливость равенства
              \[
              \dv{}{t} \pd{\bvec{r}_j}{q_i} = \pd{\bvec{v}_j}{q_i}.
              \]
            </div>
          </div>

          Итак, домножим тождество Лагранжа
          \[
          \dv{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
          =
          \dv{}{t} \paren{ \bvec{v}_j \pd{\bvec{r}_j}{q_i} }
          -
          \bvec{v}_j \dv{}{t} \pd{\bvec{r}_j}{q_i}
          \]
          на $m_j$ и просуммируем полученные равенства:
          \[
          \sum_{j=1}^N m_j \dv{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
          =
          \sum_{j=1}^N m_j \dv{}{t} \paren{ \bvec{v}_j \pd{\bvec{r}_j}{q_i} }
          -
          \sum_{j=1}^N m_j \bvec{v}_j \dv{}{t} \pd{\bvec{r}_j}{q_i}.
          \]
          Введём в рассмотрение уравнение <i class="important">кинетической
            энергии</i>:
          \[
          T = \frac{1}{2} \sum_{j=1}^N m_j \dp{\bvec{v}_j}{\bvec{v}_j}.
          \]
          Используя его, перепишем уравнение в следующем виде:
          \[
          \sum_{j=1}^N m_j \dv{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
          =
          \dv{}{t} \pd{T}{\dot{q}_i} - \pd{T}{q_i}.
          \]

          <div class="derivation">
            Действительно, рассмотрим следующие частные производные:
            \[
            \begin{aligned}
            \pd{T}{\dot{q}_i}
            &= \frac{1}{2} \sum_{j=1}^N m_j
              \pd{}{\dot{q}_i} \paren{ \dp{\bvec{v}_j}{\bvec{v}_j} } = \\
            &= \sum_{j=1}^N m_j
            \paren{ \dp{\bvec{v}_j}{\pd{\bvec{v}_j}{\dot{q}_i}} } = \\
            &= \sum_{j=1}^N m_j
            \paren{ \dp{\bvec{v}_j}{\pd{\bvec{r}_j}{q_i}} }.
            \end{aligned}
            \]

            Аналогично
            \[
            \begin{aligned}
            \pd{T}{q_i}
            &= \frac{1}{2} \sum_{j=1}^N m_j
              \pd{}{q_i} \paren{ \dp{\bvec{v}_j}{\bvec{v}_j} } = \\
            &= \sum_{j=1}^N m_j
            \paren{ \dp{\bvec{v}_j}{\pd{\bvec{v}_j}{q_i}} } = \\
            &= \sum_{j=1}^N m_j
            \paren{ \dp{\bvec{v}_j}{ \dv{}{t} \pd{\bvec{r}_j}{q_i} } }.
            \end{aligned}
            \]
          </div>

          Также рассмотрим <i class="important">обобщённую силу</i>
          \[
          Q_i = \sum_{j=1}^N \bvec{F}_j \pd{\bvec{r}_j}{q_i}.
          \]

          <div class="remark">
            Если активные силы консервативны, то
            \[
            Q_i = -\pd{\Pi}{q_i},
            \]
            где $\Pi$ &mdash; потенциальная энергия системы.
          </div>

          Раскрыв скобки в уравнении
          \[
          \sum_{j=1}^N \paren{
          m_j \pd{\bvec{v}_j}{t} - \bvec{F}_j
          } \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i = 0,
          \]
          придём к уравнению
          \[
          \sum_{j=1}^N \paren{
          \sum_{i=1}^s m_j \pd{\bvec{v}_j}{t} \pd{\bvec{r}_j}{q_i}
          -
          \sum_{i=1}^s \bvec{F}_j \pd{\bvec{r}_j}{q_i}
          } \delta q_i = 0,
          \]
          которое можно записать в виде
          \[
          \sum_{i=1}^s \paren{
          \dv{}{t} \pd{T}{\dot{q}_i} - \pd{T}{q_i} - Q_i
          } \delta q_i = 0.
          \]
          В этом виде оно известно как <i class="important">общее уравнение
            механики в обобщённых координатах</i>.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Уравнения Лагранжа II рода
        </div>
        <div class="content">
          Рассмотрим голономную механическую систему с идеальными связями и $s$
          степенями свободы, зададим обобщённые координаты
          $q = (q_1, \dots, q_s)$.

          <p>
          В силу независимости вариаций обобщённых координат из общего уравнения
          механики
          \[
          \sum_{i=1}^s \paren{
          \dv{}{t} \pd{T}{\dot{q}_i} - \pd{T}{q_i} - Q_i
          } \delta q_i = 0
          \]
          следует, что
          \[
          \dv{}{t} \pd{T}{\dot{q}_i} - \pd{T}{q_i} = Q_i,
          \qquad i=\overline{1,s}.
          \]
          </p>

          <div class="definition">
            Эти уравнения называют <i class="important">уравнениями Лагранжа II
              рода</i>.
          </div>

          Если активные силы консервативны, то
          \[
          Q_i = -\pd{\Pi}{q_i}.
          \]
          Введя <i class="important">функцию Лагранжа</i>
          \[
          L = T - \Pi,
          \]
          уравнения Лагранжа II рода примут вид
          \[
          \dv{}{t} \pd{L}{\dot{q}_i} - \pd{L}{q_i} = 0,
          \qquad i=\overline{1,s}.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          В чём преимущество уравнений Лагранжа II рода перед уравнениями I
          рода?
        </div>
        <div class="content">
          <div class="answer">
            <ol>
              <li>
                Они не зависят от точек системы &mdash; только от степени
                свободы, следовательно, размерность у них меньше.
              </li>

              <li>
                В них не входят заранее не известные реакции идеальных связей.
              </li>
            </ol>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Инвариантность уравнений Лагранжа II рода
        </div>
        <div class="content">
          <div class="definition">
            Говорят, что уравнения Лагранжа II рода <i
              class="important">инвариантны относительно какого-то класса
              преобразований</i>, если каждое преобразование этого класса не
            изменяет кинетическую энергию $T$ и обобщённые силы $Q_i$.
          </div>

          <div class="example">
            Рассмотрим движение материальной точки в центральном поле сил. Пусть
            $m$ &mdash; масса точки, а $x_1, x_2, x_3$ &mdash; её координаты,
            тогда
            \[
            \begin{aligned}
            T &= \frac{1}{2} m v^2 = \frac{1}{2} m \paren{
            \dot{x}_1^2 + \dot{x}_2^2 + \dot{x}_3^2
            }, \\
            \Pi &= - \frac{\mu}{r} = \frac{-\mu}{\sqrt{x_1^2 + x_2^2 + x_3^2}}.
            \end{aligned}
            \]
            Видно, что уравнения Лагранжа II рода инвариантны относительно
            поворота системы координат в силу инвариантности длины векторов.
          </div>
        </div>
      </li>

      <li class="question">
        <div id="lagrange_ii" class="name">
          Разрешимость уравнений Лагранжа II рода относительно старших
          производных
        </div>
        <div class="content">
          Рассмотрим кинетическую энергию механической системы в декартовых
          координатах:
          \[
          T = \frac{1}{2} \sum_{j=1}^N m_j \bvec{v}_j^2.
          \]
          Так как
          \[
          \bvec{v}_j =
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t},
          \]
          то
          \[
          \begin{aligned}
          T &= \frac{1}{2} \sum_{j=1}^N m_j
          \paren{
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t}
          }
          \paren{
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i + \pd{\bvec{r}_j}{t}
          } \\
          &= T_2 + T_1 + T_0,
          \end{aligned}
          \]
          где
          \[
          \begin{aligned}
          T_2 &= \frac{1}{2} \sum_{j=1}^N m_j \paren{
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i
          }^2 \\
          T_1 &= \sum_{p=1}^s \paren{
          \sum_{j=1}^N m_j \pd{\bvec{r}_j}{q_p} \pd{\bvec{r}_j}{t}
          } \dot{q}_p, \\
          T_0 &= \frac{1}{2} \sum_{j=1}^N m_j \paren{
          \pd{\bvec{r}_j}{t}
          }^2.
          \end{aligned}
          \]
          Если ввести обозначения
          \[
          \begin{aligned}
          a_{ik} = a_{ki} &=
          \sum_{j=1}^N m_j \pd{\bvec{r}_j}{q_i} \pd{\bvec{r}_j}{q_k}, \\
          a_p &= 
          \sum_{j=1}^N m_j \pd{\bvec{r}_j}{q_p} \pd{\bvec{r}_j}{t},
          \end{aligned}
          \]
          то уравнения можно представить в виде
          \[
          \begin{aligned}
          T_2 &= \frac{1}{2} \sum_{i,k=1}^s a_{ik} \dot{q}_i \dot{q}_k, \\
          T_1 &= \sum_{p=1}^s a_p \dot{q}_p, \\
          T_0 &= \frac{1}{2} \sum_{j=1}^N m_j \paren{
          \pd{\bvec{r}_j}{t}
          }^2.
          \end{aligned}
          \]
          Значит, уравнения Лагранжа
          \[
          \dv{}{t} \pd{T}{\dot{q}_i} - \pd{T}{q_i} = Q_i,
          \qquad i=\overline{1,s}
          \]
          можно представить в виде
          \[
          \sum_{k=1}^s a_{ik} \ddot{q}_k = B_i,
          \qquad i=\overline{1,s},
          \]
          где $B_i$ не зависят от обобщённых ускорений
          $\ddot{q}_1, \dots, \ddot{q}_s$. Значит, для доказательства
          разрешимости уравнений Лагранжа II рода относительно обобщённых
          ускорений достаточно доказать, что
          \[
          \det A \neq 0, \quad A = (a_{ik})_{i,k=1}^s.
          \]
          При $u = (u_1, \dots, u_s)$ рассмотрим квадратичную форму
          \[
          T_2(u) = \frac{1}{2} \sum_{i,k=1}^s a_{ik} u_i u_k.
          \]
          Применим к ней критерий Сильвестра &mdash; для положительной
          определённости этой формы необходимо и достаточно, чтобы все главные
          миноры были строго положительны, то есть, в частности,
          \[
          \det A \gt 0.
          \]
          Значит, доказав положительную определённость этой формы, мы докажем,
          что $\det A \neq 0$. Так как
          \[
          T_2(u) = \frac{1}{2} \sum_{j=1}^N m_j \paren{
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} u_i
          }^2,
          \]
          то $T_2(u) \geqslant 0$ для всех $u$. Докажем, что
          $T_2(u) = 0 \iff u = 0$. Рассуждаем от противного: пусть
          $\exists u \neq 0$, для которого $T_2(u) = 0$. Тогда
          \[
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} u_i = 0,
          \qquad j = \overline{1,N},
          \]
          или
          \[
          \sum_{i=1}^s \pd{x_{3j-2}}{q_i}
          =
          \sum_{i=1}^s \pd{x_{3j-1}}{q_i}
          =
          \sum_{i=1}^s \pd{x_{3j}}{q_i}
          = 0,
          \]
          откуда следует линейная зависимость столбцов якобиана
          $\dfrac{D(x)}{D(q)}$, то есть $\rank \dfrac{D(x)}{D(q)} \lt s$, но
          известно, что $\rank \dfrac{D(x)}{D(q)} = s$ &mdash; получили
          противоречие.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: обобщённые импульсы
        </div>
        <div class="content">
          Рассмотрим голономную механическую систему с идеальными связями. Пусть
          активные силы консервативны, то есть $L = T - \Pi$ и
          \[
          \dv{}{t} \pd{L}{\dot{q}_i} - \pd{L}{q_i} = 0,
          \qquad i=\overline{1,s}.
          \]

          <div class="definition">
            Величины
            \[
            p_i = \pd{L}{\dot{q}_i}, \qquad i = \overline{1,s}
            \]
            называют <i>обобщёнными импульсами</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div id="canon-derivation" class="name">
          Вывод канонических уравнений
        </div>
        <div class="content">
          Рассмотрим голономную механическую систему с идеальными связями. Пусть
          активные силы консервативны, то есть $L = T - \Pi$ и
          \[
          \dv{}{t} \pd{L}{\dot{q}_i} - \pd{L}{q_i} = 0,
          \qquad i=\overline{1,s}.
          \]

          Потенциальная энергия не зависит от обобщённых скоростей, поэтому
          \[
          \ppdv{L}{\dot{q}_i}{\dot{q}_k}
          =
          \ppdv{T}{\dot{q}_i}{\dot{q}_k}, \qquad i,k=\overline{1,s}.
          \]
          <a href="#lagrange_ii">Так как</a>
          \[
          \det 
          \left. \paren{
          \ppdv{T}{\dot{q}_i}{\dot{q}_k}
          }
          \right|_{i,k=1}^s \neq 0,
          \]
          то уравнения импульсов
          \[
          p_i = \pd{L}{\dot{q}_i}, \qquad i = \overline{1,s}
          \]
          разрешимы относительно обобщённых скоростей, то есть
          \[
          \dot{q}_i = \dot{q}_i(q, p, t), \qquad i = \overline{1,s}.
          \]

          <div class="definition">
            Функцию
            \[
            H(q,p,t) = \sum_{k=1}^s p_k \dot{q}_k(q,p,t)
            - L(q, \dot{q}(q,p,t), t)
            \]
            называют <i class="important">функцией Гамильтона</i> (<i
              class="important">гамильтонианом</i>).
          </div>

          Нетрудно видеть, что справедливы соотношения:
          \[
          \begin{aligned}
          \pd{H}{p_i}
          &= \dot{q}_i + \sum_{k=1}^s \paren{
          p_k \pd{\dot{q}_k}{p_i} - \pd{L}{\dot{q}_k} \pd{\dot{q}_k}{p_i}
          }
          = \dot{q}_i, \\
          \pd{H}{q_i}
          &= \sum_{k=1}^s \paren{
          p_k \pd{\dot{q}_k}{q_i} - \pd{L}{\dot{q}_k} \pd{\dot{q}_k}{q_i}
          }
          - \pd{L}{q_i}
          = -\pd{L}{q_i}, \\
          \pd{H}{t}
          &= \sum_{k=1}^s \paren{
          p_k \pd{\dot{q}_k}{t} - \pd{L}{\dot{q}_k} \pd{\dot{q}_k}{t}
          }
          - \pd{L}{t}
          = -\pd{L}{t}.
          \end{aligned}
          \]
          Учитывая, что
          \[
          \dv{}{t} p_i = \pd{L}{q_i} = - \pd{H}{q_i},
          \]
          можно записать уравнения, называемые <i
            class="important">каноническими уравнениями</i>:
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]
          <div class="definition">
            Переменные $(q,p)$ называют <i>каноническими</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: первый интеграл динамической системы
        </div>
        <div class="content">
          <div class="definition">
            Функцию $f(x)$ называют <i>первым интегралом системы</i>, если её
            производная в силу этой системы равна нулю:
            \[
            \dv{f}{t} = 0.
            \]
            Другими словами, вдоль решений системы
            \[
            f(x) = C = \const.
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Канонические уравнения: интеграл механической энергии
        </div>
        <div class="content">
          Рассмотрим гамильтониан
          \[
          H(q,p,t) = \sum_{k=1}^s p_k \dot{q}_k(q,p,t)
          - L(q, \dot{q}(q,p,t), t)
          \]
          и канонические уравнения
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]

          Также рассмотрим полную производную гамильтониана:
          \[
          \begin{aligned}
          \dv{H}{t}
          &= \pd{H}{t} + \sum_{i=1}^s \paren{
          \pd{H}{q_i} \dot{q}_i + \pd{H}{p_i} \dot{p}_i
          } = \\
          &= \pd{H}{t} + \sum_{i=1}^s \underbrace{\paren{
          \pd{H}{q_i} \pd{H}{p_i} - \pd{H}{p_i} \pd{H}{q_i}
          }}_{=0} \\
          \implies \dv{H}{t} &= \pd{H}{t}.
          \end{aligned}
          \]
          Значит, если гамильтониан не зависит явно от времени $t$ (то есть
          $H = H(q,p)$), то
          \[
          \pd{H}{t} = 0, \implies \dv{H}{t} = 0, \implies H = h = \const.
          \]
          Нетрудно проверить, что $H(q,p) = h$ является первым интегралом
          канонической системы.

          <p>
          Механический смысл первого интеграла $H(q,p) = h$: по определению
          \[
          H(q,p,t) = \sum_{k=1}^s p_k \dot{q}_k(q,p,t)
          - L(q, \dot{q}(q,p,t), t).
          \]
          Если $H = H(q,p)$, то
          \[
          \begin{aligned}
          H(q,p) &= \sum_{k=1}^s p_k \dot{q}_k(q,p)
          - L(q, \dot{q}(q,p)) = \\
          &= \sum_{k=1}^s \pd{L}{\dot{q}_k} \dot{q}_k(q,p)
          - L(q, \dot{q}(q,p)).
          \end{aligned}
          \]
          Так как
          \[
          L = T - \Pi = T_2 + T_1 + T_0 - \Pi,
          \]
          где
          \[
          \begin{aligned}
          T_2 &= \frac{1}{2} \sum_{i,k=1}^s a_{ik} \dot{q}_i \dot{q}_k, \\
          T_1 &= \sum_{p=1}^s a_p \dot{q}_p, \\
          T_0 &= \frac{1}{2} \sum_{j=1}^N m_j \paren{
          \pd{\bvec{r}_j}{t}
          }^2,
          \end{aligned}
          \]
          то
          \[
          \sum_{k=1}^s \pd{L}{\dot{q}_k} \dot{q}_k = 2T_2 + T_1.
          \]
          </p>

          <div class="derivation">
            Так как
            \[
            \pd{T_0}{\dot{q}_i} = 0, \qquad
            \pd{\Pi}{\dot{q}_i} = 0,
            \]
            то
            \[
            \sum_{k=1}^s \pd{L}{\dot{q}_k} \dot{q}_k =
            \sum_{k=1}^s \pd{T_2}{\dot{q}_k} \dot{q}_k +
            \sum_{k=1}^s \pd{T_1}{\dot{q}_k} \dot{q}_k.
            \]

            Очевидно, что
            \[
            \pd{T_1}{\dot{q}_k} \dot{q}_k = a_k \dot{q}_k, \implies
            \sum_{k=1}^s \pd{T_1}{\dot{q}_k} \dot{q}_k = T_1.
            \]

            Остаётся разобраться с первым слагаемым
            \[
            \sum_{k=1}^s \pd{T_2}{\dot{q}_k} \dot{q}_k.
            \]

            Прежде всего, заметим, что
            \[
            \pd{T_2}{\dot{q}_k} \dot{q}_k = 2 a_{kk} \dot{q}_k^2
            + \sum_{j = 1, j \neq k}^s a_{kj} \dot{q}_j \dot{q}_k,
            \]
            причём слагаемого с коэффициентом $a_{kk}$ в других частных
            производных не будет, а слагаемое с коэффициентом $a_{kj}$
            встретится в частной производной
            \[
            \pd{T_2}{\dot{q}_j} \dot{q}_j.
            \]

            Отсюда можно сделать вывод, что
            \[
            \sum_{k=1}^s \pd{T_2}{\dot{q}_k} \dot{q}_k = 2 T_2.
            \]

            Окончательно получаем, что
            \[
            \sum_{k=1}^s \pd{L}{\dot{q}_k} \dot{q}_k = 2T_2 + T_1.
            \]
          </div>

          <div class="definition">
            Функция
            \[
            H = T_2 - T_0 + \Pi = h
            \]
            называется <i>функцией Гамильтона в форме Якоби-Остроградского</i>.
          </div>

          Если $\bvec{r}_j = \bvec{r}_j(q)$ (то есть радиус-векторы точек не
          зависят явно от времени), то $T_0 = 0$, и, следовательно,
          \[
          H = T + \Pi = h = \const.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: функция Гамильтона в форме Якоби-Остроградского
        </div>
        <div class="content">
          <div class="definition">
            Функция
            \[
            H = T_2 - T_0 + \Pi = h,
            \]
            где
            \[
            \begin{aligned}
            T_2 &= \frac{1}{2} \sum_{i,k=1}^s a_{ik} \dot{q}_i \dot{q}_k, \\
            T_0 &= \frac{1}{2} \sum_{j=1}^N m_j \paren{
            \pd{\bvec{r}_j}{t}
            }^2,
            \end{aligned}
            \]
            называется <i>функцией Гамильтона в форме Якоби-Остроградского</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Циклические координаты
        </div>
        <div class="content">
          Рассмотрим обобщённые координаты $q = (q_1, \dots, q_s)$.

          <div class="definition">
            Обобщённые координаты координат $q_1, \dots, q_\sigma$ (где $\sigma
            \lt s$), от которых функция Лагранжа $L = L(q, p, t)$ явно не
            зависит, называют <i>циклическими</i>. Остальные координаты называют
            <i>позиционными</i>.
          </div>

          Из канонических уравнений известно, что
          \[
          -\dot{p}_i = \pd{H}{q_i} \bydef= -\pd{L}{q_i} = 0,
          \qquad i = \overline{1,\sigma},
          \]
          поэтому
          \[
          \dot{p}_i = 0, \implies p_i = C_i = \const,
          \]
          то есть <i class="important">циклические импульсы являются первыми
            интегралами канонической системы</i>.

          <div class="remark">
            Каждая циклическая координата снижает порядок системы на 2.

            <div class="idea">
              Так как $L$ не зависит от циклической координаты $q_\sigma$, то от
              неё не зависит и гамильтониан $H$ (по построению). Выходит, что в
              канонической системе уже не участвует координата $q_\sigma$, то
              есть её порядок понижен на 1.

              <p>
              Теперь заметим, что, подставив $p_i = C_i = \const$, в
              гамильтониан, мы также избавим каноническую систему от переменной
              импульса $p_i$, то есть снова понизим её размерность на 1.
              </p>
            </div>
          </div>

          Используя <a href="#canon-derivation">тот факт, что обобщённые
            скорости можно выразить через $q$ и $p$</a>, можно записать, что
          \[
          \dot{q}_i = \dot{q}_i(
          q_{\sigma+1}, \dots, q_s, C_1, \dots, C_\sigma, p_{\sigma+1}, \dots,
          p_s, t
          ), \qquad i = \overline{1,\sigma}.
          \]
          Такие скорости называют <i class="important">циклическими</i>.

          <div class="remark">
            Циклические скорости не зависят от циклических координат по
            построению: от них не зависит лагранжиан $L$.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Полный интеграл и характеристики уравнений в частных производных
          первого порядка
        </div>
        <div class="content">
          Рассмотрим голономную систему с идеальными связями в потенциальном
          поле сил.

          <div class="idea">
            Свести систему дифференциальных уравнений к одному ДУЧП. В этом
            случае полный интеграл ДУЧП позволит найти общее решение исходной
            системы.
          </div>

          Рассмотрим ДУЧП 1 порядка относительно функции $z = z(x)$:
          \[
          \left\{
          \begin{aligned}
          F(x,z,p) &= 0, \\
          p_j &= \pd{z}{x_j}, & j = \overline{1,n},
          \end{aligned}
          \right.
          \]
          где $x \in D \subset \mathbb{R}^n, p \in \mathbb{R}^n$.

          <div class="definition">
            Любая функция $z = z(x)$, обращающая уравнение $F(x,z,p) = 0$ в
            тождество, называется <i>частным интегралом</i> этого уравнения.
          </div>

          <div class="definition">
            <i>Полным интегралом</i> называется любое $n$-параметрическое
            семейство функций $z = z(x, a)$ (где
            $a \in A \subset \mathbb{R}^n)$, для которого выполнены условия:
            <ul type="a">
              <li>
                функции $z, {\displaystyle \pd{z}{x_j}}$ непрерывно
                дифференцируемы на множестве $D \times A$;
              </li>

              <li>
                из уравнений
                \[
                p_j = \pd{z}{x_j}, \qquad j = \overline{1,n}
                \]
                исключением параметров $a$ получается уравнение $F(x,z,p) = 0$.
              </li>
            </ul>
          </div>

          Частные случаи:
          <ol>
            <li>
              $F(x,p) = 0$ &mdash; не зависит от $z$. Тогда
              \[
              z = z(x, a_1, \dots, a_{n-1}) + a_n
              \]
              &mdash; полный интеграл.
            </li>

            <li id="pde_missing_variables">
              $F(x_{k+1}, \dots, x_n, p_1, \dots, p_n) = 0$ &mdash; не зависит
              от $z$ и от $x_1, \dots, x_k$. Тогда
              \[
              z = \sum_{j=1}^k a_j x_j + \zeta(x_{k+1}, \dots, x_n).
              \]

              <div class="derivation">
                Учитывая
                \[
                p_j = \pd{z}{x_j}  = a_j, \qquad j = \overline{1,k},
                \]
                функцию $F(x_{k+1}, \dots, x_n, p_1, \dots, p_n)$ можно представить в виде
                \[
                F = F\paren{
                x_{k+1}, \dots, x_n, a_1, \dots, a_k,
                \pd{\zeta}{x_{k+1}} \dots \pd{\zeta}{x_n}
                } = 0.
                \]
                Так как $F$ не зависит от $\zeta$, то из первого пункта следует, что
                \[
                \zeta = \zeta(x_{k+1}, \dots, x_n, a_1, \dots, a_k, a_{k+1}, \dots, a_{n-1}) + a_n
                \]
                является полным интегралом, откуда следует, что
                \[
                z = \sum_{j=1}^k a_j x_j + \zeta(x_{k+1}, \dots, x_n)
                \]
                является полным интегралом уравнения $F(x_{k+1}, \dots, x_n, p_1, \dots, p_n) = 0$.
              </div>
            </li>
          </ol>

          <div class="statement">
            Если $F = F(x,p)$, то
            \[
            \frac{d x_1}{P_1} = \frac{d x_2}{P_2} = \cdots = \frac{d x_n}{P_n}
            = -\frac{d p_1}{X_1} = \cdots = -\frac{d p_n}{X_n},
            \]
            где
            \[
            P_j = {\displaystyle \pd{F}{p_j}},
            \qquad X_j = {\displaystyle \pd{F}{x_j}},
            \]
            является <i class="important">уравнением характеристик</i> для ДУЧП
            $F(x,p) = 0$.

            <div class="proof">
              См. <a
                href="https://en.wikipedia.org/wiki/Method_of_characteristics#Fully_nonlinear_case"
                target="_blank">вывод</a>.
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Уравнение Гамильтона-Якоби, главная функция Гамильтона
        </div>
        <div class="content">
          Рассмотрим канонические уравнения
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]
          Их можно записать в виде
          \[
          \frac{d q_1}{\partial H / \partial p_1}
          = \frac{d q_2}{\partial H / \partial p_2}
          = \cdots
          = \frac{d q_n}{\partial H / \partial p_n}
          = -\frac{d p_1}{\partial H / \partial q_1}
          = \cdots
          = -\frac{d p_n}{\partial H / \partial q_n}
          = \frac{dt}{1}.
          \]

          Эти уравнения могут рассматриваться как уравнения характеристик для
          ДУЧП 1-го порядка
          \[
          \pd{S}{t} + H\paren{q_1, \dots, q_n, \pd{S}{q_1}, \dots, \pd{S}{q_n}, t}
          = 0,
          \]
          которое называют <i class="important">уравнением Гамильтона-Якоби</i>.

          <p>
          Так как левая часть уравнения Гамильтона-Якоби не зависит от $S$, то
          полный интеграл этого ДУЧП представим в виде функции
          \[
          S = S(t, q_1, \dots, q_n, a_1, \dots, a_n) + a_{n+1},
          \]
          которую называют <i class="important">главной функцией Гамильтона</i>.
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Метод Якоби
        </div>
        <div class="content">
          <div class="theorem">
            <i>(Якоби)</i>.
            <br>
            Если $D \subset \mathbb{R}^{2n+1}$ &mdash; область, а $S(t,q,a) \in
            C^2(D)$ &mdash; полный интеграл вида
            \[
            S = S(t, q_1, \dots, q_n, a_1, \dots, a_n) + a_{n+1}
            \]
            уравнения
            \[
            \pd{S}{t} + H\paren{q_1, \dots, q_n, \pd{S}{q_1}, \dots, \pd{S}{q_n}, t}
            = 0,
            \]
            удовлетворяющий условию
            \[
            \det \paren{
            \ppdv{S}{q_i}{a_k}
            } \neq 0,
            \qquad (t,q,a) \in D,
            \]
            то существует область $D' \subset D \times \mathbb{R}^n$ такая, что
            равенства
            \[
            \left\{
            \begin{aligned}
            \pd{S}{q_i} &= p_i, \\
            \pd{S}{a_i} &= b_i, & i = \overline{1,n}
            \end{aligned}
            \right.
            \]
            представляют собой $2n$ независимых интегралов канонических
            уравнений
            \[
            \left\{
            \begin{aligned}
            \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
            \dot{p}_i &= -\pd{H}{q_i},
            \end{aligned}
            \right.
            \]
            где $a,b$ &mdash; произвольные постоянные.

            <div class="proof">
              Если для некоторого $(t_0, q_0, a_0) \in D$ выполнено
              \[
              \left\{
              \begin{aligned}
              \pd{S}{q_{0i}} &= p_{0i}, \\
              \pd{S}{a_{0i}} &= b_{0i}, & i = \overline{1,n},
              \end{aligned}
              \right.
              \]
              то из условия
              \[
              \det \paren{
              \ppdv{S}{q_i}{a_k}
              } \neq 0
              \]
              по <a href="#implicit-functions">теореме о неявных функциях</a>
              следует, что в некоторой окрестности точки $(t_0, q_0, a_0, b_0)$
              равенства
              \[
              \left\{
              \begin{aligned}
              \pd{S}{q_i} &= p_i, \\
              \pd{S}{a_i} &= b_i, & i = \overline{1,n}
              \end{aligned}
              \right.
              \]
              однозначно определяют дважды непрерывно дифференицруемые функции
              $p = p(t,a,b)$ и $q = q(t,a,b)$. Остаётся показать, что эти
              функции удовлетворяют каноническим уравнениям.

              <p>
              Подставим полученную функцию $q$ во вторую группу уравнений и
              продифференцируем их по $t$:
              \[
              \ppdv{S}{t}{a_i} + \sum_{k=1}^n \ppdv{S}{q_k}{a_i} \dv{q_k}{t}
              = 0, \qquad i = \overline{1,n}.
              \]
              С другой стороны, подставляя полный интеграл
              \[
              S = S(t, q_1, \dots, q_n, a_1, \dots, a_n) + a_{n+1}
              \]
              в уравнение Гамильтона-Якоби и дифференцируя полученное тождество
              по $a_i$, приходим к равенствам:
              \[
              \ppdv{S}{t}{a_i} + \sum_{k=1}^n \pd{H}{(\partial S /\partial q_k)}
              \ppdv{S}{q_k}{a_i} = 0, \qquad i = \overline{1,n}.
              \]
              Вычитая из полученных равенств предыдущие и учитывая равенства
              \[
              \left\{
              \begin{aligned}
              \pd{S}{q_i} &= p_i, \\
              \pd{S}{a_i} &= b_i, & i = \overline{1,n},
              \end{aligned}
              \right.
              \]
              получаем, что
              \[
              \sum_{k=1}^n \ppdv{S}{q_k}{a_i} \paren{
              \dv{q_k}{t} - \pd{H}{p_k}
              } = 0, \qquad i = \overline{1,n}.
              \]
              Так как
              \[
              \det \paren{
              \ppdv{S}{q_i}{a_k}
              } \neq 0,
              \qquad (t,q,a) \in D,
              \]
              то
              \[
              \dot{q}_i = \pd{H}{p_i}, \qquad i = \overline{1,n}.
              \]
              Аналогичным образом, подставляя полученную функцию $q$ в равенства
              \[
              p_i = \pd{S}{q_i}, \qquad i = \overline{1,n}
              \]
              и дифференцируя полученные тождества по $t$, а также подставляя
              полный интеграл $S$ в уравнение Гамильтона-Якоби и дифференцируя
              его по $q_i$, получаем вторую группу канонических уравнений.
              </p>
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Решение задачи о движении точки относительно планеты методом Якоби
        </div>
        <div class="content">
          <div class="images">
            <img src="images/11-1.png"/>
            <img src="images/11-2.png"/>
            <img src="images/11-3.png"/>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: скобки Пуассона
        </div>
        <div class="content">
          Рассмотрим две функции $f(q,p,t)$ и $g(q,p,t)$.

          <div class="definition">
            Выражение
            \[
            \pois{f, g} = \sum_{i=1}^n \paren{
            \pd{f}{q_i} \pd{g}{p_i} - \pd{g}{q_i} \pd{f}{p_i}
            }
            \]
            называют <i>скобками Пуассона</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Свойства скобок Пуассона
        </div>
        <div class="content">
          <ol class="big-height">
            <li>
              $\pois{f,g} = -\pois{g,f}$; $\pois{f,f} = 0$.
            </li>

            <li>
              Если $C = \const$, то $\pois{f,C} = \pois{C,f} = 0$.
            </li>

            <li>
              $\pois{f_1 + f_2, g} = \pois{f_1, g} + \pois{f_2, g}$.
              <br>
              $\pois{f_1 \cdot f_2, g} = f_1 \pois{f_2, g} + f_2 \pois{f_1, g}$.
            </li>

            <li>
              ${\displaystyle
              \pd{}{t} \pois{f,g} = \pois{\pd{f}{t}, g} + \pois{f, \pd{g}{t}}
              }$.
            </li>

            <li>
              ${\displaystyle
              \pois{f, q_k} = -\pd{f}{p_k}; \quad
              \pois{f, p_k} = \phantom{-}\pd{f}{q_k}
              }$.
            </li>

            <li>
              ${\displaystyle
              \pois{q_i, q_k} = 0;
              \quad \pois{p_i, p_k} = 0;
              \quad \pois{q_i, p_k} = \delta_{ik}.
              }$
            </li>

            <li>
              <i class="important">Тождество Пуассона</i>:
              \[
              \pois{f, \pois{g, h}}
              + \pois{g, \pois{h, f}}
              + \pois{h, \pois{f, g}} \equiv 0.
              \]
            </li>
          </ol>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Теорема Пуассона
        </div>
        <div class="content">
          Рассмотрим канонические уравнения:
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]

          Также рассмотрим функцию $f = f(q,p,t)$; её производная в силу системы
          равна
          \[
          \begin{aligned}
          \dv{f}{t}(q,p,t) &= \pd{f}{t} + \sum_{i=1}^n \left[
          \pd{f}{q_i} \dot{q}_i + \pd{f}{p_i} \dot{p_i}
          \right] = \\
          &=
          \pd{f}{t} + \sum_{i=1}^n \left[
          \pd{f}{q_i} \pd{H}{p_i} - \pd{f}{p_i} \pd{H}{q_i}
          \right], \\
          \implies
          \dv{f}{t}(q,p,t) &= \pd{f}{t} + \pois{f, H}.
          \end{aligned}
          \]

          Если $f(q,p,t)$ &mdash; первый интеграл канонической системы, то её
          производная в силу системы равна нулю, то есть
          \[
          \pd{f}{t} + \pois{f, H} = 0.
          \]

          <div class="theorem">
            <i>(Пуассона)</i>.
            <br>
            
            Если $\varphi(q,p,t)$ и $\psi(q,p,t)$ &mdash; первые интегралы
            канонической системы, то
            \[
            f = \pois{\varphi, \psi}
            \]
            также является первым интегралом этой системы.

            <div class="proof">
              Так как $\varphi$ и $\psi$ &mdash; первые интегралы, то
              \[
              \begin{aligned}
              \pd{\varphi}{t} + \pois{\varphi, H} &= 0, \\
              \pd{\psi}{t} + \pois{\psi, H} &= 0.
              \end{aligned}
              \]

              Рассмотрим тождество Пуассона:
              \[
              \pois{H, \pois{\varphi, \psi}}
              + \pois{\varphi, \pois{\psi, H}}
              + \pois{\psi, \pois{H, \varphi}} \equiv 0.
              \]
              Подставив
              \[
              \pois{\psi, H} = -\pd{\psi}{t}, \qquad
              \pois{\varphi, H} = -\pd{\varphi}{t},
              \]
              получим, что
              \[
              \begin{aligned}
              &\phantom{=} \pois{H, \pois{\varphi, \psi}}
              + \pois{\varphi, -\pd{\psi}{t}}
              + \pois{\psi, \pd{\varphi}{t}}
              = \\
              &= \pois{\pois{\varphi, \psi}, H}
              + \pois{\varphi, \pd{\psi}{t}}
              + \pois{\pd{\varphi}{t}, \psi}
              = \\
              &= 
              \pois{\pois{\varphi, \psi}, H}
              + \pd{}{t} \pois{\varphi, \psi} \equiv 0.
              \end{aligned}
              \]

              Отсюда следует, что $f \bydef= \pois{\varphi, \psi}$ также
              является первым интегралом канонической системы.
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Скобки Пуассона: построение интеграла в
          стационарном случае
        </div>
        <div class="content">
          Рассмотрим стационарный случай: $H = H(q,p)$. В этом случае $H =
          \const$ &mdash; первый интеграл канонической системы
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]
          Пусть $\varphi(q,p,t)$ также является первым интегралом системы, тогда
          по теореме Пуассона $f = \pois{\varphi, H} = \const$ &mdash; тоже
          первый интеграл. Но
          \[
          \pd{\varphi}{t} + \pois{\varphi, H} = 0, \implies
          f \bydef= \pois{\varphi, H} = -\pd{\varphi}{t} = \const,
          \]
          то есть ${\displaystyle -\pd{\varphi}{t} = \const}$ также является
          первым интегралом этой системы, то есть
          \[
          \pdv2{\varphi}{t} + \pois{\pd{\varphi}{t}, H} = 0,
          \]
          но по теореме Пуассона
          ${\displaystyle \pois{\pd{\varphi}{t}, H} = \const}$ также является
          первым интегралом, поэтому
          ${\displaystyle \pdv2{\varphi}{t} = \const}$ &mdash; тоже первый
          интеграл.

          <div class="theorem">
            Если система стационарна ($H = H(q,p)$) и известен первый интеграл
            $\varphi(q,p,t)$, причём $\varphi \in C^{k}_t$, то
            \[
            \pdvk{m}{f}{t} = \const, \qquad m = \overline{1,k}
            \]
            являются либо первыми интегралами, либо константами.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Вариации канонических переменных
        </div>
        <div class="content">
          Рассмотрим систему $N$ точек, подчинённую идеальным голономным
          удерживающим связям. Пусть $\bvec{r}_j$ и $\bvec{r}_j'$ &mdash; два
          бесконечно близких кинематических движения.

          <div class="definition">
            Величину
            \[
            \delta \bvec{v}_j = \bvec{v}_j' - \bvec{v}_j
            = \dv{}{t} \bvec{r}_j' - \dv{}{t} \bvec{r}_j
            \]
            называют <i>вариацией скорости $j$-ой точки системы</i>.
          </div>

          Рассмотрим проекции точек на оси координат: $(x_1, \dots, x_{3N})$.
          Тогда вариацию скорости можно записать в виде
          \[
          \delta \dot{x}_\nu = \dot{x}_\nu' - \dot{x}_\nu.
          \]
          Учитывая, что вариация координаты имеет вид
          \[
          \delta x_\nu = x_\nu' - x_\nu,
          \]
          получаем, что
          \[
          \dv{}{t} \delta x_\nu = \dot{x}_\nu' - \dot{x}_\nu
          \bydef= 
          \delta \dot{x}_\nu.
          \]
          Отсюда следует важный факт: <i class="important">операторы
            варьирования и дифференцирования перестановочны</i>.

          <p>
          Рассмотрим теперь обобщённые координаты $q = (q_1, \dots, q_s)$:
          \[
          \begin{aligned}
          x_\nu &= x_\nu(q_1, \dots, q_s, t), & \nu &= \overline{1,3N}, \\
          \bvec{r}_j &= \bvec{r}_j(q_1, \dots, q_s, t), & j &= \overline{1,N}.
          \end{aligned}
          \]
          Тогда
          \[
          \begin{aligned}
          \dot{x}_\nu &= \dv{}{t} x_\nu(q,t)
          = \pd{x_\nu}{t} + \sum_{i=1}^s \pd{x_\nu}{q_i} \dot{q}_i, \\
          \bvec{v}_j &= \dv{}{t} \bvec{r}_j(q,t)
          = \pd{\bvec{r}_j}{t} + \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dot{q}_i.
          \end{aligned}
          \]

          Рассмотрим вариацию скорости:
          \[
          \delta \bvec{v}_j
          = \sum_{i=1}^s \ppdv{\bvec{r}_j}{q_i}{t} \delta q_i
          + \sum_{i,k=1}^s \ppdv{\bvec{r}_j}{q_i}{q_k} \dot{q}_k \delta q_i
          + \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta \dot{q}_i.
          \]
          Продифференцируем равенство
          \[
          \delta \bvec{r}_j = \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \delta q_i
          \]
          по $t$:
          \[
          \begin{aligned}
          \dv{}{t} \delta \bvec{r}_j
          &= \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dv{}{t} \delta q_i
          + \sum_{i=1}^s \paren{
          \sum_{k=1}^s \ppdv{\bvec{r}_j}{q_k}{q_i} \dot{q}_k
          + \ppdv{\bvec{r}_j}{t}{q_i}
          } \delta q_i = \\
          &= \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \dv{}{t} \delta q_i
          + \sum_{i,k=1}^s \ppdv{\bvec{r}_j}{q_k}{q_i} \dot{q}_k \delta q_i
          + \sum_{i=1}^s \ppdv{\bvec{r}_j}{t}{q_i} \delta q_i.
          \end{aligned}
          \]

          Вычтем полученное равенство из уравнения вариации скорости:
          \[
          \sum_{i=1}^s \pd{\bvec{r}_j}{q_i} \paren{
          \delta \dot{q}_i - \dv{}{t} \delta q_i
          } = 0.
          \]
          Так как
          \[
          \rank \paren{ \pd{x_\nu}{q_i} } = s,
          \]
          то равенство возможно только при
          \[
          \delta \dot{q}_i = \dv{}{t} \delta q_i.
          \]
          </p>

          <div class="remark">
            Величины $\delta q_i$ независимы, поэтому из полученного равенства
            следует, что $\delta \dot{q}_i$ не являются независимыми от
            $\delta q_i$ как функции времени. С другой стороны, в любой
            фиксированный момент времени $t = \tilde t$ вариации
            $\delta \dot{q}_i$ и $\delta q_i$ можно рассматривать как
            независимые величины.
          </div>

          В канонических координатах
          \[
          p_i = \pd{L(q,p,t)}{\dot{q}_i},
          \]
          поэтому вариация обобщённых импульсов запишется в виде
          \[
          \delta p_i = \sum_{k=1}^s \left[
          \ppdv{L}{q_k}{\dot{q}_i} \delta q_k
          +
          \ppdv{L}{\dot{q}_k}{\dot{q}_i} \delta \dot{q}_k
          \right].
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Основной дифференциальный принцип механики
        </div>
        <div class="content">
          Рассмотрим общее уравнение механики в случае потенциального поля сил:
          \[
          \paren{
          \dv{}{t} \pd{L}{\dot{q}} - \pd{L}{q}
          } \delta q = 0.
          \]

          Рассмотрим уравнение
          \[
          \dv{}{t} \paren{
          \pd{L}{\dot{q}} \delta q
          }
          = \paren{ \dv{}{t} \pd{L}{\dot{q}} } \delta q
          + \pd{L}{\dot{q}} \delta \dot{q}.
          \]

          Так как
          \[
          \pd{L}{\dot{q}} \bydef= p,
          \]
          а из общего уравнения механики следует (в силу произвольности вариации
          $\delta q$), что
          \[
          \dv{}{t} \pd{L}{\dot{q}} = \pd{L}{q},
          \]
          то
          \[
          \begin{aligned}
          \dv{}{t} \paren{ p \delta q }
          &= \pd{L}{q} \delta q
          + \pd{L}{\dot{q}} \delta \dot{q} = \\
          &= \delta L.
          \end{aligned}
          \]

          <div class="definition">
            Уравнение
            \[
            \dv{}{t} \paren{p \delta q} = \delta L
            \]
            называют <i>основным дифференциальным принципом механики</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Вывод канонических уравнений из основного дифференциального принципа
        </div>
        <div class="content">
          Рассмотрим гамильтониан
          \[
          H \bydef= p \dot{q} - L, 
          \implies L = p \dot{q} - H.
          \]
          Тогда
          \[
          \delta L
          = \dot{q} \delta p + p \delta \dot{q}
          - \pd{H}{q} \delta q
          - \pd{H}{p} \delta p.
          \]

          Подставим это выражение в основной дифференциальный принцип:
          \[
          \begin{aligned}
          \delta L &= \dv{}{t} \paren{p \delta q}
          = \dot{p} \delta q + \cancel{p \delta \dot{q}} = \\
          &= \dot{q} \delta p + \cancel{p \delta \dot{q}}
          - \pd{H}{q} \delta q
          - \pd{H}{p} \delta p.
          \end{aligned}
          \]
          Перенося все слагаемые в левую часть, получаем, что
          \[
          \paren{
          \pd{H}{q} + \dot{p}
          } \delta q
          + \paren{
          \pd{H}{p} - \dot{q}
          } \delta p = 0,
          \]
          откуда, в силу независимости вариаций $\delta q$ и $\delta p$,
          выводятся канонические уравнения:
          \[
          \left\{
          \begin{aligned}
          \dot{q} &= \phantom{-}\pd{H}{p}, \\
          \dot{p} &= -\pd{H}{q}.
          \end{aligned}
          \right.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: функционал действия
        </div>
        <div class="content">
          <div class="definition">
            Величину
            \[
            W = \int\limits_{t_1}^{t_2} L(q'(t), \dot{q}'(t), t) dt,
            \]
            где
            <ul>
              <li>
                $L$ &mdash; функция Лагранжа механической системы;
              </li>

              <li>
                $q'(t) = \paren{ q_1'(t), \dots, q_s'(t) }$ &mdash; любое
                кинематически возможное движение;
              </li>
            </ul>

            называют <i>действием (по Гамильтону)</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: изохронная вариация функционала действия
        </div>
        <div class="content">
          <div class="definition">
            Бесконечно малую величину
            \[
            \delta \int\limits_{t_1}^{t_2} L dt
            =
            \int\limits_{t_1}^{t_2} L(q', \dot{q}', t) dt
            -
            \int\limits_{t_1}^{t_2} L(q, \dot{q}, t) dt,
            \]
            рассматриваемую как функционал от $q'(t)$, называют
            <i>изохронной вариацией функционала действия</i>.
          </div>

          В силу перестановочности операторов варьирования и дифференцирования
          \[
          \delta \int\limits_{t_1}^{t_2} L dt = 
          \int\limits_{t_1}^{t_2} \delta L dt,
          \]
          причём равенство понимается как равенство с точностью до бесконечно
          малых высшего порядка.

          <p>
          Используя основной дифференциальный принцип
          \[
          \dv{}{t} \paren{p \delta q} = \delta L,
          \]
          получаем, что
          \[
          \delta \int\limits_{t_1}^{t_2} L dt
          = \left.\paren{ p \delta q }\right|_{t_1}^{t_2}.
          \]
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: полная вариация координат, скоростей и функций
        </div>
        <div class="content">
          <div class="definition">
            Бесконечно малые величины
            \[
            \begin{gathered}
            \Delta q = q'(t + \Delta t) - q(t), \\
            \Delta \dot{q} = \dot{q}'(t + \Delta t) - \dot{q}(t)
            \end{gathered}
            \]
            при
            <ul>
              <li>
                $\Delta t \to 0$;
              </li>

              <li>
                $q' \to q$;
              </li>

              <li>
                $\dot{q}' \to \dot{q}$
              </li>
            </ul>

            называют <i>полными вариациями координат и скоростей</i>.
          </div>

          <div class="definition">
            <i>Полная вариация $\Delta \Phi$ функции $\Phi(q, \dot{q}, t)$</i>
            определяется как
            \[
            \Delta \Phi(q, \dot{q}, t)
            = \Phi(q'(t + \Delta t), \dot{q}'(t + \Delta t), t + \Delta t)
            - \Phi(q, \dot{q}, t).
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Вывод формул, связывающих полную и изохронную вариации координат,
          скоростей и функций
        </div>
        <div class="content">
          Рассмотрим полную вариацию
          \[
          \begin{aligned}
          \Delta q &= q'(t + \Delta t) - q(t) = \\
          &= q'(t + \Delta t) - q(t + \Delta t) + q(t + \Delta t) - q(t) = \\
          &= \left.\delta q\right|_{t + \Delta t} + \dot{q}(t) \Delta t.
          \end{aligned}
          \]
          В силу перестановочности операторов варьирования и дифференцирования
          \[
          \begin{aligned}
          \left. \delta q \right|_{t + \Delta t}
          &= \left. \delta q \right|_t
          + \Delta t \at{\dv{}{t} \delta q}{t} = \\
          &= \left. \delta q \right|_t
          + \Delta t \left. \delta \dot{q} \right|_t.
          \end{aligned}
          \]

          Подставляя это выражение в исходное уравнение и отбрасывая член
          второго порядка малости (при $\delta \dot{q}$), получаем искомую
          формулу:
          \[
          \Delta q = \delta q + \dot{q} \Delta t.
          \]

          Аналогично получаем, что
          \[
          \Delta \dot{q} = \delta \dot{q} + \ddot{q} \Delta t.
          \]

          Наконец, используя формулы
          \[
          \begin{aligned}
          \Delta \Phi
          &= \pd{\Phi}{q} \Delta q
          + \pd{\Phi}{\dot{q}} \Delta \dot{q}
          + \pd{\Phi}{t} \Delta t, \\
          \delta \Phi
          &= \pd{\Phi}{q} \delta q
          + \pd{\Phi}{\dot{q}} \delta \dot{q},
          \end{aligned}
          \]
          приходим к равенству:
          \[
          \Delta \Phi = \delta \Phi + \dot{\Phi} \Delta t.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: полная вариация функционала действия
        </div>
        <div class="content">
          <div class="definition">
            Бесконечно малую величину
            \[
            \Delta \int\limits_{t_1}^{t_2} L dt
            =
            \int\limits_{t_1 + \Delta t_1}^{t_2 + \Delta t_2}
            L(q', \dot{q}', t) dt
            -
            \int\limits_{t_1}^{t_2} L(q, \dot{q}, t) dt
            \]
            при
            <ul>
              <li>
                $\Delta t_1, \Delta t_2 \to 0$;
              </li>

              <li>
                $q' \to q$;
              </li>

              <li>
                $\dot{q}' \to \dot{q}$
              </li>
            </ul>

            называют <i>полной вариацией функционала действия</i>.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Вывод формулы, связывающей полную и изохронную вариации функционала
          действия
        </div>
        <div class="content">
          Введём обозначения
          \[
          L_i = L(q(t_i), \dot{q}(t_i), t_i), \qquad i = 1,2
          \]
          и учитывая, что
          \[
          \Delta t_1, \Delta t_2 \to 0,
          \quad q' \to q, 
          \quad \dot{q}' \to \dot{q},
          \]
          последовательно получаем
          \[
          \begin{aligned}
          \Delta \int\limits_{t_1}^{t_2} L dt
          &=
          \int\limits_{t_1 + \Delta t_1}^{t_2 + \Delta t_2}
          L(q', \dot{q}', t) dt
          -
          \int\limits_{t_1}^{t_2} L(q, \dot{q}, t) dt = \\
          &=
          \int\limits_{t_1 + \Delta t_1}^{t_1}
          L(q', \dot{q}', t) dt
          +
          \int\limits_{t_1}^{t_2}
          L(q', \dot{q}', t) dt + \\
          &\phantom{=} +
          \int\limits_{t_2}^{t_2 + \Delta t_2}
          L(q', \dot{q}', t) dt
          -
          \int\limits_{t_1}^{t_2} L(q, \dot{q}, t) dt = \\
          &=
          \int\limits_{t_1}^{t_2}
          \left[ L(q', \dot{q}', t) - L(q, \dot{q}, t) \right] dt -\\
          &\phantom{=}-
          \int\limits_{t_1}^{t_1 + \Delta t_1}
          L(q', \dot{q}', t) dt
          +
          \int\limits_{t_2}^{t_2 + \Delta t_2}
          L(q', \dot{q}', t) dt.
          \end{aligned}
          \]

          Пусть $G(q', \dot{q}', t)$ &mdash; первообразная функции
          $L(q', \dot{q}', t)$. Тогда, учитывая, что $\Delta t_1 \to 0$,
          и пользуясь определением производной, получаем, что
          \[
          \begin{aligned}
          \int\limits_{t_1}^{t_1 + \Delta t_1} L(q', \dot{q}', t) dt
          &= \left. G(q', \dot{q}', t) \right|_{t_1}^{t_1 + \Delta t_1} = \\
          &= G'( q'(t_1), \dot{q}'(t_1), t_1 ) \Delta t_1 = \\
          &= L( q'(t_1), \dot{q}'(t_1), t_1 ) \Delta t_1.
          \end{aligned}
          \]

          Аналогично
          \[
          \int\limits_{t_2}^{t_2 + \Delta t_2} L(q', \dot{q}', t) dt
          = L( q'(t_2), \dot{q}'(t_2), t_2 ) \Delta t_2,
          \]

          поэтому
          \[
          \begin{aligned}
          \Delta \int\limits_{t_1}^{t_2} L dt
          &=
          \int\limits_{t_1}^{t_2} \delta L dt
          -
          L(q'(t_1), \dot{q}'(t_1), t_1) \Delta t_1
          +
          L(q'(t_2), \dot{q}'(t_2), t_2) \Delta t_2 = \\
          &=
          \int\limits_{t_1}^{t_2} \delta L dt
          - L_1 \Delta t_1 + L_2 \Delta t_2.
          \end{aligned}
          \]

          Используя равенство
          \[
          \delta \int\limits_{t_1}^{t_2} L dt
          = \left.\paren{ p \delta q }\right|_{t_1}^{t_2},
          \]
          можно записать, что
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          =
          \left.
          \paren{
          p \delta q + L \Delta t
          }
          \right|_{t_1}^{t_2}.
          \]

          Учитывая, что
          \[
          \Delta q = \delta q + \dot{q} \Delta t,
          \]
          а также определение гамильтониана
          \[
          H \bydef= p \dot{q} - L,
          \]
          окончательно получаем, что
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          =
          \left.
          \paren{
          p \Delta q - H \Delta t
          }
          \right|_{t_1}^{t_2}.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Принцип Гамильтона-Остроградского
        </div>
        <div class="content">
          Пусть $q = (q_1, \dots, q_s)$ &mdash; лагранжевы координаты голономной
          механической системы, имеющей $s$ степеней свободы и находящейся под
          действием только потенциальных сил.

          <p>
          Если $(t_1, t_2)$ &mdash; произвольный промежуток, причём
          \[
          \left. \delta q_i \right|_{t_1} = 
          \left. \delta q_i \right|_{t_2} = 0, \quad i = \overline{1,s},
          \]
          то равенство
          \[
          \delta \int\limits_{t_1}^{t_2} L dt
          = \left. \paren{ p \delta q } \right|_{t_1}^{t_2}
          \]
          примет вид
          \[
          \delta \int\limits_{t_1}^{t_2} L dt = 0.
          \]
          </p>

          <div id="hamilton-ostrogradskiy" class="statement">
            <i>(принцип Гамильтона-Остроградского)</i>.
            <br>
            
            Пусть все действующие на механическую систему активные силы
            потенциальны, а её движения стеснены только голономными идеальными
            удерживающими связями. Тогда истинные движения этой системы,
            удовлетворяющие условиям
            \[
            \delta \int\limits_{t_1}^{t_2} L dt
            = \left. \paren{ p \delta q } \right|_{t_1}^{t_2},
            \]
            принадлежат тому подмножеству множества всех кинематически возможных
            её движений, для которых выполнено равенство
            \[
            \delta \int\limits_{t_1}^{t_2} L dt = 0.
            \]
          </div>

          Другими словами: действие на истинном движении имеет стационарное
          значение по Гамильтону.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Вывод уравнений Лагранжа II рода из принципа Гамильтона-Остроградского
        </div>
        <div class="content">
          Так как операторы варьирования и дифференцирования перестановочны и
          \[
          \begin{aligned}
          \delta L
          &= \pd{L}{q} \delta q + \pd{L}{\dot{q}} \delta \dot{q} = \\
          &= \dv{}{t} \paren{
          \pd{L}{\dot{q}} \delta q
          }
          - \paren{
          \dv{}{t} \pd{L}{\dot{q}} - \pd{L}{q}
          } \delta q,
          \end{aligned}
          \]
          то
          \[
          \delta W
          = \delta \int\limits_{t_1}^{t_2} L dt
          = \int\limits_{t_1}^{t_2} \paren{
          \pd{L}{q} - \dv{}{t} \pd{L}{\dot{q}}
          } \delta q dt
          + \left. \paren{
          \pd{L}{\dot{q}} \delta q
          } \right|_{t_1}^{t_2}.
          \]

          Так как
          \[
          \left. \delta q_i \right|_{t_1} = 
          \left. \delta q_i \right|_{t_2} = 0, \quad i = \overline{1,s},
          \]
          в силу <a href="#hamilton-ostrogradskiy">принципа
            Гамильтона-Остроградского</a> получаем, что
          \[
          \int\limits_{t_1}^{t_2} \left[
          \paren{
          \dv{}{t} \pd{L}{\dot{q}} - \pd{L}{q}
          } \delta q
          \right] dt = 0,
          \]
          откуда следует, что
          \[
          \paren{
          \dv{}{t} \pd{L}{\dot{q}} - \pd{L}{q}
          } \delta q = 0.
          \]

          <div class="todo">
            Доказать от противного (см. Бабаджанянц, стр. 183).
          </div>

          В силу независимости вариаций $\delta q$ следуют уравнения Лагранжа II
          рода:
          \[
          \dv{}{t} \pd{L}{\dot{q}} - \pd{L}{q} = 0.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Действие &mdash; решение уравнений Гамильтона-Якоби
        </div>
        <div class="content">
          Пусть $q$ &mdash; решение уравнений движения рассматриваемой системы.
          Введём в рассмотрение величину
          \[
          W = \int\limits_{t_1}^{t_2} L(q, \dot q, t) dt,
          \]
          совпадающую с функционалом действия при $q' = q$. С другой стороны,
          полагая, что решение $q$ однозначно определяется начальным
          $q^1 = q(t_1)$ и конечным $q^2 = q(t_2)$ положениями, можно
          рассматривать величину $W$ как функцию $W(q^1, q^2, t_1, t_2)$
          параметров $q^1, q^2, t_1, t_2$.

          <div class="definition">
            Функцию $W = W(q^1, q^2, t_1, t_2)$ называют <i>функцией
              действия</i>.
          </div>

          <p>
          Будем предполагать, что функция действия $W(q^1, q^2, t_1, t_2)$
          определена в некоторой области $D_W \subset \mathbb{R}^{2s+2}$.
          </p>

          Из определения функции действия (то есть в силу того, что движение
          истинное) следует, что
          \[
          \Delta t = dt, \quad \Delta q = dq, \quad \Delta W = dW,
          \]
          поэтому уравнение
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          =
          \left.
          \paren{
          p \Delta q - H \Delta t
          }
          \right|_{t_1}^{t_2}
          \]
          примет вид
          \[
          \begin{aligned}
          dW &= \left. \paren{
          p dq - H dt
          } \right|_{t_1}^{t_2}, \\
          \implies
          W &= \left. \paren{
          p q - H t
          } \right|_{t_1}^{t_2}.
          \end{aligned}
          \]

          Тогда
          \[
          \left\{
          \begin{aligned}
          \pd{W}{q_2} &= p^2 = \left. p \right|_{t_2}, \\
          \pd{W}{t_2} &= -H(q^2, p^2, t_2).
          \end{aligned}
          \right.
          \]
          Подставляя первое уравнение во второе, получаем
          \[
          \pd{W}{t_2} + H\paren{q^2, \pd{W}{q_2}, t_2} = 0
          \]
          то есть функция действия $W = W(q^1, q^2, t_1, t_2)$ задаёт
          $s+1$-параметрическое семейство решений уравнений Гамильтона-Якоби по
          переменным $q^2, t_2$ при таких значениях параметров $q^1, t_1$, что
          $(q^1, q^2, t_1, t_2) \in D_W$.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Принцип Эйлера-Лагранжа
        </div>
        <div class="content">
          Рассмотрим голономную механическую систему с идеальными связями,
          имеющую $s$ степеней свободы и находящуюся под действием только
          потенциальных сил. Также пусть лагранжевы координаты связаны c
          декартовыми координатами стационарными соотношениями и пусть
          ${\displaystyle \pd{H}{t} = 0}$. В этом случае гамильтониан является
          первым интегралом уравнений движения, то есть
          \[
          H = T + \Pi = h,
          \]
          где $h$ принимает конкретное значение для каждого конкретного движения
          системы. Отсюда также следует, что
          \[
          L = T - \Pi = 2T - h.
          \]

          <p>
          Среди кинематически возможных вариаций выделим только те, которые
          соответствуют выполнению равенства
          \[
          T + \Pi = h,
          \]
          из которого следует, что
          \[
          \Delta h = \pd{h}{\dot{q}} \Delta \dot q + \pd{h}{q} \Delta q = 0.
          \]
          Считаем вариации $\Delta q$ независимыми, а $\Delta t$ выберем так,
          чтобы выполнялось предыдущее уравнение.
          </p>

          <div class="remark">
            Кинетическая энергия
            \[
            T(q, \dot q, t) = h - \Pi(q, t)
            \]
            зависит от того, в какой точке находится объект. Соответственно,
            скорость объекта также зависит от пути &mdash; значит, выбирая
            разные траектории, объект на перемещение затратит, вообще говоря,
            разное время. Именно поэтому следует рассматривать полную вариацию.
          </div>

          <p>
          Из формул
          \[
          \begin{aligned}
          \Delta q &= \delta q + \dot q \Delta t, \\
          \Delta \dot q &= \delta \dot q + \ddot q \Delta t
          \end{aligned}
          \]
          следует
          \[
          \begin{aligned}
          \dv{}{t} \Delta q
          &= \dv{}{t} \delta q + \ddot q \Delta t
          + \dot q \dv{}{t} \Delta t = \\
          &= \Delta \dot q + \dot q \dv{}{t} \Delta t, \\
          \implies
          \Delta \dot q
          &= \dv{}{t} \Delta q - \dot q \dv{}{t} \Delta t.
          \end{aligned}
          \]

          Тогда
          \[
          \begin{aligned}
          \Delta h
          &=
          \pd{h}{\dot{q}} \Delta \dot q + \pd{h}{q} \Delta q = \\
          &=
          \pd{h}{\dot{q}} \dv{}{t} \Delta q
          - \pd{h}{\dot{q}} \dot q \dv{}{t} \Delta t
          + \pd{h}{q} \Delta q = 0,
          \end{aligned}
          \]
          откуда следует равенство
          \[
          \pd{h}{\dot{q}} \dv{}{t} \Delta q
          + \pd{h}{q} \Delta q = \pd{h}{\dot{q}} \dot q \dv{}{t} \Delta t.
          \]
          </p>

          <p>
          В рассматриваемом случае
          \[
          \pd{\Pi}{\dot{q}} = 0, \quad T = T_2,
          \]
          причём $T_2$ &mdash; квадратичная форма по $\dot{q}_i$, поэтому
          \[
          \pd{h}{\dot{q}} \dot{q} = \pd{\paren{T + \Pi}}{\dot{q}} \dot{q}
          = \pd{T_2}{\dot{q}} \dot{q} = 2T_2 = 2T.
          \]
          </p>

          <p>
          Подставляя полученное уравнение в формулу
          \[
          \pd{h}{\dot{q}} \dv{}{t} \Delta q
          + \pd{h}{q} \Delta q = \pd{h}{\dot{q}} \dot q \dv{}{t} \Delta t,
          \]
          приходим к
          \[
          \dv{}{t} \Delta t = \frac{1}{2T} \paren{
          \pd{h}{\dot{q}} \dv{}{t} \Delta q + \pd{h}{q} \Delta q
          }.
          \]
          Интегрируя это равенство от $t_1$ до $t$, получаем
          \[
          \Delta t
          = \Delta t_1
          + \int\limits_{t_1}^t \frac{1}{2T} \paren{
          \pd{h}{\dot{q}} \dv{}{t} \Delta q + \pd{h}{q} \Delta q
          } dt,
          \]
          где
          <ul>
            <li>
              $\Delta q_i$ &mdash; независимые вариации координат,
            </li>

            <li>
              $\Delta t_1$ &mdash; независимая точечная вариация (значение
              $\Delta t$ в точке $t = t_1$).
            </li>
          </ul>

          Учитывая, что $\Delta t_1 = 0$, получаем, что
          \[
          \Delta t_2
          = \int\limits_{t_1}^{t_2} \frac{1}{2T} \paren{
          \pd{h}{\dot{q}} \dv{}{t} \Delta q + \pd{h}{q} \Delta q
          } dt.
          \]
          </p>

          <p>
          Обратимся теперь к формуле для полной вариации функционала действия:
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          = \left. \paren{ p \Delta q - H \Delta t } \right|_{t_1}^{t_2}.
          \]
          Учитывая условия
          \[
          \Delta t_1 = 0, \quad \left. \Delta q \right|_{t_1, t_2} = 0,
          \]
          получаем, что
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          = -h \Delta t_2.
          \]
          Кроме того, из формулы
          \[
          L = 2T - h
          \]
          следует, что
          \[
          \Delta \int\limits_{t_1}^{t_2} L dt
          =
          \Delta \int\limits_{t_1}^{t_2} 2T dt
          - h \Delta t_2,
          \]
          поэтому
          \[
          \Delta \int\limits_{t_1}^{t_2} 2T dt = 0,
          \]
          то есть полная вариация <i class="important">действия по Лагранжу</i>
          равна нулю.
          </p>

          <div class="statement">
            <i>(принцип Эйлера-Лагранжа)</i>.
            <br>

            Пусть все действующие на механическую систему активные силы
            потенциальны, её движение стеснено только голономными идеальными
            удерживающими связями, лагранжевы координаты системы связаны с
            декартовыми координатами стационарными соотношениями, а гамильтониан
            не зависит от времени явно. Тогда истинные движениия этой системы,
            удовлетворяющие условию
            \[
            \Delta t_1 = 0, \quad \left. \Delta q \right|_{t_1, t_2} = 0,
            \]
            принадлежат тому подмножеству множества всех кинематически возможных
            её движений, для которых выполнено равенство
            \[
            \Delta \int\limits_{t_1}^{t_2} 2T dt = 0
            \]
            с учётом того, что
            \[
            \Delta t_2
            = \int\limits_{t_1}^{t_2} \frac{1}{2T} \paren{
            \pd{h}{\dot{q}} \dv{}{t} \Delta q + \pd{h}{q} \Delta q
            } dt,
            \]
          </div>

          Иначе говоря, принцип Эйлера-Лагранжа означает, что среди всех
          кинематически возможных движений данной системы, удовлетворяющих
          условиям
          \[
          \Delta t_1 = 0, \quad \left. \Delta q \right|_{t_1, t_2} = 0,
          \]
          истинное движение таково, что для него полная вариация действия по
          Лагранжу равна нулю.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Контактные преобразования
        </div>
        <div class="content">
          <p>
            Удачый выбор обобщённых координат может существенно облегчить исследования уравнений
            движения, которые при любом выборе координат
            \[
            q_i' = q_i'(q_1, \dots, q_k, t), \qquad q_i' \in C^2, \quad \overline{1,s}
            \]
            можно записать в форме Лагранжа II-го рода или в каноническом виде.
          </p>

          <div class="definition">
            Преобразование
            \[
            q_i' = q_i'(q_1, \dots, q_s, t), \qquad q_i' \in C^2, \quad \overline{1,s}
            \]
            называется <i>точечным</i>.
          </div>

          <p>
            Если одновременно с заменой координат перейти к новым обобщённым импульсам по
            формулам
            \[
            \begin{aligned}
            q_i' &= q_i'(q_1, \dots, q_s, p_1, \dots, p_s, t), \\
            p_i' &= p_i'(q_1, \dots, q_s, p_1, \dots, p_s, t),
            \end{aligned}
            \]
            то в общем случае уравнения движения не сохраняют канонического вида. Однако при
            определённых условиях это преобразование к новым переменным позволяет вместо уравнений
            \[
            \begin{aligned}
            \dot q = \phantom{-} \pd{H}{p}, \\
            \dot p = - \pd{H}{q}
            \end{aligned}
            \]
            с произвольной функцией $H(q, p, t)$ получить канонические уравнения относительно
            новых переменных с новой функцией Гамильтона $H'(q', p', t)$.
          </p>

          <div class="definition">
            Формулы
            \[
            \begin{aligned}
            q_i' &= q_i'(q_1, \dots, q_s, p_1, \dots, p_s, t), \\
            p_i' &= p_i'(q_1, \dots, q_s, p_1, \dots, p_s, t)
            \end{aligned}
            \]
            определяют <i>каноническое преобразование</i>, если любая каноническая система
            уравнений переводится в каноническую.
          </div>

          Рассмотрим канонические уравнения
          \[
          \left\{
          \begin{aligned}
          \dot{q}_i &= \phantom{-}\pd{H}{p_i}, \\
          \dot{p}_i &= -\pd{H}{q_i}.
          \end{aligned}
          \right.
          \]

          Введём функции $Q = (Q_1, \dots, Q_n)$ и $P = (P_1, \dots, P_n)$:
          \[
          \left\{
          \begin{aligned}
          Q_i &= Q_i(q,p,t), \\
          P_i &= P_i(q,p,t).
          \end{aligned}
          \right.
          \]

          <div class="definition">
            Если существует функция $H'$ такая, что выполняются соотношения
            \[
            \left\{
            \begin{aligned}
            \dot{Q}_i &= \phantom{-}\pd{H'}{P_i}, \\
            \dot{P}_i &= -\pd{H'}{Q_i},
            \end{aligned}
            \right.
            \]
            то формулы
            \[
            \left\{
            \begin{aligned}
            Q_i &= Q_i(q,p,t), \\
            P_i &= P_i(q,p,t)
            \end{aligned}
            \right.
            \]
            определяют <i>каноническое преобразование</i>.
          </div>

          <div class="definition">
            Говорят, что каноническое преобразование
            \[
            \left\{
            \begin{aligned}
            Q_i &= Q_i(q,p,t), \\
            P_i &= P_i(q,p,t)
            \end{aligned}
            \right.
            \]
            является <i>контактным</i>, если выполняется одно из следующих
            условий:

            <ol type="a">
              <li>
                $p \delta q + Q \delta P = \delta S(q,P,t)$, или
                \[
                \left\{
                \begin{aligned}
                p_i &= \pd{S}{q_i}, \\
                Q_i &= \pd{S}{P_i},
                \end{aligned}
                \right.
                \]
              </li>

              <li>
                $p \delta q - P \delta Q = \delta S(q,Q,t)$, или
                \[
                \left\{
                \begin{aligned}
                p_i &= \pd{S}{q_i}, \\
                P_i &= -\pd{S}{Q_i},
                \end{aligned}
                \right.
                \]
              </li>

              <li>
                $q \delta p - Q \delta P = \delta S(p,P,t)$, или
                \[
                \left\{
                \begin{aligned}
                q_i &= \pd{S}{p_i}, \\
                Q_i &= -\pd{S}{P_i},
                \end{aligned}
                \right.
                \]
              </li>

              <li>
                $q \delta p + P \delta Q = \delta S(p,Q,t)$, или
                \[
                \left\{
                \begin{aligned}
                q_i &= \pd{S}{p_i}, \\
                P_i &= \pd{S}{Q_i}.
                \end{aligned}
                \right.
                \]
              </li>
            </ol>

            Функция $S$ называется <i>производящей (преобразующей)</i>.
          </div>

          <div class="theorem">
            <ol>
              <li>
                Любое контактное преобразование является каноническим.
              </li>

              <li>
                Гамильтониан $H'$ преобразованной системы связан с $H$ исходной
                системы следующим соотношением:
                \[
                H' = H + \pd{S}{t}.
                \]
              </li>
            </ol>

            <div class="proof">
              Рассмотрим, например,
              \[
              p \delta q + Q \delta P = \delta S(q,P,t).
              \]

              Продифференцируем по $t$:
              \[
              \dv{}{t} \paren{ p \delta q} + \dot Q \delta P
              + Q \dv{}{t} \delta P = \dv{}{t} \delta S(q, P, t).
              \]
              Пользуясь тем, что операции варьирования и дифференцирования перестановочны:
              \[
              \dv{}{t} \delta P = \delta \dot P,
              \]
              а также тем, что
              \[
              \dv{}{t} (p \delta q) = \delta L,
              \quad
              H = p \dot q - L
              \implies
              \dv{}{t} (p \delta q) = \delta \paren{ -H + p \dot q },
              \]
              получаем, что
              \[
              \delta L + \dot Q \delta P + Q \delta \dot P
              =
              \delta \dot s(q, P, t)
              =
              \delta \paren{
              \pd{S}{q} \dot q + \pd{S}{P} \dot P + \pd{S}{t}
              }
              \]

              <p>
                Заметим, что уравнение
                \[
                p \delta q + Q \delta P = \delta S(q,P,t)
                \]
                равносильно системе
                \[
                \left\{
                \begin{aligned}
                p_i &= \pd{S}{q_i}, \\
                Q_i &= \pd{S}{P_i},
                \end{aligned}
                \right.
                \]
                откуда следует, что
                \[
                \begin{aligned}
                \delta L + \dot Q \delta P + Q \delta \dot P
                &=
                \delta \paren{ p \dot q + Q \dot P + \pd{S}{t} }, \implies \\
                \implies
                \delta \paren{ L - p \dot q - \pd{S}{t} }
                &=
                \dot P \delta Q + \cancel{Q \delta \dot P}
                - \dot Q \delta P - \cancel{Q \delta \dot P}, \implies \\
                \implies
                \delta \paren{ L - p \dot q - \pd{S}{t} }
                &=
                \dot P \delta Q - \dot Q \delta P.
                \end{aligned}
                \]
                Воспользуемся тем, что
                \[
                \dot P \delta Q = \dv{}{t} \paren{ P \delta Q } - P \delta \dot Q,
                \]
                тогда
                \[
                \delta \paren{ L - p \dot q - \pd{S}{t} + \dot P Q }
                =
                \dv{}{t} \paren{ P \delta Q }.
                \]
                Используя определение гамильтониана, это равенство можно записать в виде
                \[
                \delta \paren{ - H - \pd{S}{t} + \dot P Q }
                =
                \dv{}{t} \paren{ P \delta Q }.
                \]

                Рассмотрим теперь основной дифференциальный принцип в новых координатах:
                \[
                \dv{}{t} \paren{ P \delta Q } = \delta L',
                \]
                причём $L'$ можно выразить через гамильтониан в новых координатах:
                \[
                H' = P \dot Q - L'
                \implies L' = P \dot Q - H',
                \]
                откуда следует, что
                \[
                \dv{}{t} \paren{ P \delta Q } = \delta \paren{ P \dot Q - H' }.
                \]

                Но
                \[
                \delta \paren{ - H - \pd{S}{t} + \dot P Q }
                =
                \dv{}{t} \paren{ P \delta Q },
                \]
                откуда следует, что
                \[
                H' = H + \pd{S}{t}.
                \]
              </p>
            </div>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Контактные преобразования и уравнения Гамильтона-Якоби
        </div>
        <div class="content">
          <p>
            Попробуем найти такую производящую функцию $S(q, p', t)$, чтобы контактное
            преобразование переводило исходные переменные $q, p$ в постоянные величины
            \[
            p_i' = \alpha_i = \const, \qquad q_i' = \beta_i = \const.
            \]
            Такая функция должна удовлетворять равенствам
            \[
            p_i = \pd{S}{q_i} = p_i(q, p', t),
            \qquad
            q_i' = \pd{S}{\alpha_i} = \beta_i.
            \]
            Кроме того, новые переменные должны удовлетворять каноническим уравнениям с
            гамильтонианом
            \[
            H' = H + \pd{S}{t}.
            \]
            В этом случае
            \[
            \begin{aligned}
            \dot q_i' &= 0 = \pd{H'}{p'}, \\
            \dot p_i' &= 0 = \pd{H'}{q'}, & i = \overline{1,s}.
            \end{aligned}
            \]
            Следовательно, новая функция Гамильтона $H'(q', p', t)$ не зависит от новых переменных
            $q', p'$. Тогда должно выполняться равенство
            \[
            H\paren{ q, \pd{S}{q}, t } + \pd{S}{t} = f(t),
            \]
            которое называют <i class="important">уравнением Гамильтона-Якоби</i>. Правая часть
            представляет собой произвольную функцию времени $f(t)$.
          </p>

          <p>
            Вместо этого уравнения можно рассмотреть другое уравнение в частных производных,
            которому должна удовлетворять производящая функция $\tilde S(q, \alpha, t)$:
            \[
            H\paren{ q, \pd{\tilde S}{q}, t } + \pd{\tilde S}{t} = 0,
            \]
            где
            \[
            \tilde S = S - \int\limits_{t_0}^{t} f(\tau) d\tau.
            \]
          </p>

          <p>
            Таким образом, для решения поставленной задачи нужно найти полное решение
            (<i>полный интеграл</i>) уравнения Гамильтона-Якоби, которое будет зависеть от $s$
            постоянных $\alpha$ и аддитивной постоянной $\alpha_0$ в виде
            \[
            \tilde S = \psi(q, \alpha, t) + \alpha_0.
            \]
            Тогда задача интегрирования канонических уравнений заменяется нахождением
            решения уравнения Гамильтона-Якоби. Если функция $\tilde S$ получена, она
            порождает контактное преобразование
            \[
            p_i = \pd{\psi}{q_i}, \qquad \beta_i = \pd{\psi}{\alpha_i}.
            \]
            Разрешая последние уравнения относительно $q$, получим явное решение исходных
            уравнений движения:
            \[
            q_i = q_i(t, \alpha, \beta), \qquad p_i = p_i(t, \alpha, \beta).
            \]
          </p>

          <p>
            Если рассматривать движение механической системы со стационарными связями, то
            функция Гамильтона не зависит явно от времени. Тогда можно искать решение $\u{S}$
            уравнения Гамильтона-Якоби вида
            \[
            H\paren{ q, \pd{\u{S}}{q} } = h.
            \]
            После этого получим
            \[
            S(q, \alpha, t) = -h t + \u{S}(q, \alpha),
            \]
            где $h = \alpha_1$.
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Геометрия масс. Моменты инерции. Тензор инерции. Эллипсоид инерции
        </div>
        <div class="content">
          Пусть $x,y,z$ &mdash; декартовы координаты произвольной точки твёрдого
          тела. Пусть плотность тела $\rho = \rho(x,y,z)$ &mdash; непрерывная
          функция координат в области $V$, занимаемой телом.

          <div class="definition">
            Величину
            \[
            \iiint\limits_V \rho(x,y,z) x^i y^j z^k dx dy dz,
            \qquad i,j,k \in [0; +\infty)
            \]
            называют <i>моментом порядка $\alpha = i + j + k$</i>. Обозначение:
            $\sum m x^i y^j z^k$.
          </div>

          Введём в рассмотрение шесть величин:
          \[
          \begin{aligned}
          J_{yz} &= \sum m yz,
          & J_{zx} &= \sum m zx,
          & J_{xy} &= \sum m xy, \\
          J_{xx} &= \sum m (y^2 + z^2),
          & J_{yy} &= \sum m (x^2 + z^2),
          & J_{zz} &= \sum m (x^2 + y^2).
          \end{aligned}
          \]

          <div class="definition">
            $J_{yz}, J_{zx}, J_{xy}$ &mdash; <i>центробежные моменты</i>,
            $J_{xx}, J_{yy}, J_{zz}$ &mdash; <i>осевые моменты</i>.
          </div>

          <p>
          Момент инерции материальной точки относительно оси $l$ &mdash;
          величина $mh^2$, где $m$ &mdash; масса точки, $h$ &mdash; расстояние
          до оси $l$.
          </p>

          <p>
          Пусть $\rho(x,y,z)$ &mdash; плотность тела &mdash; непрерывная функция
          координат в области $V$, а $h(x,y,z)$ &mdash; расстояние точки
          $(x,y,z)$ до оси $l$.
          </p>

          <div class="definition">
            Величину
            \[
            \iiint\limits_V \rho(x,y,z) h^2(x,y,z) dx dy dz
            \]
            называют <i>моментом инерции твёрдого тела относительно оси $l$</i>.
            Обозначение: $\sum m h^2$.
          </div>

          <div class="definition">
            Пусть $J_l$ &mdash; момент инерции относительно оси $l$, а $M$
            &mdash; масса твёрдого тела. Тогда величину $\rho_l$ такую, что
            \[
            J_l = M \rho_l^2,
            \]
            называют <i>радиусом инерции твёрдого тела относительно оси $l$</i>.
          </div>

          Средством вычисления $J_l$ является следующая
          <div class="theorem">
            Пусть ось $l$ проходит через точку $O$, а $\alpha, \beta, \gamma$
            &mdash; её направляющие косинусы в системе координат $Oxyz$. Тогда
            \[
            J_l = J_{xx} \alpha^2 + J_{yy} \beta^2 + J_{zz} \gamma^2
            - 2 J_{yz} \beta \gamma - 2 J_{zx} \gamma \alpha
            - 2 J_{xy} \alpha \beta.
            \]
          </div>

          <p>
          Пусть система координат $Oxyz$ фиксирована. Рассмотрим пучок прямых
          $l$, проходящих через точку $O$. Относительно каждой из осей $l$ этого
          пучка данное тело имеет свой момент инерции $J_l$. Наглядную картину
          распределения моментов инерции $J_l$ твёрдого тела (в зависимости от
          выбора оси $l$) даёт <i class="important">эллипсоид инерции</i>.
          </p>

          <p>
          Пусть $\bvec{e} = (\alpha, \beta, \gamma)$ &mdash; единичный вектор,
          направленный вдоль $l$. Взяв на $l$ произвольную точку $M(x,y,z)$ и
          обозначая $OM = R$, получаем
          \[
          x = R \alpha, \quad y = R \beta, \quad z = R \gamma.
          \]
          Тогда из формулы
          \[
          J_l = J_{xx} \alpha^2 + J_{yy} \beta^2 + J_{zz} \gamma^2
          - 2 J_{yz} \beta \gamma - 2 J_{zx} \gamma \alpha
          - 2 J_{xy} \alpha \beta
          \]
          получаем
          \[
          k^2 = J_{xx} x^2 + J_{yy} y^2 + J_{zz} z^2
          - 2 J_{yz} y z - 2 J_{zx} z x - 2 J_{xy} x y,
          \]
          где $k^2 = J_l R^2$. Данная формула задаёт поверхность второго
          порядка. Будем считать, что $k = \const$, поэтому
          \[
          R = \frac{k}{\sqrt{J_l}}.
          \]
          Так как $J_l$ существенно больше нуля, то $R \lt \infty$ и,
          следовательно, задаёт эллипсоид (единственная поверхность 2 порядка,
          не имеющая бесконечно удалённых точек). Этот эллипсоид и называется
          <i class="important">эллипсоидом инерции</i>. Центр эллипсоида
          находится в точке $O$, а $k$ определяет масштаб. Итак, с точностью до
          выбора масштаба $k$ каждой точке $O$ тела соответствует свой эллипсоид
          инерции. Главные оси эллипсоида инерции называют
          <i class="important">главными осями инерции тела для точки $O$</i>.
          Если точка $O$ совпадает с центром масс, то построенный для неё
          эллипсоид инерции называют <i class="important">центральным</i>, а его
          главные оси &mdash; <i class="important">главными центральными осями
            инерции</i>.
          </p>

          <p>
          Положим
          \[
          J_{xy} = J_{yx}, \quad J_{yz} = J_{zy}, \quad J_{zx} = J_{xz}
          \]
          (это следует из определения произведений инерции) и рассмотрим матрицу
          квадратичной формы
          \[
          (J) =
          \begin{pmatrix}
           J_{xx} & -J_{xy} & -J_{xz} \\
          -J_{yx} &  J_{yy} & -J_{yz} \\
          -J_{zx} & -J_{zy} &  J_{zz}
          \end{pmatrix}
          \]
          </p>

          <div class="definition">
            Матрица $(J)$ называется <i>тензором инерции</i>.
          </div>

          Если оси $Oxyz$ направить вдоль главных осей эллипсоида инерции для
          точки $O$, то тензор инерции становится диагональной матрицей, а
          уравнение эллипсоида инерции имеет каноническую форму
          \[
          J_{xx} x^2 + J_{yy} y^2 + J_{zz} z^2 = k^2.
          \]
        </div>
      </li>

      <li class="question">
        <div class="name">
          Движение твёрдого тела около неподвижной точки. Динамические и
          кинематические уравнения Эйлера
        </div>
        <div class="content">
          <p>
          Пусть $\bvec{K}_O$ &mdash; вектор кинетического момента твёрдого тела
          относительно неподвижной точки $O$. Тогда
          \[
          \begin{aligned}
          \bvec{K}_O
          &= \sum \bvec{r}_i \times m_i \bvec{v}_i = \\
          &= \sum \bvec{r}_i \times m_i \paren{
          \bvec{\omega} \times \bvec{r}_i
          } = \\
          &= \bvec{\omega} \sum m_i r_i^2
          - \sum m_i \bvec{r}_i (\dp{\bvec{r}_i}{\bvec{\omega}}),
          \end{aligned}
          \]
          где $\bvec{r}_i, \bvec{v}_i$ &mdash; радиус-вектор относительно точки
          $O$ и скорость произвольной точки тела; $\bvec{\omega}$ &mdash;
          угловая скорость твёрдого тела.
          </p>

          <div class="remark">
            Здесь $\sum$ &mdash; условное обозначение.
          </div>

          <p>
          Пусть $O\xi\eta\zeta$ &mdash; неподвижная система координат, а $Oxyz$
          &mdash; СК, жёстко связанная с твёрдым телом.
          </p>

          <p>
          Пусть $p,q,r$ &mdash; координаты вектора $\bvec{\omega}$ в подвижной
          СК $Oxyz$, а $K_x, K_y, K_z$ &mdash; координаты $\bvec{K}_O$ в той же
          СК $Oxyz$. Тогда, проектируя формулу
          \[
          \bvec{K}_O
          = \bvec{\omega} \sum m_i r_i^2
          - \sum m_i \bvec{r}_i (\dp{\bvec{r}_i}{\bvec{\omega}})
          \]
          на оси $x, y, z$, получим
          \[
          \begin{aligned}
          K_x &= p \sum m_i (y_i^2 + z_i^2)
          - q \sum m_i x_i y_i - r \sum m_i x_i z_i, \\
          K_y &= q \sum m_i (x_i^2 + z_i^2)
          - p \sum m_i y_i x_i - r \sum m_i y_i z_i, \\
          K_z &= r \sum m_i (x_i^2 + y_i^2)
          - p \sum m_i z_i x_i - q \sum m_i z_i y_i,
          \end{aligned}
          \]
          то есть
          \[
          \begin{aligned}
          K_x &=  J_{xx} p - J_{xy} q - J_{xz} r, \\
          K_y &= -J_{yx} p + J_{yy} q - J_{zz} r, \\
          K_z &= -J_{zx} p - J_{zy} q + J_{zz} r,
          \end{aligned}
          \]
          или, иначе,
          \[
          \bvec{K}_O = (J) \bvec{\omega}.
          \]
          </p>

          <p>
          Если за подвижные оси взять главные оси инерции для точки $O$, то
          тензор инерции становится диагональным, и координаты $\bvec{K}_O$:
          \[
          K_x = J_{xx}p, \quad K_y = J_{yy} q, \quad K_z = J_{zz} r.
          \]
          </p>

          <p>
          Выразим кинетическую энергию твёрдого тела как функцию компонент
          вектора $\bvec{\omega}$:
          \[
          \begin{aligned}
          2T
          &= \sum m_i \dp{\bvec{v}_i}{\bvec{v}_i} = \\
          &= \sum m_i \bvec{v}_i \paren{ \bvec{\omega} \times \bvec{r}_i } = \\
          &= \sum \bvec{\omega} \paren{
          \bvec{r}_i \times m_i \bvec{v}_i
          } = \\
          &= \bvec{\omega} \sum \paren{
          \bvec{r}_i \times m_i \bvec{v}_i
          } = \\
          &= \bvec{\omega} \bvec{K}_O.
          \end{aligned}
          \]
          Здесь:
          <ul>
            <li>
              $\bvec{K}_O$ &mdash; вектор кинетического момента твёрдого тела
              относительно неподвижной точки $O$;
            </li>

            <li>
              $\bvec{\omega}$ &mdash; угловая скорость твёрдого тела.
            </li>
          </ul>
          </p>

          <p>
          В подвижной СК
          \[
          \bvec{\omega} = (p,q,r), \quad \bvec{K}_O = (K_x, K_y, K_z),
          \]
          поэтому
          \[
          2T = J_{xx} p^2 + J_{yy} q^2 + J_{zz} r^2
          - 2 J_{yz} qr - 2 J_{zx} rp - 2 J_{xy} qp.
          \]
          </p>

          <p>
          Если за подвижные оси взяты главные оси инерции тела для точки $O$, то
          это уравнение принимает вид
          \[
          2T = J_{xx} p^2 + J_{yy} q^2 + J_{zz} r^2.
          \]
          </p>

          <hr>
          
          <p>
          В неподвижной СК $O\xi\eta\zeta$ запишем теорему об изменении
          кинетического момента:
          \[
          \dv{\bvec{K}_O}{t} = \bvec{M}_O,
          \]
          где $\bvec{M}_O$ &mdash; главный момент всех внешних сил относительно
          неподвижной точки $O$.
          </p>

          <div class="definition">
            <i>Относительная производная</i> &mdash; производная в подвижной
            системе отсчёта.
          </div>

          <p>
          Справедлива формула:
          \[
          \dv{\bvec{P}}{t} = \rdv{\bvec{P}}{t} + \vp{\bvec{\omega}}{\bvec{P}},
          \]
          где $\bvec{P}$ &mdash; произвольный вектор.
          </p>

          <p>
          Используя эту формулу, получаем
          \[
          \dv{\bvec{K}_O}{t} = \rdv{\bvec{K_O}}{t} +
          \vp{\bvec{\omega}}{\bvec{K_O}} = \bvec{M}_O.
          \]
          Спроецируем эту формулу на оси подвижной СК $Oxyz$, направленные по
          главным осям инерции твёрдого тела в точке $O$:
          \[
          \begin{aligned}
          \dv{K_x}{t} + q K_z - r K_y &= M_x, \\
          \dv{K_y}{t} + r K_x - p K_z &= M_y, \\
          \dv{K_z}{t} + p K_y - q K_x &= M_z.
          \end{aligned}
          \]
          Учитывая выражения
          \[
          K_x = J_{xx}p, \quad K_y = J_{yy} q, \quad K_z = J_{zz} r
          \]
          и вводя обозначения
          \[
          J_{xx} = A, \quad J_{yy} = B, \quad J_{zz} = C,
          \]
          получаем уравнения, которые называют <i
            class="important">динамическими уравнениями Эйлера</i>:
          \[
          \begin{aligned}
          A \dot p + (C - B) qr = M_x, \\
          B \dot q + (A - C) pr = M_y, \\
          C \dot r + (B - A) pq = M_z.
          \end{aligned}
          \]
          </p>

          Чтобы полностью описать движение твёрдого тела с неподвижной точкой, к
          динамическим уравнениям Эйлера необходимо добавить <i
            class="important">кинематические уравнения Эйлера</i>, связывающие
          проекции $(p,q,r)$ угловой скорости твёрдого тела $\bvec{\omega}$ в СК
          $Oxyz$ и углы Эйлера:
          \[
          \left\{
          \begin{aligned}
          p &= \dot\psi \sin\theta \sin\varphi + \dot\theta \cos\varphi, \\
          q &= \dot\psi \sin\theta \cos\varphi - \dot\theta \sin\varphi, \\
          r &= \dot\psi \cos\theta + \dot\varphi,
          \end{aligned}
          \right.
          \]
          <div class="images">
            <img src="images/21-1.png" alt="">
          </div>
          где:
          <ul>
            <li>
              $O\xi\eta\zeta$ &mdash; неподвижная СК;
            </li>

            <li>
              $Oxyz$ &mdash; подвижная СК;
            </li>

            <li>
              $ON$ &mdash; линия узлов, образуемая пересечением плоскостей
              $O\xi\eta$ и $Oxy$;
            </li>

            <li>
              $\psi$ &mdash; угол <i class="important">прецессии</i> &mdash;
              угол между $O\xi$ и $ON$;
            </li>

            <li>
              $\theta$ &mdash; угол <i class="important">нутации</i> &mdash;
              угол между $O\zeta$ и $Oz$;
            </li>

            <li>
              $\varphi$ &mdash; угол <i class="important">чистого вращения</i>
              &mdash; угол между $Ox$ и $ON$.
            </li>
          </ul>

          Скорости $\dot\psi, \dot\varphi, \dot\theta$ направлены по осям
          $O\xi, Oz, ON$, соответственно.
        </div>
      </li>

      <li class="question">
        <div class="name">
          Задача вращательного движения тела в однородном поле тяжести.
          Уравнения движения и интегралы. Случаи Эйлера, Лагранжа, Ковалевской
        </div>
        <div class="content">
          Рассмотрим движение твёрдого тела с неподвижной точкой под действием
          только силы тяжести $\bvec{P}$. Введём в рассмотрение две СК с началом
          в точке $O$: неподвижную $O\xi\eta\zeta$, связанную с Землёй, и
          подвижную $Oxyz$, которая совпадает с главными осями инерции тела для
          точки $O$. Ось $O\zeta$ направлена вертикально вверх. Обозначим орт
          этой оси за $\bvec{e}$, а его направляющие косинусы в СК $Oxyz$
          &mdash; за $(\gamma_1, \gamma_2, \gamma_3)$. Так как направление
          $O\zeta$ неподвижно относительно Земли, то
          \[
          \dv{\bvec{e}}{t} = 0,
          \]
          или
          \[
          \tag{1}
          \dv{\bvec{e}}{t}
          = \rdv{\bvec{e}}{t} + \vp{\bvec{\omega}}{\bvec{e}} = 0.
          \]
          Проецируя это уравнение на подвижные оси $Oxyz$, получаем
          <i class="important">уравнения Пуассона</i>:
          \[
          \tag{2}
          \begin{aligned}
          \dot\gamma_1 &= r \gamma_2 - q \gamma_3, \\
          \dot\gamma_2 &= p \gamma_3 - r \gamma_1, \\
          \dot\gamma_3 &= q \gamma_1 - p \gamma_2.
          \end{aligned}
          \]

          Единственная внешняя сила, действующая на ТТ &mdash; сила тяжести:
          \[
          \bvec{P} = -P \bvec{e}.
          \]
          Главный момент этой силы относительно точки $O$ равен
          \[
          \bvec{M}_O(\bvec{P})
          = \vp{\bvec{r}_C}{\bvec{P}}
          = P \vp{\bvec{e}}{\bvec{r}_C}
          = P
          \begin{vmatrix}
          \bvec{i} & \bvec{j} & \bvec{k} \\
          \gamma_1 & \gamma_2 & \gamma_3 \\
          x_C & y_C & z_C
          \end{vmatrix},
          \]
          где $\bvec{r}_C = \paren{ x_C, y_C, z_C }$ &mdash; радиус-вектор центра
          тяжести ТТ относительно $O$ в СК $Oxyz$.

          <p>
            С учётом этого, динамические уравнения Эйлера примут вид
            \[
            \tag{3}
            \begin{aligned}
            A\dot p + (C - B) qr &= P(\gamma_2 z_C - \gamma_3 y_C), \\
            B\dot q + (A - C) rp &= P(\gamma_3 x_C - \gamma_1 z_C), \\
            C\dot r + (B - A) pq &= P(\gamma_1 y_C - \gamma_2 x_C).
            \end{aligned}
            \]
            Из (2) и (3) получаем систему из 6 нелинейных ОДУ 1-го порядка относительно
            6 неизвестных функций времени $\gamma_1, \gamma_2, \gamma_3, p, q, r$.
          </p>

          <p>
            Если $\gamma_1, \gamma_2, \gamma_3, p, q, r$ найдены как функции времени, то
            для полного решения задачи (т.е. для определения эйлеровых углов как функций
            времени) необходимо из любого из кинематических уравнений Эйлера
            \[
            \left\{
            \begin{aligned}
            p &= \dot\psi \sin\theta \sin\varphi + \dot\theta \cos\varphi, \\
            q &= \dot\psi \sin\theta \cos\varphi - \dot\theta \sin\varphi, \\
            r &= \dot\psi \cos\theta + \dot\varphi,
            \end{aligned}
            \right.
            \]
            найти $\psi(t)$ одной квадратурой: например, исключим из первых двух уравнений
            $\dot\theta$, тогда
            \[
            p \sin \varphi + q \cos \varphi = \dot \psi \sin \theta,
            \]
            откуда
            \[
            \dot \psi = \frac{p \sin\varphi + q \cos\varphi}{\sin\theta},
            \]
            а $\theta(t)$ и $\varphi(t)$ определяются непосредственно через
            $\gamma_1(t), \gamma_2(t), \gamma_3(t)$, так как
            \[
            \begin{aligned}
            \gamma_1 &= \sin \theta \sin \varphi, \\
            \gamma_2 &= \sin \theta \cos \varphi, \\
            \gamma_3 &= \cos \theta.
            \end{aligned}
            \]
          </p>

          <p>
            Установлено, что для полного решения системы (2)-(3) достаточно знать
            4 независимых интеграла вместо 6.
          </p>

          <p>
            Можно указать следующие первые интегралы:
          </p>

          <ol>
            <li>
              <i>Геометрический</i>. Так как $\bvec{e} = (\gamma_1, \gamma_2, \gamma_3)$
              в СК $Oxyz$ и $\abs{\bvec{e}} = 1$, то
              \[
              \tag{4}
              \gamma_1^2 + \gamma_2^2 + \gamma_3^2 = 1.
              \]
            </li>

            <li>
              <i>Интеграл площадей</i>. Применим теорему об изменении кинетического
              момента относительно оси $O\xi$:
              \[
              M_{O\xi}(\bvec{P}) = 0,
              \]
              так как
              \[
              O\xi \parallel \bvec{P}
              \implies
              \dv{K_\xi}{t} = M_{O\xi} = 0
              \implies
              K_\xi = \const.
              \]
              Так как
              \[
              K_\xi
              = \dp{\bvec{K}_O}{\bvec{e}}
              = \paren{ A p \bvec{i}, B q \bvec{j}, C r \bvec{k} }
              \cdot
              \paren{ \gamma_1 \bvec{i}, \gamma_2 \bvec{j}, \gamma_3 \bvec{k} }
              = A p \gamma_1 + B q \gamma_2 + C r \gamma_3,
              \]
              то
              \[
              \tag{5}
              A p \gamma_1 + B q \gamma_2 + C r \gamma_3 = \const.
              \]

              <div class="todo">
                Расписать закон сохранения площадей.
              </div>
            </li>

            <li>
              <i>Интеграл энергии</i>. По теореме об изменении кинетической энергии
              \[
              dT = - P d\xi_C,
              \]
              где $\xi_C$ &mdash; координата центра тяжести ТТ в $O\xi\eta\zeta$.

              <p>
                Интегрируя это равенство, получаем, что
                \[
                T = -P \xi_C + \const.
                \]
                Так как
                \[
                2T
                = J_{xx} p^2 + J_{yy} q^2 + J_{zz} r^2
                = A p^2 + B q^2 + C r^2,
                \]
                а
                \[
                \xi_C
                = \dp{\bvec{r}_C}{\bvec{e}}
                = x_C \gamma_1 + y_C \gamma_2 + z_C \gamma_3,
                \]
                то
                \[
                \tag{6}
                \frac{1}{2} \paren{ A p^2 + B q^2 + C r^2 }
                =
                -P \paren{ x_C \gamma_1 + y_C \gamma_2 + z_C \gamma_3 } + \const;
                \]
                это равенство и называют интегралом энергии.
              </p>
            </li>
          </ol>

          <p>
            Остаётся найти ещё один интеграл, независимый от (4)-(6). Сделать это
            удалось только для трёх частных предположений относительно движущегося
            тела и условий его движения:
          </p>
          <ol type="a">
            <li>
              Случай Эйлера: центр тяжести является неподвижной точкой
              \[
              x_C = 0, \; y_C = 0, \; z_C = 0,
              \qquad
              A \neq B \neq C.
              \]
            </li>

            <li>
              Случай Лагранжа: моменты инерции относительно главных осей удовлетворяют условиям
              \[
              A = B \neq C,
              \]
              а центр тяжести находится на оси симметрии эллипсоида инерции:
              \[
              x_C = 0, \quad y_C = 0.
              \]
            </li>

            <li>
              Случай Ковалевской: центр тяжести расположен в экваториальной плоскости эллипсоида
              инерации
              \[
              z_C = 0,
              \]
              а моменты инерции относительно главных осей удовлетворяют условиям
              \[
              A = B = 2C.
              \]
            </li>
          </ol>

          <div class="definition">
            Интеграл
            \[
            \tag{7}
            u = \int\limits_{0}^{x} \frac{dx}{\sqrt{(1-x^2)(1 - k^2 x^2)}}
            \]
            называют <i>эллиптическим интегралом Якоби 1-го рода</i>.
          </div>

          После замены $x = \sin \varphi$ он принимает вид
          \[
          u
          = \int\limits_{0}^{\varphi} \frac{d\varphi}{\sqrt{ 1 - k^2 \sin^2 \varphi }}
          = F(\varphi, k).
          \]

          <div class="definition">
            Интеграл
            \[
            \tag{8}
            u
            = \int\limits_{0}^{\varphi} \frac{d\varphi}{\sqrt{ 1 - k^2 \sin^2 \varphi }}
            = F(\varphi, k)
            \]
            называют <i>эллиптическим интегралом Лежандра 1-го рода</i>.
            <br/>
            Обратную функцию $\varphi(u)$ называют <i>амплитудой</i>:
            \[
            \varphi = \am u = \am F(\varphi, k).
            \]
          </div>

          <div class="definition">
            <i>Эллиптическими функциями</i> назывюатся тригонометрические функции
            от $\am u$:
            \[
            \tag{10}
            \left\{
            \begin{aligned}
            \sin \varphi &= \sin \am u = \sn u, \\
            \cos \varphi &= \cos \am u = \cn u, \\
            \sqrt{ 1 - k^2 \sin^2\varphi }
            &= \Delta \varphi = \Delta \am u = \dn u.
            \end{aligned}
            \right.
            \]

            Функцию $\dn u$ называют <i>дельтой амплитуды</i>.
          </div>

          Нетрудно проверить, что справедливо равенство
          \[
          \tag{11}
          \sn^2 u + \cn^2 u = 1.
          \]

          Если $k = 0$, то $\sn u = \sin u$ и $\cn u = \cos u$, так как в этом случае
          $\varphi = u$. Отсюда следует, что при $k = 0$
          \[
          \sn 0 = 0, \qquad \cn 0 = 1, \qquad \dn 0 = 1.
          \]

          <div class="remark">
            Эллиптические функции являются периодическими с действительным периодом $4l$,
            где
            \[
            l = \int\limits_{0}^{\pi / 2}
            \frac{d\varphi}{\sqrt{ 1 - k^2 \sin^2 \varphi }}.
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Постановка задач оптимального управления: критерии качества и
          ограничения
        </div>
        <div class="content">
          Рассмотрим систему ОДУ
          \[
          \dot x = f(x(t), u(t)),
          \]
          где
          \[
          x \in \R^n, \qquad u \in \R^m, \qquad t \in [t_\text{н}, t_\text{к}].
          \]

          Рассмотрим классификацию критериев качества:
          <ol type="a">
            <li>
              <i>Задача Лагранжа</i>:
              \[
              J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t)) dt.
              \]
            </li>

            <li>
              <i>Задача Майера</i>:
              \[
              J_0 = \varphi_0(t_\text{н}, x(t_\text{н}), t_\text{к}, x(t_\text{к})).
              \]
            </li>

            <li>
              <i>Задача Больца</i>:
              \[
              J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t)) dt.
              + \varphi_0(t_\text{н}, x(t_\text{н}), t_\text{к}, x(t_\text{к})),
              \]
              причём первое слагаемое называют <i>интегральной частью</i>, а второе
              &mdash; <i>терминальной частью</i>.
            </li>
          </ol>

          <p>
            Рассмотрим классификацию ограничений:
          </p>
          <ol>
            <li>
              <i>Ограничения на траекторию</i>
              <ol type="a">
                <li>
                  <i>Задача с фиксированными концами</i>:
                  \[
                  x(t_\text{н}) = x^\text{н},
                  \qquad
                  x(t_\text{к}) = x^\text{к}.
                  \]
                </li>

                <li>
                  <i>Задача со свободным левым/правым концом</i>:
                  \[
                  x(t_\text{н}) = x^\text{н}
                  \quad \text{или} \quad
                  x(t_\text{к}) = x^\text{к}.
                  \]
                </li>

                <li>
                  <i>Задача с подвижными концами</i>:
                  \[
                  x(t_\text{н}) = G(t_\text{н}),
                  \qquad
                  x(t_\text{к}) = G(t_\text{к}).
                  \]
                </li>

                <li>
                  <i>Изопериметрическая задача</i>:
                  \[
                  \left\{
                  \begin{aligned}
                  J_j &= \int\limits_{t_\text{н}}^{t_\text{к}} F_j(t, x(t)) dt
                  \leqslant 0,
                  & j &= \overline{1, m_1} \\
                  J_i &= \int\limits_{t_\text{н}}^{t_\text{к}} F_i(t, x(t)) dt
                  = 0,
                  & i &= \overline{m_1 + 1, m_2}.
                  \end{aligned}
                  \right.
                  \]
                </li>
              </ol>
            </li>

            <li>
              <i>Ограничения на управление</i>:
              <ol type="a">
                <li>
                  <i>Программное управление</i>:
                  \[
                  u = u(t).
                  \]
                </li>

                <li>
                  <i>Синтез-управление</i>:
                  \[
                  u = u(t, x).
                  \]
                </li>

                <li>
                  <i>Специфические ограничения</i>:
                  \[
                  u \in U.
                  \]
                </li>

                <li>
                  <i>Изопериметрические ограничения</i>:
                  \[
                  \left\{
                  \begin{aligned}
                  J_j &= \int\limits_{t_\text{н}}^{t_\text{к}} F_j(t, u(t)) dt
                  \leqslant 0,
                  & j &= \overline{m_2 + 1, m_3} \\
                  J_i &= \int\limits_{t_\text{н}}^{t_\text{к}} F_i(t, u(t)) dt
                  = 0,
                  & i &= \overline{m_3 + 1, m_4}.
                  \end{aligned}
                  \right.
                  \]
                </li>
              </ol>
            </li>
          </ol>

          <div class="problem">
            <i>(оптимального управления)</i>.

            Рассмотрим
            <ol>
              <li>
                систему ОДУ
                $\dot x = f(x(t), u, t)$,
                где
                \[
                x \in \R^n, \qquad u \in \R^m \qquad t \in [t_\text{н}, t_\text{к}],
                \]
                с начальными условиями $x(t_\text{н}) = x^\text{н}$;
              </li>

              <li>
                критерий качества
                \[
                J_0(t_\text{н}, x^\text{н}, t_\text{к}, x^\text{к}) \to \inf,
                \]
              </li>

              <li>
                ограничения:
                \[
                \left\{
                \begin{aligned}
                J_j(t_\text{н}, x^\text{н}, t_\text{к}, x^\text{к}, u) &\leqslant 0,
                & j &= \overline{1, m_1}, \\
                J_i(t_\text{н}, x^\text{н}, t_\text{к}, x^\text{к}, u) &= 0,
                & i &= \overline{m_1 + 1, m_2}, \\
                u &\in U, & & &
                \end{aligned}
                \right.
                \]
                где
                \[
                J_k = \int\limits_{t_\text{н}}^{t_\text{к}} F_k(x(t), u, t) dt
                + \varphi_k(t_\text{н}, x^\text{н}, t_\text{к}, x^\text{к}),
                \]
                причём
                \[
                u(t) \in PC, \qquad x(t) \in PC^1.
                \]
              </li>
            </ol>
          </div>

          <p>
            Рассмотрим совокупность варьируемых параметров
            \[
            q = q(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к}), u).
            \]
          </p>

          <div class="definition">
            Совокупность $q$ варьируемых параметров называется <i>допустимой</i>, если
            она удовлетворяет условиям
            \[
            \begin{aligned}
            \dot x &= f(x(t), u, t), \\
            J_k &= \int\limits_{t_\text{н}}^{t_\text{к}} F_k(x(t), u, t) dt
            + \varphi_k(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к})).
            \end{aligned}
            \]
          </div>

          <div class="definition">
            Допустимую совокупность $\tilde q$ называют <i>оптимальной</i>, если для
            любой другой бесконечно близкой к ней совокупности $q$ выполняется условие
            \[
            J_0(\tilde q) \leqslant J_0(q).
            \]
          </div>

          <div class="definition">
            Допустимую совокупность $\tilde q$ называют <i>локально оптимальной в
              сильном смысле</i>, если существует $\varepsilon \gt 0$ такой, что
            для любой допустимой совокупности $q$ такой, что
            \[
            \abs{\tilde t_\text{н} - t_\text{н}}
            +
            \abs{\tilde t_\text{к} - t_\text{к}}
            + \max_t \abs{\tilde x(\tilde u, t) - x(u, t)} \lt \varepsilon,
            \qquad
            t \in [t_\text{н}, t_\text{к}] \cap [\tilde t_\text{н}, \tilde t_\text{к}],
            \]
            выполняется
            \[
            J_0(\tilde q) \leqslant J_0(q).
            \]
          </div>

          <p>
            В дальнейшем будем искать локально оптимальные сильные экстремумы, то есть
            рассматривать непрерывные функции.
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Постановка вариационных задач управления движением. Сильные и слабые
          вариации условного функционала
        </div>
        <div class="content">
          <p>
            Рассмотрим уравнения движения
            \[
            \dot x = f(x(t), u(t), t),
            \qquad
            x \in \R^n, \quad u \in \R^m,
            \qquad t \in [t_\text{н}, t_\text{к}] \in \R,
            \]
            причём
            \[
            f \in C^1, \qquad \pd{f}{x} \in C^1,
            \]
            с начальными условиями
            \[
            x(t_\text{н}) = x^\text{н}.
            \]
          </p>

          <p>
            Будем считать, что заданы условия на управление:
            \[
            u_{j1} \leqslant u_j(t) \leqslant u_{j2},
            \qquad
            u_{j1}, u_{j2} \in \overline{\R}.
            \]
          </p>

          <div class="definition">
            Если для всех $j$
            \[
            u_{j1} = -\infty, \qquad u_{j2} = \infty,
            \]
            то задача называется <i>задачей классического вариационного исчисления</i>.
          </div>

          <p>
            Будем рассматривать управления $u_j(t) \in PC$ с конечным числом точек
            разрыва $\tau$. Будем считать, что они изолированы, а $u_j(t)$ непрерывны
            справа.
          </p>

          <div class="definition">
            Управления, имеющие конечное число точек разрыва и удовлетворяющие
            ограничениям
            \[
            u_{j1} \leqslant u_j(t) \leqslant u_{j2},
            \qquad
            u_{j1}, u_{j2} \in \overline{\R},
            \]
            будем называть <i>допуститмыми</i>.
          </div>

          <div class="definition">
            Говорят, что пары $(u, x)$ из допустимого управления и отвечающей ему
            траектории, удовлетворяющие уравнениям движения, образуют <i>управляемый
              процесс</i>.
          </div>

          <p>
            Будем считать, что также заданы ограничения на траекторию:
            \[
            J_i(t_\text{н}, t_\text{к}, x_i(t_\text{н}), x_i(t_\text{к})) = 0,
            \qquad i = \overline{1,n},
            \quad j = \overline{1,l},
            \quad l \leqslant 2n + 2,
            \]
            причём считаем, что функции $J_i \in C^1$ и независимы, то есть
            \[
            \rank \paren{
            \pd{J_j}{t_\text{н}},
            \pd{J_j}{t_\text{к}},
            \pd{J_j}{x_i^\text{н}},
            \pd{J_j}{x_i^\text{к}}
            }
            = l.
            \]
          </p>

          <div class="definition">
            Управляемый процесс, удовлетворяющий ограничениям на траекторию, называют
            <i>допустимым управляемым процессом</i>.
          </div>

          <p>
            Зададим критерий качества в виде Больца:
            \[
            J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t), t) dt
            + \varphi_0(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
            \to \min,
            \]
            причём считаем, что $\varphi_0, F_0, \pd{F_0}{x} \in C^1$.
          </p>

          <div class="definition">
            <i>Задача вариационного управления движения</i> заключается в поиске
            допустимого управляемого процесса, удовлетворяющего критерию качества.
          </div>

          <br/>
          <hr/>

          <p>
            Введём понятие игольчатых вариаций. Рассмотрим управление $u(t)$,
            при котором минимизируется функционал. Будем варьировать это управление
            следующим образом. Рассмотрим конечное число моментов времени $t_\sigma$:
            \[
            t_\text{н} \lt t_1 \lt \dots \lt t_n \lt t_\text{к},
            \qquad \sigma = \overline{1,n},
            \]
            в которых управление $u(t)$ меняется соответственно на $v_\sigma(t)$.
            Будем считать, что $v_\sigma(t)$ удовлетворяет ограничением на управление,
            то есть
            \[
            u_{j1} \leqslant v_{j\sigma} \leqslant u_{j2}.
            \]
          </p>

          <p>
            Введём в рассмотрение величины
            \[
            \Delta t_\sigma \gt 0,
            \qquad \Delta t_\text{н},
            \quad \Delta t_\text{к},
            \]
            построим непересекающиеся интервалы
            \[
            \left\{
            \begin{aligned}
            i_\text{н} &=
            \begin{cases}
            [t_\text{н}, t_\text{н} + \Delta t_\text{н}), & \Delta t_\text{н} \gt 0, \\
            (t_\text{н} + \Delta t_\text{н}, t_\text{н}], & \Delta t_\text{н} \lt 0,
            \end{cases} \\
            i_\sigma &= [t_\sigma, t_\sigma + \Delta t_\sigma], \\
            i_\text{к} &=
            \begin{cases}
            [t_\text{к}, t_\text{к} + \Delta t_\text{к}), & \Delta t_\text{к} \gt 0, \\
            (t_\text{к} + \Delta t_\text{к}, t_\text{к}], & \Delta t_\text{к} \lt 0.
            \end{cases} \\
            \end{aligned}
            \right.
            \]
            Заметим, что точки разрыва изолированы.
          </p>

          <p>
            Используя построенные интервалы, рассмотрим новое управление:
            \[
            u'(t) =
            \begin{cases}
            u(t_\text{н}), & t \in i_\text{н}, \\
            u(t_\text{к}), & t \in i_\text{к}, \\
            v_\sigma, & t \in i_\sigma, \\
            u, & t \not \in i_\text{н}, i_\text{к}, i_\sigma.
            \end{cases}
            \]

            Тогда <i class="important">игольчатой вариацией</i> называется функция
            \[
            v(t) = u'(t + \Delta t) - u(t).
            \]
          </p>

          <p>
            Так как
            \[
            u'(t) = u(t), \qquad t \not \in i_\text{н}, i_\text{к}, i_\sigma,
            \]
            то
            \[
            v = u(t + \Delta t) - u(t) = \Delta u.
            \]
          </p>

          <div class="todo">Разобраться до конца, что надо писать, а что нет.</div>

          <div class="images">
            <img src="images/24-3.png" alt="">
            <img src="images/24-4.png" alt="">
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Полная вариация условного функционала: слабое варьирование
        </div>
        <div class="content">
          Рассмотрим
          <ol>
            <li>
              уравнение движения
              \[
              \dot x = f(x(t), u(t), t),
              \]
            </li>

            <li>
              ограничения на траекторию
              \[
              J_j(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) = 0,
              \qquad
              j = \overline{1,l},
              \]
            </li>

            <li>
              критерий качества
              \[
              J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(t, x(t), u(t)) dt
              + \varphi_0(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
              \to \min.
              \]
            </li>
          </ol>

          <p>
            Эту задачу можно рассматривать как задачу условной минимизации функционала
            $J_0$. Перейдём от неё к задаче безусловной минимизации функционала введением
            множителей Лагранжа:
            \[
            \lambda(t) \in \R^n, \qquad \nu \in \R^l.
            \]
            Тогда будем минимизировать функционал
            \[
            \Phi = \int\limits_{t_\text{н}}^{t_\text{к}} \left[
            F_0(t, x(t), u(t)) dt + \lambda (\dot x - f)
            \right] dt
            + \varphi_0(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
            + \sum\limits_{j=1}^{l} \nu_j J_j.
            \]
            Введя обозначения
            \[
            L = F_0 + \lambda (\dot x - f),
            \qquad
            R = \varphi_0 + \sum\limits_{j=1}^{l} \nu_j J_j,
            \]
            перепишем этот функционал в следующем виде:
            \[
            \Phi = \int\limits_{t_\text{н}}^{t_\text{к}}
            L(x(t), \dot x, \lambda, u(t), t) dt
            + R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
            \to \min.
            \]
          </p>

          <p>
            Найдём полную вариацию этого функционала:
            \[
            \Delta \Phi = \delta \Phi + \dot \Phi \Delta t.
            \]
          </p>

          <p>
            Пользуясь определением функционала действия по Гамильтону
            \[
            S = \int\limits_{t_\text{н}}^{t_\text{к}} L dt,
            \]
            можно записать
            \[
            \Delta \Phi
            = \Delta \int\limits_{t_\text{н}}^{t_\text{к}} L dt + \Delta R
            = \Delta_1 S + \Delta_2 S + \Delta_1 R
            = \Delta_1 \Phi + \Delta_2 \Phi,
            \]
            где:
          </p>
          <ul>
            <li>
              $\Delta_1$ отвечает за вариации без разрывов, то есть за слабые
              вариации параметров $x, \dot x, \lambda, u, t$ и за сильные вариации для
              $\dot x$;
            </li>

            <li>
              $\Delta_2$ отвечает за сильные вариации для управления.
            </li>
          </ul>

          <p>
            Рассмотрим для начала вариации без разрывов:
            \[
            \Delta_1 \Phi = \Delta_1 S + \Delta_1 R.
            \]
            Известно, что
            \[
            \Delta_1 S
            = \Delta \int\limits_{t_\text{н}}^{t_\text{к}} L dt
            = \int\limits_{t_\text{н}}^{t_\text{к}} \delta L dt
            + \left .\paren{ L \Delta t } \right|_{t_\text{н}}^{t_\text{к}}.
            \]
            Рассмотрим изохронную вариацию функции $L$:
            \[
            \delta L(x, \dot x, \lambda, u, t) =
            \pd{L}{x} \delta x + \pd{L}{\dot x} \delta \dot x
            + \pd{L}{\lambda} \delta \lambda + \pd{L}{u} \delta u.
            \]
            Так как
            \[
            \dv{}{t} \paren{ \pd{L}{\dot x} \delta x }
            = \dv{}{t} \pd{L}{\dot x} \delta x + \pd{L}{\dot x} \delta \dot x,
            \]
            то
            \[
            \pd{L}{\dot x} \delta \dot x
            = \dv{}{t} \paren{ \pd{L}{\dot x} \delta x }
            - \dv{}{t} \pd{L}{\dot x} \delta x,
            \]
            поэтому
            \[
            \delta L(x, \dot x, \lambda, u, t) =
            \paren{
            \pd{L}{x} - \dv{}{t} \pd{L}{\dot x}
            } \delta x
            + \dv{}{t} \paren{ \pd{L}{\dot x} \delta x }
            + \pd{L}{\lambda} \delta \lambda + \pd{L}{u} \delta u.
            \]
            Введём функцию Гамильтона:
            \[
            H = \lambda \dot x - L(x, \dot x, \lambda, u, t),
            \]
            где $x$ и $\lambda$ будем воспринимать как аналог обобщённых координат
            и импульсов соответственно. Из определения
            \[
            L = F_0 + \lambda (\dot x - f)
            \]
            следует, что
            \[
            H = -F_0 + \lambda f, \implies
            H = H(x, \lambda, u, t).
            \]
            Пользуясь этим обозначением, а также тем, что
            \[
            \pd{L}{\dot x} = \lambda,
            \]
            получаем
            \[
            \delta L
            =
            - \paren{ \pd{H}{x} + \dot \lambda } \delta x
            + \dv{}{t} \paren{ \lambda \delta x }
            + \paren{ \dot x - \pd{H}{\lambda} } \delta \lambda
            - \pd{H}{u} \delta u.
            \]
            Заметим, что
            \[
            \left\{
            \begin{aligned}
            \pd{L}{x} &= - \pd{H}{x}, \\
            \pd{L}{\lambda} &= \dot x - \pd{H}{\lambda}, \\
            \pd{L}{u} &= - \pd{H}{u}.
            \end{aligned}
            \right.
            \]
          </p>

          <p>
            Рассмотрим теперь второе слагаемое:
            \[
            \begin{aligned}
            L \Delta t &= \paren{ \lambda \dot x - H } \Delta t = \\
            &= \lambda \dot x \Delta t - H \Delta t = \\
            &= \lambda \Delta x - \lambda \delta x - H \Delta t.
            \end{aligned}
            \]
          </p>

          <p>
            Собирая полученные результаты, получаем, что
            \[
            \begin{aligned}
            \Delta_1 S
            &= \int\limits_{t_\text{н}}^{t_\text{к}} \delta L dt
            + \left .\paren{ L \Delta t } \right|_{t_\text{н}}^{t_\text{к}} = \\
            &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
            \left[
            \paren{ \pd{H}{x} + \dot \lambda } \delta x
            + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
            + \pd{H}{u} \delta u
            \right] dt
            + \cancel{\left. \paren{ \lambda \delta x } \right|_{t_\text{н}}^{t_\text{к}}}
            + \\
            &\phantom{=} +
            \left.
            \paren{ \lambda \Delta x - \cancel{\lambda \delta x} - H \Delta t }
            \right|_{t_\text{н}}^{t_\text{к}} = \\
            &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
            \left[
            \paren{ \pd{H}{x} + \dot \lambda } \delta x
            + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
            + \pd{H}{u} \delta u
            \right] dt
            + \\
            &\phantom{=} +
            \left.
            \paren{ \lambda \Delta x - H \Delta t }
            \right|_{t_\text{н}}^{t_\text{к}}
            \end{aligned}
            \]
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Полная вариация условного функционала: сильное варьирование. Условия
          Эрдмана-Вейерштрасса
        </div>
        <div class="content">
          Рассмотрим
          <ol>
            <li>
              уравнение движения
              \[
              \dot x = f(x(t), u(t), t),
              \]
            </li>

            <li>
              ограничения на траекторию
              \[
              J_j(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) = 0,
              \qquad
              j = \overline{1,l},
              \]
            </li>

            <li>
              критерий качества
              \[
              J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(t, x(t), u(t)) dt
              + \varphi_0(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
              \to \min.
              \]
            </li>
          </ol>

          <p>
            Эту задачу можно рассматривать как задачу условной минимизации функционала
            $J_0$. Перейдём от неё к задаче безусловной минимизации функционала введением
            множителей Лагранжа:
            \[
            \lambda(t) \in \R^n, \qquad \nu \in \R^l.
            \]
            Тогда будем минимизировать функционал
            \[
            \Phi = \int\limits_{t_\text{н}}^{t_\text{к}} \left[
            F_0(t, x(t), u(t)) dt + \lambda (\dot x - f)
            \right] dt
            + \varphi_0(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
            + \sum\limits_{j=1}^{l} \nu_j J_j.
            \]
            Введя обозначения
            \[
            L = F_0 + \lambda (\dot x - f),
            \qquad
            R = \varphi_0 + \sum\limits_{j=1}^{l} \nu_j J_j,
            \]
            перепишем этот функционал в следующем виде:
            \[
            \Phi = \int\limits_{t_\text{н}}^{t_\text{к}}
            L(x(t), \dot x, \lambda, u(t), t) dt
            + R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
            \to \min.
            \]
          </p>

          <p>
            Найдём полную вариацию этого функционала:
            \[
            \Delta \Phi = \delta \Phi + \dot \Phi \Delta t.
            \]
          </p>

          <p>
            Пользуясь определением функционала действия по Гамильтону
            \[
            S = \int\limits_{t_\text{н}}^{t_\text{к}} L dt,
            \]
            можно записать
            \[
            \Delta \Phi
            = \Delta \int\limits_{t_\text{н}}^{t_\text{к}} L dt + \Delta R
            = \Delta_1 S + \Delta_2 S + \Delta_1 R
            = \Delta_1 \Phi + \Delta_2 \Phi,
            \]
            где:
          </p>
          <ul>
            <li>
              $\Delta_1$ отвечает за вариации без разрывов, то есть за слабые
              вариации параметров $x, \dot x, \lambda, u, t$ и за сильные вариации для
              $\dot x$;
            </li>

            <li>
              $\Delta_2$ отвечает за сильные вариации для управления.
            </li>
          </ul>

          <p>
            Рассмотрим сильные вариации. Обозначим за $u'$ управление, отвечающее
            траектории сравнения, тогда
            \[
            \begin{aligned}
            \Delta_2 \Phi &= \Delta_2 S = \\
            &= \int\limits_{t_\text{н}}^{t_\text{к}} \left[
            L(x, \dot x, \lambda, u', t) - L(x, \dot x, \lambda, u, t)
            \right] dt = \\
            &= \int\limits_{t_\text{н}}^{t_\text{к}} \left[
            H(x, \lambda, u, t) - H(x, \lambda, u', t)
            \right] dt \approx \\
            &\approx \sum\limits_{\sigma = 0}^{N + 1}
            \int\limits_{t_\sigma}^{t_\sigma + \Delta t_\sigma}
            \left[ H(x, \lambda, u, t) - H(x, \lambda, v_\sigma, t) \right] dt,
            \end{aligned}
            \]
            где $N$ &mdash; количество точек разрыва и
            \[
            t_0 := t_\text{н}, \qquad t_{N+1} := t_\text{к}.
            \]
          </p>

          <p>
            Проверим, является ли функция
            \[
            H(x, \lambda, u, t) - H(x, \lambda, v_\sigma, t)
            \]
            непрерывной как функция времени. Для этого рассмотрим произвольный момент
            времени $\tau \in [t_\text{н}, t_\text{к}]$ (который, вообще говоря, может
            совпадать с одной из точек разрыва). Тогда
            \[
            S
            = \int\limits_{t_\text{н}}^{t_\text{к}} L dt
            = \int\limits_{t_\text{н}}^{\tau} L dt
            + \int\limits_{\tau}^{t_\text{к}} L dt.
            \]
            Так как
            \[
            \begin{aligned}
            \Delta_1 S
            &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
            \left[
            \paren{ \pd{H}{x} + \dot \lambda } \delta x
            + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
            + \pd{H}{u} \delta u
            \right] dt
            + \\
            &\phantom{=} +
            \paren{ \lambda \Delta x - H \Delta t }
            \big|_{t_\text{н}}^{t_\text{к}},
            \end{aligned}
            \]
            то, варьируя обе части формулы функционала действия и сравнивая полученные
            результаты, получаем, что
            \[
            \paren{ \lambda \Delta x - H \Delta t } \big|_{\tau - 0}
            -
            \paren{ \lambda \Delta x - H \Delta t } \big|_{\tau + 0}
            = 0.
            \]

            Замечая, что
            \[
            \begin{aligned}
            \at{\Delta x}{\tau - 0} = \at{\Delta x}{\tau + 0} &= \Delta x, \\
            \at{\Delta t}{\tau - 0} = \at{\Delta t}{\tau + 0} &= \Delta t
            \end{aligned}
            \]
            в силу непрерывности, причём $\Delta x$ и $\Delta t$ независимы, окончательно
            получаем, что
            \[
            \begin{aligned}
            \at{\lambda_i}{\tau - 0} &= \at{\lambda_i}{\tau + 0}, \\
            \at{H}{\tau - 0} &= \at{H}{\tau + 0}, & i = \overline{1,n}.
            \end{aligned}
            \]
            Эти равенства называют <i class="important">условиями
              Эрдмана-Вейерштрасса</i>.
          </p>

          <p>
            Итак, если условия Эрдмана-Вейерштрасса выполнены, то функция
            \[
            H(x, \lambda, u, t) - H(x, \lambda, v_\sigma, t)
            \]
            непрерывна как функция времени, поэтому, выделив линейную часть приращения
            функционала $\Phi$, получим, что
            \[
            \begin{aligned}
            \Delta_2 \Phi &= \sum\limits_{\sigma = 0}^{N + 1}
            \int\limits_{t_\sigma}^{t_\sigma + \Delta t_\sigma}
            \left[ H(x, \lambda, u, t) - H(x, \lambda, v_\sigma, t) \right] dt = \\
            &= \sum\limits_{\sigma=0}^{N+1} \left[
            H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma)
            \right] \abs{ \Delta t_\sigma }.
            \end{aligned}
            \]
          </p>

          <p>
            Итак, полная вариация функционала $\Phi$ для конечных и бесконечно малых
            приращений записывается как
            \[
            \begin{aligned}
            \Delta \Phi &= \Delta_1 \Phi + \Delta_2 \Phi = \\
            &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
            \left[
            \paren{ \pd{H}{x} + \dot \lambda } \delta x
            + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
            + \pd{H}{u} \delta u
            \right] dt
            + \\
            &\phantom{=} +
            \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) +
            \left.
            \paren{ \lambda \Delta x - H \Delta t }
            \right|_{t_\text{н}}^{t_\text{к}}
            + \\
            &\phantom{=} +
            \sum\limits_{\sigma=0}^{N+1} \left[
            H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma)
            \right] \abs{ \Delta t_\sigma }.
            \end{aligned}
            \]
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Необходимые условия экстремума для задачи классического вариационного
          исчисления
        </div>
        <div class="content">
          Рассмотрим формулу для полной вариации функционала $\Phi$:
          \[
          \begin{aligned}
          \Delta \Phi
          &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
          \left[
          \paren{ \pd{H}{x} + \dot \lambda } \delta x
          + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
          + \pd{H}{u} \delta u
          \right] dt
          + \\
          &\phantom{=} +
          \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) +
          \left.
          \paren{ \lambda \Delta x - H \Delta t }
          \right|_{t_\text{н}}^{t_\text{к}}
          + \\
          &\phantom{=} +
          \sum\limits_{\sigma=0}^{N+1} \left[
          H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma)
          \right] \abs{ \Delta t_\sigma }.
          \end{aligned}
          \]

          <p>
            Анализ этой формулы позволяет выписать необходимые условия экстремума как для
            непрерывной функции управления без ограничений, так и для ограниченного
            кусочно-непрерывного управления.
          </p>

          <p>
            Рассмотрим случай, когда управление представляет собой непрерывную функцию без
            ограничений. Тогда необходимые условия оптимального управления называют
            <i class="important">необходимыми условиями для классического вариационного
              исчисления</i>.
          </p>

          <p>
            Если на опорной траектории достигается локальный минимум, то $\Delta \Phi \geqslant 0$.
          </p>

          <p>
            Так как основные сложности сопряжены с варьированием управления, то проварьируем
            сначала остальные параметры и выпишем условия, соответствующие этому варьированию.
          </p>

          <p>
            При частном выборе на траекториях сравнения управлений, равных оптимальным
            (т.е. $u' = u$ и $\delta u = 0$), будем иметь <i class="important">внутренний
              экстремум</i> (так как управление не варьируется, ограничения на него не учитываются),
            поэтому необходимое условие экстремума &mdash; общее условие стационарности:
            \[
            \Delta \Phi = 0.
            \]
            Заметим, что в расширенном пространстве допустимых кривых сравнения вариации
            $\delta x_i, \delta \lambda_i, \Delta t_\text{н}, \Delta t_\text{к},
            \Delta x_i^\text{н}, \Delta x_i^\text{к}$ независимы, поэтому получаем следующие
            условия:
          </p>

          <ol>
            <li>
              <i class="important">уравнения движения</i>:
              \[
              \dot x_i = \pd{H}{\lambda_i} = f_i(x, u, t),
              \]
            </li>

            <li>
              <i class="important">уравнения Эйлера-Лагранжа</i>:
              \[
              \dot \lambda_i
              = - \pd{H}{x_i}
              = \pd{F_0}{x_i} - \sum\limits_{j=1}^{n} \lambda_j \pd{f_j(x, u, t)}{x_i},
              \]
            </li>

            <li>
              <i class="important">общее условие трансверсальности</i>:
              \[
              \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
              + \left. \paren{ \lambda \Delta x - H \Delta t } \right|_{t_\text{н}}^{t_\text{к}}
              = 0
              \]

              Учитывая, что
              \[
              \Delta R
              =
              \pd{R}{t_\text{н}} \Delta t_\text{н}
              +
              \pd{R}{t_\text{к}} \Delta t_\text{к}
              +
              \sum\limits_{i=1}^{n} \pd{R}{x_i^\text{н}} \Delta x_i^\text{н}
              +
              \sum\limits_{i=1}^{n} \pd{R}{x_i^\text{к}} \Delta x_i^\text{к},
              \]
              получаем $2n + 2$ <i class="important">развёрнутых условий трансверсальности</i>:
              \[
              \left\{
              \begin{aligned}
              \pd{R}{t_\text{н}} + H_\text{н} &= 0, \\
              \pd{R}{t_\text{к}} - H_\text{к} &= 0, \\
              \pd{R}{x_i^\text{н}} - \lambda_i^\text{н} &= 0, \\
              \pd{R}{x_i^\text{к}} + \lambda_i^\text{к} &= 0.
              \end{aligned}
              \right.
              \]

              Заметим, что условия трансверсальности нужно решать совместно с уравнениями связей:
              \[
              J_j(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) = 0, \qquad i = \overline{1,m}.
              \]
            </li>
          </ol>

          <div class="remark">
            Условия 1-3 справедливы как для случая непрерывного управления, так и для управления
            в ограничениях.
          </div>

          <p>
            Рассмотрим теперь только вариации управления, положив остальные вариации нулю. При
            слабых вариациях управления для выполнения условия $\Delta \Phi \geqslant 0$ получаем
            следующее необходимое условие:
            \[
            - \int\limits_{t_\text{н}}^{t_\text{к}} \pd{H}{u} \delta u dt \geqslant 0.
            \]

            Пусть $u_j \in (u_{j1}, u_{j2})$, то есть управление на опорной траектории является
            внутренним значением. Тогда $\delta u$ может принимать как положительные, так и
            отрицательные значения, поэтому для выполнения $\Delta \Phi \geqslant 0$ должно
            выполняться условие
            \[
            \pd{H}{u_j} = 0, \qquad u_{j1} \lt u_j \lt u_{j2}.
            \]

            Рассмотрим теперь граничные значения управления $u_j$:
          </p>

          <ol>
            <li>
              Если $u_j = u_{j1}$, то
              \[
              \begin{aligned}
              \delta u_j = u_j' - u_j \neq 0
              &\implies u_j' \neq u_j \\
              &\implies u_j' \in (u_{j1}, u_{j2}] \\
              &\implies \delta u_j \gt 0 \\
              &\implies \pd{H}{u_j} \leqslant 0.
              \end{aligned}
              \]
            </li>

            <li>
              Если $u_j = u_{j2}$, то
              \[
              \begin{aligned}
              \delta u_j = u_j' - u_j \neq 0
              &\implies u_j' \neq u_j \\
              &\implies u_j' \in [u_{j1}, u_{j2}) \\
              &\implies \delta u_j \lt 0 \\
              &\implies \pd{H}{u_j} \geqslant 0.
              \end{aligned}
              \]
            </li>
          </ol>

          <p>
            Итак, можно записать <i class="important">необходимые условия оптимальности для
              классического вариационного исчисления</i>:
          </p>

          <ol>
            <li>
              <i class="important">уравнения движения</i>:
              \[
              \dot x_i = \pd{H}{\lambda_i} = f_i(x, u, t),
              \]
            </li>

            <li>
              <i class="important">уравнения Эйлера-Лагранжа</i>:
              \[
              \dot \lambda_i
              = - \pd{H}{x_i}
              = \pd{F_0}{x_i} - \sum\limits_{j=1}^{n} \lambda_j \pd{f_j(x, u, t)}{x_i},
              \]
            </li>

            <li>
              <i class="important">общее условие трансверсальности</i>:
              \[
              \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
              + \left. \paren{ \lambda \Delta x - H \Delta t } \right|_{t_\text{н}}^{t_\text{к}}
              = 0
              \]

              либо $2n + 2$ <i class="important">развёрнутых условий трансверсальности</i>:
              \[
              \left\{
              \begin{aligned}
              \pd{R}{t_\text{н}} + H_\text{н} &= 0, \\
              \pd{R}{t_\text{к}} - H_\text{к} &= 0, \\
              \pd{R}{x_i^\text{н}} - \lambda_i^\text{н} &= 0, \\
              \pd{R}{x_i^\text{к}} + \lambda_i^\text{к} &= 0.
              \end{aligned}
              \right.
              \]
            </li>

            <li>
              ${\displaystyle \pd{H}{u_j} = 0} \quad \text{при} \quad u_{j1} \lt u_j \lt u_{j2}.$
            </li>
          </ol>

          <div class="remark">
            Система из уравнений Эйлера-Лагранжа и уравнений движения представляет собой
            каноническую систему с гамильтонианом
            \[
            H \bydef= -F_0 + \lambda f,
            \]
            координатами $x_i$ и импульсами $\lambda_i$. Она отличается от стандартной канонической
            системы аналитической динамики линейной зависимостью $H$ от $\lambda_i$ и наличием
            дополнительных переменных $u_j$ &mdash; неизвестных функций от времени.
          </div>

          <div class="remark">
            Заметим, что на участках экстремальной траектории, не содержащих угловых точек,
            полная производная гамильтониана в силу системы будет равна частной производной по
            времени; рассмотрим
            \[
            \dv{H(x, \lambda, u, t)}{t}
            = \pd{H}{t}
            + \pd{H}{x} \dot x
            + \pd{H}{\lambda} \dot \lambda
            + \pd{H}{u} \dot u.
            \]

            Так как
            \[
            \left\{
            \begin{aligned}
            \pd{H}{x} \dot x &= \phantom{-} \pd{H}{x} \pd{H}{\lambda}, \\
            \pd{H}{\lambda} \dot \lambda &= - \pd{H}{\lambda} \pd{H}{x}, \\
            \pd{H}{u} &= 0 && \text{при} \quad u_j \in (u_{j1}, u_{j2}), \\
            \dot u_j &= 0 && \text{при} \quad u_j = u_{j1} \quad \text{или} \quad u_j = u_{j2},
            \end{aligned}
            \right.
            \]
            то
            \[
            \dv{H}{t} = \pd{H}{t}.
            \]

            Таким образом, если гамильтониан явно не зависит от времени, то для любого участка
            экстремали с непрерывным управлением будет выполняться условие
            \[
            H = h = \const.
            \]
            Из условий Эрдмана-Вейерштрасса следует, что в угловых точках гамильтониан $H$
            непрерывен, откуда следует, что $h = \const$ является одной и той же для всей
            экстремальной траектории.
          </div>

          <div class="remark">
            Пусть $H$ линейно зависит от управления $u_j$, тогда ${\displaystyle \pd{H}{u_j} }$
            является непрерывной функции времени, откуда следует, что для всех моментов времени,
            в которые управление $u_j$ изменяется, выполняется соотношение
            \[
            \pd{H}{u_j} = 0.
            \]
            Такие моменты времени называются
            <i class="important">точками переключения управления $u_j$</i>.
          </div>

          <div class="remark">
            При решении конкретной задачи можно не вводить в рассмотрение множители $\nu_j$, а
            развёрнутые условия трансверсальности получать с помощью приравнивания скобок
            при независимых вариациях в общем уравнении
            \[
            \Delta \varphi_0
            + \paren{ \lambda \Delta x - H \Delta t }
            \big|_{t_\text{н}}^{t_\text{к}} = 0.
            \]

            <div class="todo">
              Насколько я понимаю, это связано с тем, что $J_j = 0$ &mdash; уточнить.
            </div>
          </div>

          <div class="todo">
            Добавить пример (конспект Яна, стр. 56).
          </div>

          <div class="remark">
            Варьирование условного функционала производилось при наличии ограничений
            \[
            J_j(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) = 0.
            \]

            <ol>
              <li>
                Если даны изопериметрические ограничения вида
                \[
                J_j \leqslant 0, \qquad j = \overline{1, m_1},
                \]
                то на множители Лагранжа $\nu_j$ накладываются дополнительные
                <i class="important">условия дополняющей нежёсткости</i>:
                \[
                \nu_j J_j = 0, \qquad j = \overline{1, m_1}
                \]
                и <i class="important">условия неположительности</i>:
                \[
                \nu_j \leqslant 0, \qquad j = \overline{1, m_1}.
                \]
              </li>

              <li>
                Если даны изопериметрические ограничения вида
                \[
                J_j \geqslant 0, \qquad j = \overline{1, m_1},
                \]
                то условие дополнительной нежёсткости сохраняется:
                \[
                \nu_j J_j = 0, \qquad j = \overline{1, m_1},
                \]
                а условие неположительности меняется на <i class="important">условие
                  неотрицательности</i>:
                \[
                \nu_j \geqslant 0, \qquad j = \overline{1, m_1}.
                \]
              </li>
            </ol>

            Смысл этих условий заключается в том, что
            <ul>
              <li>
                $\nu_j \lt 0$, если ограничение $J_j$ активно, то есть $J_j = 0$;
              </li>

              <li>
                $\nu_j = 0$, если ограничение $J_j$ неактивно, то есть $J_j \lt 0$.
              </li>
            </ul>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Принцип максимума Понтрягина: формулировки, замечания
        </div>
        <div class="content">
          Рассмотрим формулу для полной вариации функционала $\Phi$:
          \[
          \begin{aligned}
          \Delta \Phi
          &= -\int\limits_{t_\text{н}}^{t_\text{к}} 
          \left[
          \paren{ \pd{H}{x} + \dot \lambda } \delta x
          + \paren{ \pd{H}{\lambda} - \dot x } \delta \lambda
          + \pd{H}{u} \delta u
          \right] dt
          + \\
          &\phantom{=} +
          \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к}) +
          \left.
          \paren{ \lambda \Delta x - H \Delta t }
          \right|_{t_\text{н}}^{t_\text{к}}
          + \\
          &\phantom{=} +
          \sum\limits_{\sigma=0}^{N+1} \left[
          H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma)
          \right] \abs{ \Delta t_\sigma }.
          \end{aligned}
          \]

          <p>
            Рассмотрим только сильные вариации управления, тогда
            \[
            \Delta \Phi
            =
            \sum\limits_{\sigma=0}^{N+1} \left[
            H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma)
            \right] \abs{ \Delta t_\sigma }.
            \]
            Тогда для выполнения условия $\Delta \Phi \geqslant 0$ необходимо, чтобы
            \[
            H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma) \geqslant 0,
            \qquad v_\sigma \in U.
            \]
            Считаем, что $x = x(t_\sigma), \lambda = \lambda(t_\sigma), u = u(t_\sigma)$ &mdash;
            значения указанных величин на оптимальной траектории.
          </p>

          <div class="definition">
            Условие
            \[
            H(x, \lambda, u, t_\sigma) - H(x, \lambda, v_\sigma, t_\sigma) \geqslant 0,
            \qquad v_\sigma \in U
            \]
            вместе с уравнениями Эйлера-Лагранжа
            \[
            \dot \lambda_i
            = - \pd{H}{x_i}
            = \pd{F_0}{x_i}
            - \sum\limits_{j=1}^{n} \lambda_j \pd{f_j(x, t, u)}{x_i}
            \]
            называются <i>принципом максимума Понтрягина</i>, так как при выборе ограниченного
            множества $U$ в виде
            \[
            u_{j1} \leqslant u_j \leqslant u_{j2}
            \]
            это условие равносильно тому, что
            \[
            H(x, \lambda, u, t)
            = \max_{u_{j1} \leqslant u'_j \leqslant u_{j2}} H(x, \lambda, u', t).
            \]
          </div>

          <p>
            Итак, <i class="important">необходимые условия оптимальности управления, имеющего
              разрывы и ограничения вида $u_{j1} \leqslant u_j(t) \leqslant u_{j2}$</i>:
          </p>

          <ol>
            <li>
              <i class="important">уравнения движения</i>:
              \[
              \dot x_i = \pd{H}{\lambda_i} = f_i(x, u, t),
              \]
            </li>

            <li>
              <i class="important">уравнения Эйлера-Лагранжа</i>:
              \[
              \dot \lambda_i
              = - \pd{H}{x_i}
              = \pd{F_0}{x_i} - \sum\limits_{j=1}^{n} \lambda_j \pd{f_j(x, u, t)}{x_i},
              \]
            </li>

            <li>
              <i class="important">общее условие трансверсальности</i>:
              \[
              \Delta R(t_\text{н}, t_\text{к}, x^\text{н}, x^\text{к})
              + \left. \paren{ \lambda \Delta x - H \Delta t } \right|_{t_\text{н}}^{t_\text{к}}
              = 0
              \]

              либо $2n + 2$ <i class="important">развёрнутых условий трансверсальности</i>:
              \[
              \left\{
              \begin{aligned}
              \pd{R}{t_\text{н}} + H_\text{н} &= 0, \\
              \pd{R}{t_\text{к}} - H_\text{к} &= 0, \\
              \pd{R}{x_i^\text{н}} - \lambda_i^\text{н} &= 0, \\
              \pd{R}{x_i^\text{к}} + \lambda_i^\text{к} &= 0.
              \end{aligned}
              \right.
              \]
            </li>

            <li>
              ${
              \displaystyle H(x, \lambda, u, t)
              = \max_{u_{j1} \leqslant u'_j \leqslant u_{j2}}
              H(x, \lambda, u', t)
              }$.
            </li>
          </ol>

          <h4 class="subtitle">Формулировка принципа максимума</h4>

          Рассмотрим уравнения движения
          \[
          \dot x(t) = f(x(t), u(t), t),
          \qquad x \in \R^n, \quad u \in \R^m,
          \quad t \in [t_\text{н}, t_\text{к}]
          \]
          с начальными условиями $x(t_\text{н}) = x^\text{н}$.

          <p>
            В качестве критерия качества рассмотрим задачу Больца со свободным правым концом
            \[
            J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t), t) dt
            + \varphi_0(x(t_\text{к})) \to \inf.
            \]
          </p>

          <p>
            Управление $u(t) \in U$ будем искать в классе кусочно-непрерывных функций, то есть
            $u(t) \in PC$.
          </p>

          <div class="theorem">
            <i>(принцип максимума Понтрягина)</i>.
            <p>
              Если $u_0(t)$ &mdash; оптимальное управление для поставленной задачи, а $x_0(t)$
              &mdash; соответствующая ему оптимальная траектория, то $u_0$ удовлетворяет условиям
              максимальности:
              \[
              \max_{u \in U} H(t, x_0(t), \lambda(t), u(t))
              =
              H(t, x_0(t), \lambda(t), u_0(t)),
              \]
              где
              \[
              H(t, x(t), \lambda(t), u(t)) = -F_0(x(t), u(t), t) + \lambda(t) f(x(t), u(t), t),
              \]
              а множители $\lambda(t) \in C, \lambda(t) \neq 0$ является решением уравнений
              Эйлера-Лагранжа
              \[
              \dot \lambda = - \pd{H}{x}
              \]
              и удовлетворяют условиям трансверсальности:
              \[
              \lambda(t_\text{к}) = - \pd{\varphi_0(x_0(t_\text{к}))}{x_\text{к}}.
              \]
            </p>
          </div>

          <div class="remark">
            В общем случае ПМП является необходимым условием оптимальности, однако он является
            достаточным для некоторых классов задач (например, для линейно выпуклых &mdash;
            где $f$ линейна по $x$, а $J_0$ &mdash; выпуклый)
          </div>

          <div class="remark">
            <i>(алгоритм использования ПМП)</i>.
            <ol>
              <li>
                Найдём $u_0(t)$ из условия максимальности:
                \[
                \max_{u \in U} H(t, x_0(t), \lambda(t), u(t))
                =
                H(t, x_0(t), \lambda(t), u_0(t)).
                \]
              </li>

              <li>
                Подставив найденное управление $u_0(t)$ в уравнения движения, найдём траекторию
                $x_0(t)$.
              </li>

              <li>
                Подставив найденное управление $u_0(t)$ в уравнения Эйлера-Лагранжа и условия
                трансверсальности, найдём $\lambda(t)$.
              </li>

              <li>
                Используя найденные $x_0(t)$ и $\lambda(t)$, можно выразить управление как функцию
                времени:
                \[
                u_0 = u_0(x_0(t), \lambda(t), t) = u_0(t).
                \]
              </li>
            </ol>
          </div>

          <p>
            Рассмотрим задачу Лагранжа с закреплённым правым концом и свободным временем.
            Зададим уравнения движения
            \[
            \dot x(t) = f(x(t), u(t), t),
            \qquad x \in \R^n, \quad u \in \R^m, \quad t \geqslant t_\text{н}
            \]
            с начальными и конечными условиями
            \[
            x(t_\text{н}) = x^\text{н},
            \qquad
            x(t_\text{к}) = x^\text{к}.
            \]
            Зададим критерий качества в виде задачи Лагранжа
            \[
            J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t), t) dt \to \inf.
            \]
            Будем считать, что $t_\text{к}$ &mdash; произволен, а $u \in U(t)$.
          </p>

          <p>
            ПМП для этой задачи формулируется так: если $u_0(t)$ &mdash; оптимальное управление,
            а $x_0(t)$ &mdash; соответствующая оптимальная траектория, то найдётся ненулевой вектор
            $\lambda(t) \in R^{n + 1}$ такой, что $\lambda(t) \in C$, а также
            \[
            \lambda_0(t) = \const \leqslant 0,
            \qquad
            \dot \lambda_i(t) = - \pd{H}{x_i}, \quad i = \overline{1, n},
            \]
            где
            \[
            H(t, x, u, \lambda) = \sum\limits_{i=1}^{n} \lambda_i f_i + \lambda_0 F_0,
            \]
            для которого выполняется условие максимальности:
            \[
            \max_{u \in U} H(t, x_0(t), \lambda(t), u(t)) = H(t, x_0(t), \lambda(t), u_0(t)),
            \]
            причём
            \[
            H(t, x_0(t), \lambda(t), u_0(t))
            = \int\limits_{t_\text{н}}^{t} \pd{H}{s}(s, x_0(s), \lambda(s), u_0(s)) ds.
            \]
          </p>

          <div class="remark">
            Если задача стационарная, то есть
            \[
            f = f(x, u), \qquad F_0 = F_0(x, u), \qquad U(t) = U,
            \]
            то из существования оптимального управления $u_0$ и соответствующей ему траектории
            $x_0$ следует, что существует $\lambda(t) \in R^{n+1}$, удовлетворяющий тем же
            условиям, что и в формулировке ПМП, а также имеет место тождество
            \[
            H(t, x_0(t), \lambda(t), u_0(t)) \equiv 0.
            \]
          </div>

          <div class="remark">
            Для стационарной задачи быстродействия $H = \lambda(t) f(t)$, найдётся
            \[
            \lambda(t) \in \R^n, \qquad \lambda \in C, \qquad \lambda \neq 0,
            \]
            для которого
            \[
            \max_{u \in U} H(x_0, \lambda, u) = H(x_0, \lambda, u_0) = \const \geqslant 0.
            \]
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Оптимальное по быстродействию управление в задаче Лагранжа
        </div>
        <div class="content">
          Рассмотрим поворот твёрдого тела. Введём две СК:
          <ul>
            <li>
              $Oxyz$ &mdash; жёстко связанную с телом, причём оси выбираем по главным осям
              инерции ТТ для точки $O$; тогда
              \[
              A = I_x, \qquad B = I_y, \qquad C = I_z,
              \]
              а проекции угловой скорости представимы в виде
              \[
              \vec{\omega}(p, q, r) = (\omega_x, \omega_y, \omega_z).
              \]
            </li>

            <li>
              $O\xi\eta\zeta$ &mdash; неподвижная СК.
            </li>
          </ul>

          Рассмотрим динамические уравнения Эйлера:
          \[
          \left\{
          \begin{aligned}
          A \dot p + (C - B) qr &= M_x + u_x, \\
          B \dot q + (A - C) pr &= M_y + u_y, \\
          C \dot r + (B - A) qp &= M_z + u_z,
          \end{aligned}
          \right.
          \]
          где $u_x, u_y, u_z$ &mdash; проекции моментов управления.

          <p>
            Рассмотрим три случая, при которых можно найти аналитическое решение:
          </p>
          <ul>
            <li>
              Эйлер: $A, B, C$ &mdash; 2 из 3 равны
            </li>

            <li>
              Лагранж: $A, B, C$ &mdash; 2 из 3 равны
            </li>

            <li>
              Ковалевская
            </li>
          </ul>

          <p>
            Пусть $A = C \neq B$, рассмотрим спутник на орбите:
            \[
            \left\{
            \begin{aligned}
            A \dot p + (A - B) qr &= u_x, \\
            B \dot q &= u_y, \\
            A \dot r + (B - A) qp &= u_z,
            \end{aligned}
            \right.
            \implies
            \left\{
            \begin{aligned}
            A \dot p &= u_x + (B - A) qr, \\
            B \dot q &= u_y, \\
            A \dot r &= u_z + (A - B) qp,
            \end{aligned}
            \right.
            \]
          </p>

          <p>
            Пусть $B \gt A$. Введём обозначения:
            \[
            u_1 := \frac{u_x}{A}, \qquad u_2 := \frac{u_z}{A}, \qquad u_3 = \frac{u_y}{B},
            \qquad a := \frac{q (B - A)}{A},
            \]
            тогда систему можно переписать в виде
            \[
            \left\{
            \begin{aligned}
            \dot p &= \phantom{-}ar + u_1, \\
            \dot r &= - ap + u_2, \\
            \dot q &= u_3.
            \end{aligned}
            \right.
            \]

            Представим, что
            \[
            -\nu \leqslant u_1, u_2 \leqslant \nu, \qquad u_3 \equiv 0,
            \]
            тогда
            \[
            \dot q = 0
            \implies q = \const = q_0 \gt 0
            \implies a_0 = \const \gt 0
            \]

            Введя обозначения
            \[
            x_1 := p, \qquad x_2 := r,
            \]
            приведём систему к виду $\dot x = f(x, u(t))$:
            \[
            \left\{
            \begin{aligned}
            \dot x_1 &= \phantom{-} a x_2 + u_1, \\
            \dot x_2 &= - a x_1 + u_2.
            \end{aligned}
            \right.
            \]

            Поставим задачу: перевести систему из начального положения
            \[
            x_1(t_\text{н}) = x_1^\text{н},
            \qquad
            x_2(t_\text{н}) = x_2^\text{н}
            \]
            в положение
            \[
            x_1(t_\text{к}) = 0,
            \qquad
            x_2(t_\text{к}) = 0
            \]
            за минимальное время. Значит, в качестве критерия качества надо взять функционал
            \[
            J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} dt.
            \]
            Так как на управление наложены ограничения, воспользуемся принципом максимума
            Понтрягина.
          </p>

          <ol>
            <li>
              Введём функцию Гамильтона:
              \[
              H = -F_0 + \lambda f = -1 + \lambda_1 (a x_2 + u_1) + \lambda_2 (u_2 - a x_1).
              \]
            </li>

            <li>
              Составим уравнения Эйлера-Лагранжа:
              \[
              \left\{
              \begin{aligned}
              \dot \lambda_1 &= -\pd{H}{x_1} = \phantom{-} a \lambda_2, \\
              \dot \lambda_2 &= -\pd{H}{x_2} = - a \lambda_1,
              \end{aligned}
              \right.

              \implies

              \ddot \lambda_1 = a \dot \lambda_2 = - a^2 \lambda_1,
              \]

              Итак, получили уравнение математического маятника:
              \[
              \ddot \lambda_1 + a^2 \lambda_1 = 0.
              \]

              Решения этого уравнения находятся в виде
              \[
              \left\{
              \begin{aligned}
              \lambda_1 &= N \sin(a t + \alpha), \\
              \lambda_2 &= N \cos(a t + \alpha),
              \end{aligned}
              \right.
              \]
              где $a$ &mdash; круговая частота. Эти решения можно также записать в виде
              \[
              \left\{
              \begin{aligned}
              \lambda_1 &= N \sin(a t + \alpha), \\
              \lambda_2 &= N \sin\paren{a t + \alpha + \frac{\pi}{2}},
              \end{aligned}
              \right.
              \]
            </li>

            <li>
              Рассмотрим, возможен ли вырожденный случай, то есть одновременное выполнение
              условий
              \[
              \pd{H}{u_1} = 0, \qquad \pd{H}{u_2} = 0.
              \]
              Пользуясь определением гамильтониана, получаем, что этот случай равносилен тому, что
              \[
              \lambda_1 = 0, \qquad \lambda_2 = 0,
              \]
              что невозможно.

              <p>
                Найдём точки переключения управлений:
                \[
                \left\{
                \begin{aligned}
                \pd{H}{u_1} = \lambda_1 &= 0,
                & \text{&mdash;} \quad \text{точки переключения} \; u_1, \\
                \pd{H}{u_2} = \lambda_2 &= 0,
                & \text{&mdash;} \quad \text{точки переключения} \; u_2.
                \end{aligned}
                \right.
                \]
              </p>
            </li>

            <li>
              Рассмотрим теперь условие максимальности:
              \[
              \max_{\nu \leqslant u \leqslant \nu} H
              =
              \max_{\nu \leqslant u \leqslant \nu} \paren{ \lambda_1 u_1 + \lambda_2 u_2 }.
              \]
              Из него следует, что
              \[
              \left\{
              \begin{aligned}
              u_1 &= \nu \sign \lambda_1(t), \\
              u_2 &= \nu \sign \lambda_2(t).
              \end{aligned}
              \right.
              \]
            </li>
          </ol>

          <div class="images">
            <img src="images/29-u-1.png"/>
            <img src="images/29-u-2.png"/>
          </div>

          <p>
            Из уравнений движения
            \[
            \left\{
            \begin{aligned}
            \dot x_1 &= \phantom{-} a x_2 + u_1, \\
            \dot x_2 &= - a x_1 + u_2
            \end{aligned}
            \right.
            \]
            при
            \[
            u_1 = \pm \nu, \qquad u_2 = \pm \nu
            \]
            следует, что
            \[
            \left\{
            \begin{aligned}
            x_1 &= M \sin \paren{ a t + \beta } + \frac{u_2}{a}, \\
            x_2 &= M \cos \paren{ a t + \beta } - \frac{u_1}{a}.
            \end{aligned}
            \right.
            \]
            Исключением времени можно получить уравнение для фазовой траектории:
            \[
            M^2 = \paren{ x_1 - \frac{u_2}{a} }^2 + \paren{ x_2 + \frac{u_1}{2} }^2.
            \]
            Заметим, что это уравнение задаёт окружность с центром в точке
            \[
            \paren{ \frac{u_2}{a}, -\frac{u_1}{a} },
            \]
            причём при различных значениях управления получаются различные центры.
          </p>

          <div class="todo">
            Дописать
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Метод динамического программирования: вывод уравнения Беллмана,
          замечания о методе динамического программирования
        </div>
        <div class="content">
          Метод динамического программирования является методом синтеза оптимального управления.
          Он основан на <i class="important">принципе динамического программирования</i>,
          сформулированным Беллманом.

          <div class="definition">
            <i>Принцип динамического программирования</i>:
            <p>
              оптимальное управление обладает тем свойством, что для любого начального состояния
              и использованного начального управления последующее оптимальное управление
              совпадает с исходным оптимальным управлением относительно состояния, получающегося
              в результате применения начального управления.
            </p>
          </div>

          <p>
            Другими словами, пусть построена экстремальная траектория, решающая задачу
            оптимизации по некоторому критерию для управляемого процесса $u(t), x(t)$,
            переводящего механическую систему из заданного начального состояния $x_\text{н}$
            в момент времени $t = t_\text{н}$ в некоторое конечное положение $x_\text{к}$
            при $t = t_\text{к}$. Если взять в качестве новой начальной точки любую точку
            $x(\tau)$ этой траектории, причём $t_\text{н} \lt \tau \lt t_\text{к}$, то
            оптимальным управлением в случае $F_0(x, u, t) \geqslant 0$ будет оставшаяся часть
            ранее построенного оптимального управления, отвечающая отрезку
            $t \in [\tau, t_\text{к}]$. Оба вектора управления (первоначального и укороченного)
            на этом отрезке совпадают.
          </p>

          <div class="definition">
            Говорят, что второй вектор управления является <i>сужением</i> первого на отрезке
            $t \in [\tau, t_\text{к}]$.
          </div>

          <p>
            Рассмотрим задачу управления на конечном интервале времени:
          </p>
          <ol>
            <li>
              уравнения движения:
              \[
              \tag{1}
              \dot x(t) = f(t, x(t), u), \qquad t_\text{н} \leqslant t \leqslant t_\text{к}
              \]
              с начальными условиями $x(t_\text{н}) = x_\text{н}$;
            </li>

            <li>
              критерий качества:
              \[
              \tag{2}
              J(u)
              = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(t, x(t), u) dt
              + \varphi_0(x(t_\text{к}))
              \limto{u \in U} \inf,
              \]
            </li>

            <li>
              ограничение на управление: $u \in U$.
            </li>
          </ol>

          <p>
            Пусть движение системы происходит на отрезке
            \[
            t_\text{н} \leqslant \tau \leqslant t \leqslant t_\text{к}
            \]
            с начальными условиями
            \[
            x(\tau) = x, \qquad x \in \R^n,
            \]
            то есть
            \[
            \tag{3}
            \dot x(t) = f(t, x(t), u),
            \qquad \tau \leqslant t \leqslant t_\text{к},
            \qquad x(\tau) = x.
            \]
            Для этой системы рассмотрим задачу минимизации функционала
            \[
            \tag{4}
            \int\limits_{\tau}^{t_\text{к}} F_0(t, x(t), u) dt
            + \varphi_0(x(t_\text{к}))
            \limto{u \in U} \inf.
            \]
          </p>

          <div class="definition">
            <i>Допустимым управлением</i> называется любая измеримая функция $u \in U$ такая,
            что для всех моментов времени $\tau \in [t_\text{н}, t_\text{к}]$ и $x \in \R^n$
            существует решение суженной задачи (3).
          </div>

          <div class="definition">
            <i>Функцией Беллмана</i> $B(\tau, x)$ называют функцию, равную $\inf$ функционала (4)
            на траекториях системы (3) по всем допустимым управлениям:
            \[
            \tag{5}
            B(\tau, x)
            = \inf_{u \in U} \left[
            \int\limits_{\tau}^{t_\text{к}} F_0(t, x(t), u) dt
            + \varphi_0(x(t_\text{к}))
            \right].
            \]
          </div>

          <p>
            Рассмотрим произвольные моменты времени $\tau$ и $\tau_1$:
            \[
            t_\text{н} \leqslant \tau \leqslant \tau_1 \leqslant t_\text{к}.
            \]
            На основании принципа динамического программирования запишем, что
            \[
            \tag{6}
            \begin{aligned}
            B(\tau, x)
            &= \inf_{u \in U} \left[
            \int\limits_{\tau}^{t_\text{к}} F_0(t, x(t), u) dt
            + \varphi_0(x(t_\text{к}))
            \right] = \\
            &= \inf_{u \in U} \left[
            \int\limits_{\tau}^{\tau_1} F_0(t, x(t), u) dt
            +
            \int\limits_{\tau_1}^{t_\text{к}} F_0(t, x(t), u) dt + \varphi_0(x(t_\text{к}))
            \right] = \\
            &= \inf_{\substack{u \in U \\ \tau \leqslant t \leqslant \tau_1}} \left[
            \int\limits_{\tau}^{\tau_1} F_0(t, x(t), u) dt
            +
            \inf_{\substack{u \in U \\ \tau_1 \leqslant t \leqslant t_\text{к}}} \left[
            \int\limits_{\tau_1}^{t_\text{к}} F_0(t, x(t), u) dt + \varphi_0(x(t_\text{к}))
            \right]
            \right] = \\
            &= \inf_{\substack{u \in U \\ \tau \leqslant t \leqslant \tau_1}} \left[
            \int\limits_{\tau}^{\tau_1} F_0(t, x(t), u) dt
            +
            B(\tau_1, x(\tau_1))
            \right].
            \end{aligned}
            \]

            Здесь $x(t)$ &mdash; решение задачи (3), а управление при $t \in [\tau, \tau_1]$ влияет
            на
            \[
            \int\limits_{\tau}^{\tau_1} F_0(t, x(t), u) dt
            \]
            и на величину $x(\tau_1)$.
          </p>

          <p>
            Представим формулу (6) в виде
            \[
            \tag{7}
            \inf_{\substack{u \in U \\ \tau \leqslant t \leqslant \tau_1}} \left[
            \int\limits_{\tau}^{\tau_1} F_0(t, x(t), u) dt
            + B(\tau_1, x(\tau_1))
            - B(\tau, x)
            \right]
            = 0.
            \]
            Пусть $B(\tau, x)$ непрерывно дифференцируема, тогда при
            $\Delta t = \tau_1 - \tau \to 0$ с точностью до малых более высокого порядка малости
            относительно $\Delta t$ выполняется равенство
            \[
            \tag{8}
            B(\tau_1, x(\tau_1)) - B(\tau, x) = \dot B(\tau, x) \Delta t,
            \]
            где $\dot B(\tau, x)$ &mdash; полная производная функции $B$ вдоль траекторий системы
            (1):
            \[
            \tag{9}
            \dv{B(\tau, x)}{t} = \pd{B(\tau, x)}{t} + \pd{B(\tau, x)}{x} f(t, x, u).
            \]
            Разделив обе части (7) на $\Delta t$ и переходя к пределу при $\Delta t \to 0$,
            получаем
            \[
            \inf_{u \in U} \left[
            \pd{B(t, x)}{t} + \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right] = 0,
            \quad \text{где}
            \quad t_\text{н} \leqslant t \leqslant t_\text{к},
            \quad x \in \R^n.
            \]
          </p>

          <div class="definition">
            Уравнение
            \[
            \tag{10}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{t} + \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right] = 0,
            \quad \text{где}
            \quad t_\text{н} \leqslant t \leqslant t_\text{к},
            \quad x \in \R^n
            \]
            называют <i>уравнением Беллмана</i>.
          </div>

          <p>
            Заметим, что из определения функции Беллмана следует, что
            \[
            \tag{11}
            B(t_\text{к}, x) = \varphi(x(t_\text{к})), \qquad x \in \R^n.
            \]
            Таким образом, если решение задачи (1),(2) оптимального управления существует, а
            функция Беллмана $B(t, x)$ непрерывно дифференцируема, то справедливы соотношения
            \[
            \begin{gathered}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{t} + \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right] = 0, \\
            B(t_\text{к}, x) = \varphi(x(t_\text{к})).
            \end{gathered}
            \]
            Таким образом, решение задачи оптимального управления для системы ОДУ сводится к
            решению одного уравнения в частных производных с граничными условиями
            (аналогично методу Якоби для решения канонических уравнений).
          </p>

          <div class="remark">
            Существуют случаи, когда решение ДУЧП не приводит к решению исходной задачи:
            <ol type="a">
              <li>
                В заданном классе допустимых управлений не всегда существует такое управление,
                при котором достигается $\inf$ в определении функции Беллмана.
              </li>

              <li>
                $B(t,x)$ не всегда обладает гладкостью, поэтому решение уравнения Беллмана не
                обязательно совпадает с соответствующей функцией Беллмана.
              </li>

              <li>
                Если функция Беллмана удовлетворяет уравнению Беллмана, то отсюда не следует,
                что управление, при котором достигается $\inf$ в уравнении Беллмана, является
                оптимальным.

                <p>
                  Например, при этом уравнении вообще может не существовать решение
                  уравнений движения (1).
                </p>
              </li>

              <li>
                Решение задачи (10), (11) может быть не единственным, поэтому потребуется
                дополнительное исследование для установления того, какое же из решений является
                функцией Беллмана для исходной задачи оптимального управления.
              </li>
            </ol>
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Построение управления с помощью метода динамического программирования
        </div>
        <div class="content">
          <p>
            Рассмотрим задачу управления на конечном интервале времени:
          </p>
          <ol>
            <li>
              уравнения движения:
              \[
              \tag{1}
              \dot x(t) = f(t, x(t), u), \qquad t_\text{н} \leqslant t \leqslant t_\text{к}
              \]
              с начальными условиями $x(t_\text{н}) = x_\text{н}$;
            </li>

            <li>
              критерий качества:
              \[
              \tag{2}
              J(u)
              = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(t, x(t), u) dt
              + \varphi_0(x(t_\text{к}))
              \limto{u \in U} \inf,
              \]
            </li>

            <li>
              ограничение на управление: $u \in U$.
            </li>
          </ol>

          <p>
            Управление, реализующее
            \[
            \begin{gather}
            \tag{10}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{t} + \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right] = 0, \\
            \tag{11}
            B(t_\text{к}, x) = \varphi(x(t_\text{к})),
            \end{gather}
            \]
            является С-управлением (т.е. $u = u(t, x)$). Приведём условия, при которых МДП
            приводит к решению исходной задачи (1), (2).
          </p>

          <div class="theorem">
            Пусть существует единственное непрерывно дифференцируемое решение задачи (10)-(11)
            $B_0$ и существует допустимое управление $u_0(t, x)$ такое, что
            \[
            \tag{12}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right]
            =
            \pd{B_0(t,x)}{x} f(t, x, u_0) + F_0(t, x, u_0).
            \]
            Тогда С-управление $u_0(t,x)$ является оптимальным, а соответствующая функция Беллмана
            есть $B_0(t,x)$.
          </div>

          <div class="algorithm">
            <i>(построение С-управления с помощью МДП)</i>:
            <ol>
              <li>
                Находим управление $u = u(t, x, B)$, доставляющее минимум левой части
                уравнения (10).
              </li>

              <li>
                Подставляем это управление в (10), получаем нелинейное уравнение в частных
                производных относительно функции $B(t,x)$. Краевое условие имеет вид (11).
              </li>

              <li>
                Решая поставленную задачу, получаем $B(t,x)$.
              </li>

              <li>
                Подставляя найденное значение $B(t,x)$ в выражение $u(t, x, B)$,
                находим оптимальное С-управление $u(t,x) = u(t, x, B(t, x))$.
              </li>
            </ol>
          </div>

          <div class="remark">
            На основании теоремы можно утверждать, что если решение $B(t,x)$ уравнения Беллмана
            единственно, а найденное управление $u(t,x)$ допустимо, то $u(t,x)$ &mdash;
            оптимальное С-управление, а $B(t,x)$ &mdash; функция Беллмана.
          </div>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Связь метода динамического программирования с принципум максимума
          Понтрягина
        </div>
        <div class="content">
          <p>
            Рассмотрим задачу управления на конечном интервале времени:
          </p>
          <ol>
            <li>
              уравнения движения:
              \[
              \tag{1}
              \dot x(t) = f(t, x(t), u), \qquad t_\text{н} \leqslant t \leqslant t_\text{к}
              \]
              с начальными условиями $x(t_\text{н}) = x_\text{н}$;
            </li>

            <li>
              критерий качества:
              \[
              \tag{2}
              J(u)
              = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(t, x(t), u) dt
              + \varphi_0(x(t_\text{к}))
              \limto{u \in U} \inf,
              \]
            </li>

            <li>
              ограничение на управление: $u \in U$.
            </li>
          </ol>

          <p>
            С помощью МДП мы свели эту задачу к решению задачи Коши
            \[
            \begin{gather}
            \tag{10}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{t} + \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right] = 0, \\
            \tag{11}
            B(t_\text{к}, x) = \varphi(x(t_\text{к})).
            \end{gather}
            \]
            Пусть существует единственное непрерывное решение $B(t,x)$ этой задачи с непрерывными
            производными
            \[
            \pd{B}{t}, \quad \pd{B}{x}, \quad \ppdv{B}{t}{x}, \quad \ppdv{B}{x}{t}
            \]
            и допустимое управление $u_0(t,x)$, удовлетворяющее уравнению
            \[
            \tag{12}
            \inf_{u \in U} \left[
            \pd{B(t, x)}{x} f(t, x, u) + F_0(t, x, u)
            \right]
            =
            \pd{B_0(t,x)}{x} f(t, x, u_0) + F_0(t, x, u_0).
            \]
            Тогда $u_0$ является оптимальным. Пусть $x_0(t)$ &mdash; соответствующая оптимальная
            траектория.
          </p>

          <p>
            Введём обозначения:
            \[
            \tag{13}
            \begin{aligned}
            \lambda(t) &= -\pd{B}{x}(t, x(t)), \\
            H(t, x, u, \lambda) &= -F_0(t, x, u) + \lambda f(t, x, u).
            \end{aligned}
            \]
            Тогда из (12) следует, что
            \[
            \pd{B(t, x_0)}{x} f(t, x_0, u_0) + F_0(t, x_0, u_0)
            =
            \min_{u \in U} \left[
            \pd{B(t, x_0)}{x} f(t, x_0, u) + F_0(t, x_0, u)
            \right].
            \]
            Отсюда и из (13) следует, что
            \[
            \tag{14}
            \begin{aligned}
            \max_{u \in U} \left[
            - \pd{B(t, x_0)}{x} f(t, x_0, u) - F_0(t, x_0, u)
            \right]
            &=
            \max_{u \in U} \left[
            \lambda f(t, x_0, u) - F_0(t, x_0, u)
            \right] = \\
            &= \max_{u \in U} H(t, x_0, u, \lambda) = \\
            &= H(t, x_0, u_0, \lambda).
            \end{aligned}
            \]

            На основании (10) и (12) имеем:
            \[
            \pd{B(t,x)}{t} = -\pd{B(t, x)}{x} f(t, x, u_0) - F_0(t, x, u_0) = H(t, x, u_0, \lambda).
            \]
            Так как частные производные
            \[
            \ppdv{B}{t}{x} = \ppdv{B}{x}{t}
            \]
            существуют и непрерывны, то при $x = x_0$ в силу (13) получаем
            \[
            \tag{15}
            \ppdv{B}{t}{x} = - \dot \lambda(t) = \pd{H}{x}(t, x_0, u_0, \lambda).
            \]
            Дифференцируя обе части (11) по $x$ и полагая $x = x_0$, получаем, что
            \[
            \tag{16}
            \pd{B}{x}(t_\text{к}, x_0(t_\text{к}))
            = -\lambda(t_\text{к})
            = \pd{\varphi_0(x_0(t_\text{к}))}{x}.
            \]
          </p>

          <p>
            Из (15) и (16) следует, что $\lambda(t)$ &mdash; решение задачи Коши
            \[
            \tag{17}
            \begin{aligned}
            \dot \lambda(t) &= - \pd{H(t, x_0, u_0, \lambda)}{x}, \\
            \lambda(t_\text{к}) &= - \pd{\varphi_0(x_0(t_\text{к}))}{x}.
            \end{aligned}
            \]
          </p>

          <p>
            Условия (14) и (17) совпадают с условиями ПМП.
          </p>

          <p>
            Таким образом, МДП позволяет свести задачу оптимального управления к исследованию
            задачи Коши (10)-(11) для нелинейного уравнения в частных производных. С помощью же
            ПМП решение задач управления сводится к изучению краевых задач для систем ОДУ,
            что представляется более простым.
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Оптимальное по быстродействию управление вращательным движением в
          случае Эйлера
        </div>
        <div class="content">
          <p>
            Рассмотрим задачу о наискорейшем успокоении ТТ, совершающего вращательные движения
            относительно центра масс $O$ (случай Эйлера). Тогда точка $O$ &mdash; центр подвижной
            системы координат $Ox_1 x_2 x_3$, жёстко связанной с телом. Оси этой системы являются
            главными центральными осями инерции тела. Обозначим проекции вектора кинетического
            момента на эти оси как $x_1, x_2, x_3$, то есть
            \[
            K = \paren{ x_1, x_2, x_3 } = \paren{ Ap, Bq, Cr },
            \]
            где $\omega = \paren{ p, q, r }$ &mdash; координаты угловой скорости ТТ $\vec{\omega}$
            в системе $O x_1 x_2 x_3$, а $A,B,C$ &mdash; главные центральные моменты инерции ТТ.
          </p>

          <p>
            Динамические уравнения Эйлера в этом случае для однородного поля тяжести
            (то есть вращение тела происходит под действием одной только силы тяжести $\vec{P}$)
            имеют вид
            \[
            \left\{
            \begin{aligned}
            A \dot p + (C - B) qr &= 0, \\
            B \dot q + (A - C) pr &= 0, \\
            C \dot r + (B - A) qp &= 0.
            \end{aligned}
            \right.
            \]
          </p>

          <p>
            Введём управление $u = (u_1, u_2, u_3)$. Примем обозначения
            \[
            \eta_1 = \frac{B - C}{CB},
            \qquad
            \eta_2 = \frac{C - A}{AC},
            \qquad
            \eta_3 = \frac{A - B}{AB}.
            \]
            Учитывая, что
            \[
            \dot x_1 = A \dot p,
            \qquad
            \dot x_2 = B \dot q,
            \qquad
            \dot x_3 = C \dot r,
            \]
            перепишем динамические уравнения Эйлера в следующем виде:
            \[
            \tag{18}
            \begin{aligned}
            \dot x_1 &= \eta_1 x_2 x_3 + u_1, \\
            \dot x_2 &= \eta_2 x_1 x_3 + u_2, \\
            \dot x_3 &= \eta_3 x_1 x_2 + u_3.
            \end{aligned}
            \]
            Здесь $u_1, u_2, u_3$ &mdash; проекции управляющего момента $\bvec{u}$ на
            соответствующие оси $O x_1 x_2 x_3$. На управление принято ограничение
            \[
            \tag{19}
            \abs{u} = \sqrt{u_1^2 + u_2^2 + u_3^2} \leqslant b.
            \]
            В начальный момент времени $t_0 = 0$ задано начальное значение $x(0) = x_0$.
          </p>

          <p>
            Требуется перейти в начало координат за кратчайшее время $T$.
          </p>

          <p>
            Для решения поставленной задачи воспользуемся МДП. Согласно определению, функция
            Беллмана в рассматриваемой задаче имеет смысл минимума времени успокоения, то есть
            $B \gt 0$. Так как уравнения движения (18) и ограничения на управления (19)
            не зависят явно от времени, то время успокоения $T$ зависит только от $x(0)$ и
            не зависит от момента начала движения, следовательно, и $B$ тоже зависит только от
            $x(0)$, то есть
            \[
            B = B(x), \implies \pd{B}{t} = 0.
            \]
            Так как подынтегральная функция $F_0 = 1$, то уравнение Беллмана запишется в виде
            \[
            \begin{gather}
            \tag{20}
            \inf_{u: \; \abs{u} \leqslant b} \left[
            \pd{B}{x_1} \eta_1 x_2 x_3
            + \pd{B}{x_2} \eta_2 x_1 x_3
            + \pd{B}{x_3} \eta_3 x_1 x_2
            + \pd{B}{x_1} u_1
            + \pd{B}{x_2} u_2
            + \pd{B}{x_3} u_3
            \right]
            = -1, \\
            \tag{21}
            B(x(T)) = 0, \quad \text{т.к.} \quad \varphi_0 \equiv 0.
            \end{gather}
            \]
            Согласно алгоритму использования МДП, найдём значение $u(t, x, B)$, доставляющее минимум
            левой части (20). Так как первые три слагаемых не зависят от $u$, необходимо
            найти $u$, при котором достигается $\inf$ выражения
            \[
            \tag{22}
            \pd{B}{x_1} u_1
            + \pd{B}{x_2} u_2
            + \pd{B}{x_3} u_3
            = \dp{\vec{\nabla} B}{\vec{u}},
            \qquad \abs{u} \leqslant b.
            \]
            При заданном $\vec{\nabla} B$ выражение достигает минимума, если $\abs{u} = b$, а сам
            вектор $u$ направлен противоположно градиенту, то есть
            \[
            \tag{23}
            \vec{u} = - b \frac{\vec{\nabla} B}{\abs{\vec{\nabla} B}}.
            \]
            Подставим это выражение в уравнение Беллмана, учитывая, что
            \[
            \begin{gathered}
            \abs{\vec{\nabla} B} = \sqrt{
            \paren{ \pd{B}{x_1} }^2
            +
            \paren{ \pd{B}{x_2} }^2
            +
            \paren{ \pd{B}{x_3} }^2
            }, \\
            \dp{\vec{\nabla} B}{\vec{u}}
            = - \abs{\vec{\nabla} B} \abs{u}
            = - b \frac{\abs{\vec{\nabla} B}^2}{\abs{\vec{\nabla} B}};
            \end{gathered}
            \]
            получаем, что
            \[
            \tag{24}
            \pd{B}{x_1} \eta_1 x_2 x_3 + \pd{B}{x_2} \eta_2 x_1 x_3 + \pd{B}{x_3} \eta_3 x_1 x_2
            - b \abs{\vec{\nabla} B} = -1.
            \]
          </p>

          <p>
            Заметим, что $\eta_1 + \eta_2 + \eta_3 = 0$. Функцию $B(x)$ будем искать при выполнении
            условия
            \[
            \pd{B}{x_i} = \psi(x) x_i,
            \]
            где $\psi(x)$ &mdash; некоторая непрерывная функция фазовых переменных. Тогда
            \[
            \abs{\vec{\nabla} B} = \abs{\psi(x)} \sqrt{ x_1^2 + x_2^2 + x_3^2 },
            \]
            а уравнение (24) принимает вид
            \[
            \psi(x) x_1 x_2 x_3 \underbrace{\paren{ \eta_1 + \eta_2 + \eta_3 }}_{0}
            - b \abs{\psi(x)} \sqrt{ x_1^2 + x_2^2 + x_3^2 } = -1,
            \]
            откуда следует, что
            \[
            b \abs{\psi(x)} \sqrt{ x_1^2 + x_2^2 + x_3^2 } = 1,
            \]
            или, иначе,
            \[
            \abs{\psi(x)} = \frac{1}{b \sqrt{ x_1^2 + x_2^2 + x_3^2 }}.
            \]
            Учитывая, что $B \gt 0$, получаем, что
            \[
            \pd{B}{x_i} = \frac{x_i}{b \sqrt{ x_1^2 + x_2^2 + x_3^2 }},
            \]
            откуда следует, что
            \[
            B = \frac{\sqrt{ x_1^2 + x_2^2 + x_3^2 }}{b}.
            \]
            Полученная функция обращается в 0 в конечной точке $x(T) = 0$, следовательно, $B(x)$
            удовлетворяет граничному условию
            \[
            B(x(T)) = 0.
            \]
          </p>

          <p>
            Определим управление:
            \[
            \begin{aligned}
            \vec{u}
            &= - b \frac{\vec{\nabla} B}{\abs{\vec{\nabla} B}} = \\
            &= - \frac{bx}{\sqrt{ x_1^2 + x_2^2 + x_3^2 }} = \\
            &= - \frac{bx}{\abs{x}}.
            \end{aligned}
            \]
            Минимальное время торможения равно
            \[
            \min(T - t_0) = \min T = B(x(0))
            = \frac{\sqrt{ x_1^2(0) + x_2^2(0) + x_3^2(0) }}{b}.
            \]
          </p>

          <p>
            Таким образом, оптимальное гашение угловой скорости тела осуществляется управляющим
            моментом, направленным в обратную сторону кинетического момента, а не угловой скорости.
          </p>
        </div>
      </li>

      <li class="question">
        <div class="name">
          Определение: динамические уравнения Эйлера
        </div>
        <div class="content">
          Рассмотрим движение ТТ относительно неподвижной точки $O$. Введём две СК:
          неподвижную $O\xi\eta\zeta$ и жёстко связанную с ТТ $Oxyz$, причём оси $Ox, Oy, Oz$
          направлены вдоль главных осей инерции для точки $O$.

          <div class="definition">
            Уравнения
            \[
            \begin{aligned}
            A \dot p + (C - B) qr = M_x, \\
            B \dot q + (A - C) pr = M_y, \\
            C \dot r + (B - A) pq = M_z,
            \end{aligned}
            \]
            где
            \[
            A = J_{xx}, \quad B = J_{yy}, \quad C = J_{zz},
            \]
            а $\omega = \paren{p, q, r}$ &mdash; угловая скорость ТТ с координатами в $Oxyz$,
            называют <i class="important">динамическими уравнениями Эйлера</i>.
          </div>
        </div>
      </li>

      <h4 class="subtitle">Разные вопросы</h4>

      <li class="question">
        <div class="name">
          Определение: кинематические уравнения Эйлера
        </div>
        <div class="content">
          Чтобы полностью описать движение твёрдого тела с неподвижной точкой, к
          динамическим уравнениям Эйлера необходимо добавить <i
            class="important">кинематические уравнения Эйлера</i>, связывающие
          проекции $(p,q,r)$ угловой скорости твёрдого тела $\bvec{\omega}$ в СК
          $Oxyz$ и углы Эйлера:
          \[
          \left\{
          \begin{aligned}
          p &= \dot\psi \sin\theta \sin\varphi + \dot\theta \cos\varphi, \\
          q &= \dot\psi \sin\theta \cos\varphi - \dot\theta \sin\varphi, \\
          r &= \dot\psi \cos\theta + \dot\varphi,
          \end{aligned}
          \right.
          \]
          <div class="images">
            <img src="images/21-1.png" alt="">
          </div>
          где:
          <ul>
            <li>
              $O\xi\eta\zeta$ &mdash; неподвижная СК;
            </li>

            <li>
              $Oxyz$ &mdash; подвижная СК;
            </li>

            <li>
              $ON$ &mdash; линия узлов, образуемая пересечением плоскостей
              $O\xi\eta$ и $Oxy$;
            </li>

            <li>
              $\psi$ &mdash; угол <i class="important">прецессии</i> &mdash;
              угол между $O\xi$ и $ON$;
            </li>

            <li>
              $\theta$ &mdash; угол <i class="important">нутации</i> &mdash;
              угол между $O\zeta$ и $Oz$;
            </li>

            <li>
              $\varphi$ &mdash; угол <i class="important">чистого вращения</i>
              &mdash; угол между $Ox$ и $ON$.
            </li>
          </ul>

          Скорости $\dot\psi, \dot\varphi, \dot\theta$ направлены по осям
          $O\xi, Oz, ON$, соответственно.
        </div>
      </li>
    </ol>
  </body>
</html>
