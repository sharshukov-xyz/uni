<!DOCTYPE html>
<html>

  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Оптимальное управление &mdash; 07 &mdash; Конспект</title>

    <link href="/assets/css/styles.css" rel="stylesheet">
    <script defer src="/assets/js/core.js"></script>
    <script defer src="/assets/js/questions.js"></script>
    <script defer src="/assets/js/controls.js"></script>

    <link rel="stylesheet" href="/assets/katex/katex.min.css">
    <script defer src="/assets/katex/katex.min.js"></script>
    <script defer src="/assets/katex/auto-render.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false },
            { left: '\\(', right: '\\)', display: false },
            { left: '\\[', right: '\\]', display: true }
          ],
          // • rendering keys, e.g.:
          throwOnError: false
        });
      });
    </script>
  </head>

  <body>
    <h1 id="title">Оптимальное управление &mdash; 07 &mdash; Конспект</h1>
    <nav>
      <a href="/">Домой</a>
      <a href="..">Оптимальное управление</a>
      <a href="/links">Ссылки</a>
      <a href="/about">Контакты</a>
    </nav>

    <div style="display:none">
      $\global\def\at#1#2{\left. #1 \right\rvert_{#2}}$
      $\global\def\abs#1{\left\lvert #1 \right\rvert}$
      $\global\def\norm#1{\left\lVert #1 \right\rVert}$
      $\global\def\bvec#1{\mathbf{#1}}$
      $\global\def\floor#1{\left\lfloor #1 \right\rfloor}$

      $\global\def\limto#1{\underset{#1}{\longrightarrow}}$
      $\global\def\prob#1{\mathbb{P} \left\{ #1 \right\}}$
      $\global\def\mean#1{\mathbb{E} \left[ #1 \right]}$
      $\global\def\disp#1{D \left[ #1 \right]}$

      $\global\def\dp#1#2{#1 \cdot #2\,}$
      $\global\def\vp#1#2{#1 \times #2\,}$

      $\global\def\dv#1#2{\frac{d #1}{d #2}}$
      $\global\def\rdv#1#2{\frac{d' #1}{d #2}}$ <!-- относительная производная -->
      $\global\def\pd#1#2{\frac{\partial #1}{\partial #2}}$
      $\global\def\pdv2#1#2{\frac{\partial^2 #1}{\partial #2^2}}$
      $\global\def\pdvk#1#2#3{\frac{\partial^#1 #2}{\partial #3^#1}}$
      $\global\def\ppdv#1#2#3{\frac{\partial^2 #1}{\partial #2 \partial #3}}$

      $\global\def\pois#1{\left\{ #1 \right\}}$
      $\global\def\paren#1{\left( #1 \right)}$
      $\global\def\bydef#1{\overset{\mathrm{def}}{#1}}$

      $\global\def\mbox#1{\text{#1}}$

      $\global\def\div{\text{div}\,}$
      $\global\def\dsum{\displaystyle\sum\,}$
      $\global\def\grad{\text{grad}\,}$
      $\global\def\rot{\text{rot}\,}$

      $\global\def\vb#1{\textbf{#1}}$

      $\global\def\op#1{\mathrm{#1}\,}$

      $\global\def\Im{\text{Im}\,}$
      $\global\def\Res{\text{Res}\,}$
      $\global\def\Re{\text{Re}\,}$
      $\global\def\argtg{\text{argtg}\,}$
      $\global\def\ch{\text{ch}\,}$
      $\global\def\const{\text{const}\,}$
      $\global\def\degree{\text{degree}\,}$
      $\global\def\proj{\mathrm{proj}}$
      $\global\def\rank{\mathrm{rank}}$
      $\global\def\res{\text{res}\,}$
      $\global\def\sh{\text{sh}\,}$
      $\global\def\sign{\text{sign}\,}$
      $\global\def\tg{\mathrm{tg}\,}$
    </div>

   <h2>2023-09-14</h2>
   <h3>Глава 1. Введение в ПМ</h3>
   <h4>Постановка задачи</h4>

   <ol>
     <li>
       уравнение движения:
       \[
       \dot x(t) = f(x(t), u(t), t),
       \]
       где $x \in \mathbb{R}^n, u \in \mathbb{R}^m, t \in \mathbb{R}$;
     </li>

     <li>
       критерий качества:
       <ol type="a">
         <li>
           Лагранжа:
           \[
           J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t), t) dt,
           \qquad F_0 \in \mathbb{R}
           \]
         </li>

         <li>
           Майера:
           \[
           J_0 = \varphi_0(x(t_\text{к})), \qquad \varphi_0 \in \mathbb{R}
           \]
         </li>

         <li>
           Больца
           \[
           J_0 = \int\limits_{t_\text{н}}^{t_\text{к}} F_0(x(t), u(t), t) dt
           + \varphi_0(x(t_\text{к}))
           \]
         </li>
       </ol>
     </li>

     <li>
       (опц.) ограничения

       <ol type="a">
         <li>
           траектория
           <ul>
             <li>
               изопериметрическая
               \[
               J_i = \int\limits_{t_\text{н}}^{t_\text{к}} F_i(x(t)) dt \leqslant 0
               \]
               или $\geqslant, =$.
             </li>

             <li>
               с фиксированным концом
               \[
               x(t_\text{н}) = x_\text{н},
               \qquad
               x(t_\text{к}) = x_\text{к}.
               \]
             </li>

             <li>
               со свободным концом
               \[
               x(t_\text{н}) = x_\text{н}
               \quad \text{или} \quad
               x(t_\text{к}) = x_\text{к}.
               \]
             </li>

             <li>
               с плавающими концами
               \[
               x(t_\text{н}) \in G(t_\text{н}),
               \qquad
               x(t_\text{к}) \in G(t_\text{к}).
               \]
             </li>
           </ul>
         </li>

         <li>
           управление

           <ul>
             <li>
               программное управление
               \[
               u = u(t)
               \]

               <div class="remark">
                 ПМП можно применять только для этого типа управления.
               </div>
             </li>

             <li>
               $u \in U(t)$ &mdash; область может меняться со временем
             </li>

             <li>
               изопериметрическое ограничение:
               \[
               J_j = \int\limits_{t_\text{н}}^{t_\text{к}} F_j(u(t), t) dt = 0,
               \]
               либо $\geqslant, \leqslant$.
             </li>
           </ul>
         </li>
       </ol>
     </li>
   </ol>

   <div class="problem">
     <i>(оптимального управления)</i>.

     <ul>
       <li>
         Задача:
         \[
         \dot x(t) = f(x(t), u(t), t),
         \]
       </li>

       <li>
         Критерий качества:
         \[
         J_0(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к}), u(t), t) \to \inf,
         \]
       </li>

       <li>
         Ограничения:
         \[
         \begin{aligned}
         J_i(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к}), u(t), t) &= 0, & i = \overline{1, m_1}, \\
         J_j(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к}), u(t), t) &\leqslant 0, & j = \overline{m_1 + 1, m_2},
         \end{aligned}
         \]
         на управление:
         \[
         u(t) \in U.
         \]
       </li>
     </ul>

     <div class="remark">
       Формально можно все функционалы представить в виде Больца:
       \[
       J_k = \int\limits_{t_\text{н}}^{t_\text{к}} F_k(x(t), u, t) dt
       + \varphi_k(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к})),
       \quad k = \overline{0, m_2},
       \]
       где
       \[
       \begin{gathered}
       F_k \in \mathbb{R}, \quad \varphi_k \in \mathbb{R}, \\
       u(t) \in PC, \quad x(t) \in PCC,
       \end{gathered}
       \]
       причём $PC$ &mdash; кусочно-непрерывные функции, $PCC$
       &mdash; кусочно-непрерывно дифференцируемые функции.
     </div>
   </div>

   Рассмотрим совокупность варьируемых параметров:
   \[
   q = q(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к}), u(t)).
   \]

   <div class="definition">
     Совокупность $q$ варьируемых параметров
     называется <i>допустимой</i>, если она удовлетворяет
     условиям
     \[
     \begin{aligned}
     \dot x(t) &= f(x(t), u(t), t), \\
     J_k &= \int\limits_{t_\text{н}}^{t_\text{к}} F_k(x(t), u, t) dt
     + \varphi_k(t_\text{н}, t_\text{к}, x(t_\text{н}), x(t_\text{к})).
     \end{aligned}
     \]
   </div>

   <div class="definition">
     Совокупность $\tilde q$ варьируемых параметров
     называется <i>оптимальной</i>, если для любой допустимой
     совокупности $q$, близкой к $\tilde q$, выполняется
     соотношение
     \[
     J_0(\tilde q) \leqslant J_0(q).
     \]
   </div>

   <h2>2023-09-21</h2>
   <div class="todo">переписать конспект</div>
   <div class="remark">
     Условия трансверсальности не работают, если значение траектории зафиксировано.
   </div>

   <h2>2023-09-28</h2>

   <div class="todo">
     Посмотреть задачи в группе в тимсе.
   </div>

   <div class="remark">
     В случае, если фиксирован конец траектории, а время не задано,
     немного переформулируется принцип максимума (появляется
     дополнительное значение функции Гамильтона).
   </div>

   <h3>Глава 2. Оптимальное управление механическими системами</h3>

   <h4>Оптимальное по расходу топлива гашение плоских колебаний спутника</h4>

   <ol>
     <li>
       <b>Постановка задачи.</b>
       <br/>
       Введём системы координат: условно неподвижная $C xyz$ и
       связанная со спутником $C x_0 y_0 z_0$.
       <div class="todo">рисунок 1</div>
       Движение $C xyz$ относительно $C x_0 y_0 z_0$ определяется
       углами Эйлера. Колебания плоские, поэтому $Cy = Cy_0$. Значит,
       в плоскости орбиты есть угол отклонения $\theta$.

       <p>
         Уравнение, описывающее вращение тела относительно неподвижной оси:
         \[
         I_y \ddot \theta = \sum\limits_{i=1}^{N} M_y(F_i^{(e)}) = M_y.
         \]
         где $F_i^{(e)}$ &mdash; внешние силы (индекс сверху означает
         это), $I_y$ &mdash; момент инерции спутника относительно оси
         $y$, $M_y$ &mdash; момент внешней силы относительно оси $y$.
       </p>

       <p>
         Выразим проекцию $M_y$ момента внешних сил на $y$:
         \[
         M_y = -3 \omega_0^2 (I_x - I_z) \sin\theta \cos\theta,
         \]
         где $\omega_0$ &mdash; скорость орбитального движения:
         \[
         \omega_0 = \kappa r_c^{-3/2} = \const,
         \]
         где $\kappa = G m$, где $m$ &mdash; масса планеты, $G$ &mdash;
         гравитационная постоянная.
       </p>

       <p>
         Будем предполагать, что $I_x \gt I_z$ (то есть спутник
         вытянут относительно оси $z$), отсюда
         \[
         I_y \ddot \theta + 3 \omega_0^2 (I_x - I_z) \sin\theta \cos\theta = 0,
         \]
         причём $(I_x - I_z) \gt 0$.
       </p>

       <p>
         Предполагаем также, что $\omega_0 \gt 0$. Заметим, момент инерции
         &mdash; величина положительная, поэтому введём обозначение
         \[
         \omega^2 := 3 \omega_0^2 (I_x - I_z) I_y^{-1} \gt 0.
         \]
         Тогда
         \[
         \ddot \theta + \omega^2 \sin\theta \cos\theta = 0.
         \]
         Пусть $\varphi = 2 \theta$, тогда
         \[
         \ddot \varphi + \omega^2 \sin\varphi = 0.
         \]
         Отклонения малые, поэтому $\sin\varphi \sim \varphi$, и
         получаем уравнение математического маятника:
         \[
         \ddot \varphi + \omega^2 \varphi = 0.
         \]
       </p>

       <p>
         Предполагаем, что топливо расходуется настолько мало, что
         моменты инерции можно считать постоянными, то есть $\omega^2 = \const$.
       </p>

       <p>
         Введём управление. Предполагаем, что на осях располагается
         пара двигателей, причём одна из пар создаёт положительный
         момент, другая &mdash; отрицательный момент. Обозначив
         положительный момент как $u_1 \gt 0$, отрицательный &mdash;
         как $u_2 \gt 0$, приходим к уравнению
         \[
         \ddot \varphi + \omega^2 \varphi = u_1 - u_2.
         \]
         Моменты создаются микродвигателями (считаем, что они
         одинаковые), поэтому они ограничены:
         \[
         0 \leqslant u_i \leqslant \nu_i, \qquad i = 1,2,
         \quad \nu_1 = \nu_2 = \nu = \const \gt 0.
         \]
       </p>

       <p>
         Введём ограничения. Предполагаем, что в начальный момент $t_\text{н} = 0$
         времени было отклонение, то есть
         \[
         \varphi(0) = \psi_0, \qquad \dot \varphi(0) = \dot \psi_0.
         \]
         В конечный момент времени
         $\varphi(t_\text{к}) = 0, \quad \dot \varphi(t_\text{к}) = 0$.
       </p>

       <p>
         Введём критерий качества. Приведём задачу к каноническому
         виду (т.е. к системе ОДУ первого порядка):
         \[
         x_1 = \varphi, \qquad x_2 = \dot \varphi.
         \]
         Тогда
         \[
         \begin{equation}
         \tag{1}
         \begin{aligned}
         \dot x_1 &= x_2, \\
         \dot x_2 &= - \omega^2 x_1 + u_1 - u_2,
         \end{aligned}
         \end{equation}
         \]

         причём
         \[
         \begin{aligned}
         x_1(0) &= x_1^0, & x_2(0) &= x_2^0, \\
         x_1(t_\text{к}) &= 0, & x_2(t_\text{к}) &= 0,
         \end{aligned}
         \tag{2}
         \]

         \[
         0 \leqslant u_{1,2} \leqslant \nu
         \tag{3}
         \]
       </p>

       <div class="remark">
         Условия трансверсальности работать не будут, тк ограничения
         на траекторию мы уже расписали.
       </div>

       <p>
         По теореме Калмана проверяется, что система управляема.
       </p>

       <p>
         Рассмотрим 2 критерия качества: расход топлива
         \[
         \tag{4}
         J_1 = \int\limits_{t_\text{н}}^{t_\text{к}} (u_1 + u_2) dt
         \]
         и задача быстродействия
         \[
         \tag{5}
         J_2 = \int\limits_{t_\text{н}}^{t_\text{к}} dt = t_\text{к} - t_\text{н}.
         \]
       </p>

       <p>
         Почему $J_1$ именно такого вида? Покажем, что именно такой вид пропорционален расходу топлива. Пусть реактивная
         тяга одного микродвигателя обозначается как $\mu u_r$, где $u_r$ &mdash; постоянная относительная (относительно
         спутника) скорость истечения топлива, а $\mu = - \dv{m}{t}$ &mdash; расход топлива.
       </p>

       <p>
         Пусть $\mu_1$ &mdash; расход топлива двух микродвигателей,
         создающих положительный момент. Понятно, что $\mu_1 = 2
         \mu$. Тяга каждого микродвигателя тогда получается как
         $\dfrac{\mu_1}{2} u_r$. Пусть плечо $l$, тогда момент равен
         \[
         m^+ = \dfrac{\mu_1}{2} u_r l.
         \]
         Считаем, что
         \[
         u_1 = \frac{m^+}{I_y}, \qquad
         u_2 = \frac{m^-}{I_y}.
         \]
         Тогда
         \[
         \tag{6}
         \begin{aligned}
         u_1 &= \frac{\mu_1}{2 I_y} u_r l, \\
         u_2 &= \frac{\mu_2}{2 I_y} u_r l.
         \end{aligned}
         \]
         Подставив эти значения в критерий качества $J_1$, получим, что
         \[
         \begin{aligned}
         J_1 &= \int\limits_{t_\text{н}}^{t_\text{к}} \paren{
         \frac{\mu_1}{2 I_y} u_r l + \frac{\mu_2}{2 I_y} u_r l
         } dt = \\
         &= \frac{u_r l}{2 I_y}
         \int\limits_{t_\text{н}}^{t_\text{к}} \paren{\mu_1 + \mu_2} dt.
         \end{aligned}
         \]
         Заметим, что $\mu = \mu_1 + \mu_2 = -\dv{m}{t}$ &mdash;
         полный расход топлива. Проинтегрируем, тогда
         \[
         J_1 = \frac{u_r l}{2 I_y} (m_\text{н} - m_\text{к}).
         \]
       </p>
     </li>

     <li>
       <b>Исследование функции Гамильтона.</b>
       <br/>

       Составим функцию Гамильтона:
       \[
       \tag{7}
       \begin{aligned}
       H &= -F_0 + \lambda f = \\
       &= - (u_1 + u_2) + \lambda_1 x_2 + \lambda_2 (-\omega^2 x_1 + u_1 - u_2).
       \end{aligned}
       \]

       Выпишем уравнения Эйлера-Лагранжа
       \[
       \tag{8}
       \begin{aligned}
       \dot \lambda_1 = - \pd{H}{x_1} = \omega^2 \lambda_2 \\
       \dot \lambda_2 = - \pd{H}{x_2} = - \lambda_1.
       \end{aligned}
       \]
       Тогда
       \[
       \ddot \lambda_2 = - \dot \lambda_1 = - \omega^2 \lambda_2,
       \]
       то есть
       \[
       \ddot \lambda_2 + \omega^2 \lambda_2 = 0.
       \]
       Выпишем решение:
       \[
       \begin{aligned}
       \lambda_1 &= - a \omega \cos(\omega t + \alpha), \\
       \lambda_2 &= \phantom{-} a \sin(\omega t + \alpha),
       \end{aligned}
       \]
       где $a = \const \gt 0$ &mdash; амплитуда, $\alpha = \const$
       &mdash; начальная фаза колебания (находится из начальных
       условий).

       <div class="remark">
         Так как $\lambda_1, \lambda_2$ имеют периодический характер,
         то и управление будет иметь такой же характер.
       </div>

       <p>
         Понятно, что амплитуда $a \neq 0$ (иначе $\lambda = 0$, что невозможно).
       </p>

       <p>
         Вырожденный режим
         \[
         \pd{H}{u_1} = \pd{H}{u_2} = 0
         \]
         в нашем случае невозможен. Следовательно, нет ни одного
         временного промежутка, где оба управления являются
         оптимальными, поэтому эти равенства определяют точки
         переключения соответствующего управления.
       </p>

       <p>
         \[
         \begin{gathered}
         \pd{H}{u_1} = 0, \implies \lambda_2 = 1 \implies \\
         \implies a \sin(\omega t + \alpha) = 1
         \end{gathered}
         \]
         тогда
         \[
         \omega t + \alpha = \frac{\pi}{2} \mp \arccos (1/a) \gt 0,
         \implies a \gt 1.
         \]
         Обозначим $\sigma = \arccos(1/a)$, тогда
         \[
         \omega t + \alpha = \frac{\pi}{2} \mp \sigma + 2 \pi n.
         \]
         Это &mdash; точки переключения первого управления. Если
         $-\sigma$, то точка включения, если $\sigma$ &mdash;
         выключения:
         \[
         \begin{aligned}
         \omega \tau_1 + \alpha &= \frac{\pi}{2} - \sigma + 2 \pi n, \\
         \omega \tau_2 + \alpha &= \frac{\pi}{2} + \sigma + 2 \pi n, & n \in \mathbb{N}.
         \end{aligned}
         \]
         Можно записать как
         \[
         \tag{9}
         \begin{aligned}
         \omega \tau_1 + \alpha &= \frac{\pi}{2} (4 n + 1) - \sigma, \\
         \omega \tau_2 + \alpha &= \frac{\pi}{2} (4 n + 1) + \sigma.
         \end{aligned}
         \]
         Отметим, что $\tau_1 = (\tau_1^0, \tau_1^1, \dots)$ зависит от $n$.
       </p>

       <p>
         Аналогично находим точки переключения управления $u_2$:
         \[
         \tag{10}
         \begin{aligned}
         \omega \tau_3 + \alpha &= \frac{\pi}{2} (4 n + 3) - \sigma, \\
         \omega \tau_4 + \alpha &= \frac{\pi}{2} (4 n + 3) + \sigma,
         \end{aligned}
         \]
         где $\tau_3, \tau_4$ &mdash; точки включения и выключения соответственно.
       </p>

       <p>
         Так как вырожденный режим невозможен, то значение управления равно 0 или $\nu$.
       </p>

       <div class="todo">рисунок 2</div>

       Заметим, что ширина ступеньки одна и та же (равна
       $2\sigma$). Надо найти $\alpha$ и $\sigma$. Начальная фаза
       находится из начальных условий, а вот $\sigma$ найти сложнее.

       <p>
         Ищем $\alpha$. Рассмотрим общее условие трансверсальности:
         \[
         \Delta \varphi_0 + \left.\paren{\lambda \Delta x - H \Delta
         t}\right|_{t_\text{н}}^{t_\text{к}} = 0.
         \]
         Из начальных условий следует, что
         \[
         \varphi_0 = 0, \qquad \Delta x_\text{н} = \Delta x_\text{к} =
         \Delta t_\text{н} = 0.
         \]
         Тогда
         \[
         H_\text{к} \Delta t_\text{к} = 0.
         \]
         Вариации незавимимы, поэтому $H_\text{к} = 0$. Заметим, что
         гамильтониан не зависит явно от $t$, то есть он является
         первым интегралом системы из уравнений движения и уравнений
         Эйлера-Лагранжа. Так как $H_\text{к} = 0$, а $H = \const$, то
         $H \equiv 0$.
       </p>

       <p>
         Рассмотрим $t_\text{н} = 0$: $u_1(0) = u_2(0) = 0$, поэтому
         \[
         \begin{aligned}
         H &= \lambda_1 x_2(0) + \lambda (-\omega^2 x_1(0)) = \\
         &= - a \omega x_2(0) \cos \alpha - a \omega^2 x_1(0) \sin\alpha = 0
         \end{aligned}
         \]
         откуда
         \[
         \tag{11}
         \tg \alpha = - \frac{x_2(0)}{\omega x_1(0)}.
         \]
       </p>

       Осталость только найти $\sigma$ &mdash; займёмся этим позже.
     </li>

     <li>
       <b>Фазовый портрет энергетически оптимальных траекторий.</b>
       <br/>
       Введём обозначение: $u = u_1 - u_2$, причём в любой момент
       времени $u = \const$. Заметим, что оно может принимать только 3
       значения: $(-\nu, 0, \nu)$. Тогда уравнение движения можно
       записать в виде
       \[
       \ddot x_1 + \omega^2 x_1 = u.
       \]
       Решение этого уравнения выглядит в виде
       \[
       \tag{12}
       \begin{aligned}
       x_1 &= b \sin(\omega t + \beta) + u \omega^{-2}, \\
       x_2 &= b \omega \cos(\omega t + \beta),
       \end{aligned}
       \]
       где $b = \const \gt 0$ &mdash; амплитуда фазового движения,
       $\beta = \const$ &mdash; начальная фаза колебания. Какую
       траекторию определяет это движение?

       <p>
         Так как $t_\text{н} = 0: u_1 = 0, u_2 = 0$, то
         \[
         \tag{13}
         \tg \beta = \frac{\omega x_1(0)}{x_2(0)},
         \qquad
         b = \sqrt{(x_1(0))^2 + (x_2(0))^2 \omega^{-2}}
         \]
         Отсюда следует, что
         \[
         \begin{aligned}
         \sin \alpha &= - x_2(0), & \cos \alpha &= \omega x_1(0), \\
         \sin \beta &= \omega x_1(0), & \cos \beta &= x_2(0).
         \end{aligned}
         \]
         То есть
         \[
         \cos \alpha = \sin \beta, \qquad \sin \alpha = - \cos\beta,
         \]
         значит, фазы сдвинуты относительно друг друга на $\pi / 2$, то есть
         \[
         \tag{14}
         \alpha = \beta \pm \frac{\pi}{2}.
         \]
         Так как частота одинаковая, то этот сдвиг по фазе сохраняется
         на всей траектории.
       </p>

       <p>
         Заметим, что $x_1$ сдвинут относительно $x_2$ на $\pi /
         2$. Будем считать, что $\lambda_2$ и $x_2$ находится в
         противофазе.
       </p>

       <p>
         Для получения траектории исключим $t$. Получается, что
         траектории представляют собой окружности
         \[
         \tag{15}
         \paren{\omega x_1 - u \omega^{-1}}^2 + x_2^2 = \omega^2 b^2 = \const.
         \]
         Оси: $\omega x_1, x_2$. Понятно, что в зависимости от
         управления будут получаться разные окружности.
       </p>

       <div class="todo">рисунок 3</div>

       <p>
         Построим линии переключения (тоже на рисунке). Так как
         \[
         \begin{aligned}
         \omega \tau_1 + \alpha &= \frac{\pi}{2} - \sigma, \\
         \omega \tau_2 + \alpha &= \frac{\pi}{2} + \sigma.
         \end{aligned}
         \]
         Отсюда найдём длительность активного участка:
         \[
         \omega (t_2 - \tau_1) = 2 \sigma.
         \]
         Так как
         \[
         \alpha = \beta - \frac{\pi}{2},
         \]
         то
         \[
         \begin{aligned}
         x_1 &= b \sin(\omega t + \beta) + u \omega^{-2} = \\
         &= b \sin (\omega t + \alpha - \frac{\pi}{2}) + u \omega^{-2}.
         \end{aligned}
         \]
         Подставим сюда $t = \tau_1$, получаем
         \[
         \begin{aligned}
         x_1 &= b \sin (\omega t + \alpha - \frac{\pi}{2}) + u \omega^{-2} = \\
         &= b \sin ( \frac{\pi}{2} - \sigma + \frac{\pi}{2}) + u \omega^{-2} = \\
         &= b \sin (\pi - \sigma) + u \omega^{-2} = \\
         &= b \sin \sigma + u \omega^{-2}.
         \end{aligned}
         \]
         Аналогично
         \[
         \begin{aligned}
         x_2 &= b \omega \cos (\omega \tau_1 + \beta) = \\
         &= b \omega \cos (\pi - \sigma) = \\
         &= -b \omega \cos \sigma.
         \end{aligned}
         \]

         Итак,
         \[
         \begin{aligned}
         \omega x_1 &= \phantom{-} b \omega \sin \sigma + u \omega^{-1}, \\
         x_2 &= - b \omega \cos \sigma.
         \end{aligned}
         \]
         Выразим $b \omega$ через $x_1$ и подставим в $x_2$:
         \[
         x_2 = - (\omega x_1 - u \omega^{-1}) \ctg \sigma.
         \]
         Заметим, что $\ctg \sigma = \const$. Получили линейную
         зависимость, то есть прямую. Найдём наклон, взяв производную:
         \[
         \dv{x_2}{(\omega x_1)} = - \ctg \sigma \bydef= \tg \delta,
         \]
         где $\delta$ &mdash; угол наклона. Отсюда следует, что
         \[
         \delta = \frac{\pi}{2} + \sigma.
         \]
         Итак, на этой прямой лежат все точки включения управления $u_1$.
       </p>

       <p>
         Аналогично, подставив вместо $\tau_1$ точку $\tau_2$,
         получим, что угол наклона линии, на которой лежат точки
         выключения, равен
         \[
         \delta = \frac{\pi}{2} - \sigma.
         \]
       </p>

       <p>
         Так как $\lambda_2$ находится с $x_2$ в противофазе, то (?).
       </p>

       <div class="todo">
         Сделать вывод относительно лучей, на которых эти точки
         переключения лежат, учитывая противофазу.
       </div>

       <p>
         Рассмотрим начальную точку $(\omega x_1^\text{н},
         x_2^\text{н})$. Так как начинаем двигаться без управления,
         то точка движется по окружности с центром в точке $O$. После
         переключения движемся по окружности с центром в точке
         $O_1$. Промежуток активного движения длится $2 \sigma$. После
         выключения снова двигаемся по окружности с центром в точке
         $O$, после чего включается второе управление, поэтому
         начинаем двигаться по окружности с центром в $O_2$. И так далее.
       </p>

       <p>
         От чего зависит направление движения фазовой траектории?
         Вспомним, что $\dot x_1 = x_2$. В верхней полуплоскости (где
         $x_2 \gt 0$), точка будет двигаться слева направо ($\dot x_1
         \gt 0$). В нижней полуплоскости соответственно $\dot x_1 \lt
         0$, поэтому двигаемся справа налево.
       </p>

       <p>
         С каждым переключением управления меняется величина $b$, то
         есть радиус окружности. Определим, на сколько один промежуток
         управления уменьшает амплитуду колебания.
       </p>

       <h2>2023-10-05</h2>

       <div class="todo">рис. 1</div>

       Из геометрических соображений найдём, как меняется радиус после включения и выключения управления.

       \[
       b_1^2 \omega^2 = b^2 \omega^2 + \nu^2 \omega^2 - 2 b \nu \cos\paren{\frac{\pi}{2} - \sigma}.
       \]


       Из треугольника $OO_1B$ по теореме косинусов
       \[
       b_2^2 \omega^2 = b_1^2 \omega^2 + \nu^2 \omega^{-2} - 2 b_1 \nu \sin(2 \sigma + \gamma)
       \]

       Из треугольника $ACO_1$ получаем
       \[
       \begin{aligned}
       \sin \gamma &= \frac{\nu \omega^{-1} - b \omega \sin \sigma}{b_1 \omega} \\
       \cos \gamma &= \frac{b \omega \cos \sigma}{b_1 \omega}.
       \end{aligned}
       \]

       Тогда синус суммы углов равен
       \[
       \begin{aligned}
       \sin (2 \sigma + \gamma) &= \frac{b}{b_1} \sin 2\sigma \cos \sigma
        - \frac{b}{b_1} \sin \sigma \cos 2\sigma
        + \frac{\nu}{b_1 \omega^2} \cos 2\sigma = \\
       &= b_1^{-1} \paren{ b \sin\sigma + \nu \omega^{-2} \cos 2\sigma }.
       \end{aligned}
       \]

       Получим разницу между $b \omega$ и $b_1 \omega$:
       \[
       \begin{aligned}
       b_2^2 \omega^2 &= b^2 \omega^2 + 2 \nu^2 \omega^{-2} - 4 b \nu \sin\sigma - 2 \nu^2 \omega^{-2} \cos 2\sigma = \\
       &= (b \omega - 2 \nu \omega^{-1} \sin\sigma)^2,
       \end{aligned}
       \]
       откуда следует, что
       \[
       b_2 = b - 2 \nu \omega^{-2} \sin \sigma,
       \tag{16}
       \]
       поэтому
       \[
       b - b_2 = 2 \nu \omega^{-2} \sin \sigma.
       \tag{17}
       \]

       То есть за один "виток" управления амплитуда уменьшается на это число. Определим время, за которое мы сможем погасить
       колебание.

       <p>
         За один период времени
         \[
         T = \frac{2 \pi}{\omega}
         \]
         амплитуда уменшается на $4 \nu \omega^{-2} \sin \sigma$. Поэтому для погашения начальных колебаний амплитуды $b$
         потребуется время
         \[
         t_\text{д} = \frac{T b}{4 \nu \omega^{-2} \sin \sigma}
         \tag{18}
         \]
         (индекс "д" означает "действие").
       </p>

       <p>
         Рассчитаем функционал
         \[
         J_1 = \int\limits_{t_\text{н}}^{t_\text{к}} (u_1 + u_2) dt.
         \]
         Управления включаются попеременно, причём каждая ступенька имеет ширину $2 \sigma$ и высоту $\nu$. Заметив, что
         включения и выключения происходят периодически, получаем, что
         \[
         J_1 = 4 \sigma \nu \frac{t_\text{д}}{2 \pi} = \frac{4 \sigma \nu t_\text{д}}{\omega T},
         \quad \text{где} \quad
         T = \frac{2 \pi}{\omega}.
         \]

         Откуда
         \[
         J_1 = b \omega \frac{\sigma}{\sin \sigma}
         \tag{19}
         \]

         Так как
         \[
         \lim_{\sigma \to 0} \frac{\sigma}{\sin \sigma} = 1,
         \]
         а при $\sigma \gt 0$ это отношение будет больше 1, то $J_1$ будет стремиться к минимуму, когда $\sigma \to 0$. Так
         как $J_1$ представляет собой сумму площадей под ступенями, то минимизация этих ступений как раз и является нашей
         задачей.
       </p>

       <p>
         Если $\sin \sigma \to 0$, то из формулы (18) $t_\text{д} \to \infty$. Это означает, что теоретически оптимальный
         режим такой, что кусочно-постоянное управление стремится к импульсному, а время действия стремится к
         бесконечности.
       </p>

       <p>
         Дальше считаем, что количество ступеней зафиксировано (значит, фиксировано и $t_\text{д}$). Теоретически можно
         считать, что количество положительных и отрицательных ступеней разное, хотя с точки зрения практики имеет смысл
         взять их одинаковыми.
       </p>
     </li>

     <li>
       <b>Нахождение ширины ступени управления</b>

       <p>
         Геометрически можно найти ширину ступеньки управления (см. Новосёлова, например), но мы построим общий алгоритм
         решения таких задач.
       </p>

       <p>
         Рассмотрим систему уравнений движения (6):
         \[
         \begin{aligned}
         \dot x_1 &= x_2, \\
         \dot x_2 &= - \omega^2 x_1 + u,
         \end{aligned}
         \]
         где
         \[
         \tag{20}
         u = u_1 - u_2, \qquad
         x(0) = \paren{x_1^0, x_2^0}.
         \]
         В матричном виде эта система имеет вид
         \[
         A =
         \begin{pmatrix}
         0 & 1 \\
         -\omega^2 & 0
         \end{pmatrix},
         \quad
         U = \paren{0, u},
         \quad
         x_0 = \paren{x_1^0, x_2^0} = \paren{ \varphi_0, \dot\varphi_0 }
         \]
       </p>

       <div class="remark">
         Если у $A$ вещественные собственные числа, то движение апериодическое.
       </div>

       <p>
         Матрица $A$ имеет пару чисто мнимых собственных значений $\pm i\omega$,
         следовательно, её жорданова форма $Y_A$ &mdash; диагональная матрица. Это
         значит, что существует такая неособая постоянная комплексная матрица $C$, которая
         преобразует $A$ к её жордановой форме:
         \[
         \tag{21}
         C A C^{-1} = Y_A.
         \]
         Одна из матриц, удовлетворяющих (21), может быть такой:
         \[
         C =
         \begin{pmatrix}
         \omega & -i \\
         \omega & \phantom{-}i
         \end{pmatrix}.
         \]
         Сделаем замену переменных: $y = Cx$ тогда уравнения и условия (20) перейдут в
         следующие:
         \[
         \tag{22}
         \dot y = Y_A y + V,
         \]
         где
         \[
         y_0 = Cx_0, \qquad V = CU = \paren{ v_1, v_2 } = \paren{ -iu, iu }.
         \]
         Согласно структуре
         \[
         Y_A =
         \begin{pmatrix}
         i \omega & 0 \\
         0 & -i \omega
         \end{pmatrix},
         \]
         система (22) состоит из двух линейных неоднородных дифференциальных
         уравнений:
         \[
         \tag{22*}
         \begin{aligned}
         \dot y_1 &= \phantom{-} i \omega y_1 + v_1, \\
         \dot y_2 &= -i \omega y_2 + v_2.
         \end{aligned}
         \]
         Новые начальные условия $y_0 = Cx_0$ выглядят так:
         \[
         \begin{aligned}
         y_1^0 &= \omega x_1^0 - i x_2^0, \\
         y_2^0 &= \omega x_1^0 + i x_2^0.
         \end{aligned}
         \]
         Формализуем структуру функций управления через точки переключения:
         \[
         \tag{23}
         u(t) =
         \nu \sum_{i=1}^{2r} (-1)^{i+1} H(t - \tau_i)
         + \nu \sum_{i=1}^{2q} (-1)^i H(t - \tilde \tau_i),
         \]
         где $p,q$ &mdash; количество положительных и отрицательный ступеней
         соответственно, а $H(t - \tau_i)$ &mdash; функция Хевисайда:
         \[
         H(t - \tau_i) =
         \begin{cases}
         1, & t - \tau_i \geqslant 0, \\
         0, & t - \tau_i \lt 0.
         \end{cases}
         \]
         Система (22) (или $(22^*)$) состоит из двух независимых друг от друга уравнений.
         Проинтегрируем их, учитывая при вычислении интегралов структуру управления
         $(23)$. Полученное решение системы (22) имеет вид
         \[
         \begin{aligned}
         y_1 &=
         \left[
         y_1^0 - \frac{\nu}{\omega} \paren{ F_1 - i F_2 }
         \right] \cos \omega t
         +
         \left[
         \phantom{-}i y_1^0 - \frac{i \nu}{\omega} \paren{ F_1 - i F_2 }
         \right] \sin \omega t
         + \frac{u}{\omega}, \\
         y_2 &=
         \left[
         y_2^0 + \frac{\nu}{\omega} \paren{ F_1 - i F_2 }
         \right] \cos \omega t
         +
         \left[
         -i y_2^0 - \frac{i \nu}{\omega} \paren{ F_1 + i F_2 }
         \right] \sin \omega t
         + \frac{u}{\omega},
         \end{aligned}
         \]
         где
         \[
         \begin{aligned}
         F_1 &=
         \sum\limits_{i=1}^{2r} (-1)^{i+1} H(t - \tau_i) \cos \omega \tau_i
         +
         \sum\limits_{i=1}^{2q} (-1)^i H(t - \tilde \tau_i) \cos \omega \tilde \tau_i, \\
         F_2 &=
         \sum\limits_{i=1}^{2r} (-1)^{i+1} H(t - \tau_i) \sin \omega \tau_i
         +
         \sum\limits_{i=1}^{2q} (-1)^i H(t - \tilde \tau_i) \sin \omega \tilde \tau_i.
         \end{aligned}
         \]
         Чтобы решить поставленную задачу гашения колебания частоты $\omega$, потребуем,
         чтобы выражения в квадратных скобках (то есть при $\sin \omega t$ и
         $\cos \omega t$) обнулялись после отработки всех двигателей, то есть
         при $t \gt \tau_{2r}, t \gt \tau_{2q}$
         \[
         \tag{24}
         \begin{aligned}
         y_1^0 - \frac{\nu}{\omega} \paren{ F_1 - i F_2 } &= 0, &
         y_2^0 - \frac{\nu}{\omega} \paren{ F_1 + i F_2 } &= 0, \\
          i y_1^0 - \frac{i \nu}{\omega} \paren{ F_1 - i F_2 } &= 0, &
         -i y_2^0 + \frac{i\nu}{\omega} \paren{ F_1 + i F_2 } &= 0.
         \end{aligned}
         \]
         Легко увидеть, что условия в каждом столбце выражений $(24)$ линейно зависимы
         друг от друга. Таким образом, из четырёх граничных условий остаётся только два,
         и в $(24)$ можно ограничиться только первой строкой.
       </p>

       <p>
         Формулы $(24)$ имеют комплексные коэффициенты, Чтобы перейти от них к
         вещественным коэффициентам, разделим каждое из условий $(24)$ на вещественные
         и мнимые части, принимая во внимание, что
         \[
         y_1^0 = \omega x_1^0 - i x_2^0, \qquad
         y_2^0 = \omega x_1^0 + i x_2^0,
         \]
         тогда
         \[
         \tag{24*}
         \left\{
         \begin{aligned}
         \omega x_1^0 - \frac{\nu}{\omega} F_1
         - i \paren{ x_2^0 - \frac{\nu}{\omega} F_2} &= 0, \\
         \omega x_1^0 - \frac{\nu}{\omega} F_1
         + i \paren{ x_2^0 - \frac{\nu}{\omega} F_2} &= 0.
         \end{aligned}
         \right.
         \]
         Чтобы условия $(24^*)$ выполнялись, необходимо
         (<span class="todo">и достаточно же?</span>), чтобы их вещественная и
         мнимая части были равны нулю. Учитывая, что вещественная часть у двух равенств
         совпадает, а мнимые части отличаются лишь знаком, получим два новых граничных
         условия:
         \[
         \tag{25}
         \omega x_1^0 - \frac{\nu}{\omega} F_1 = 0,
         \qquad
         x_2^0 - \frac{\nu}{\omega} F_2 = 0.
         \]
         Заметим, что все коэффициенты вещественны. С учётом
         $x_1^0 = \varphi_0, x_2^0 = \dot \varphi_0$, можно переписать условия $(25)$ в
         виде
         \[
         K_1 = \omega \varphi_0 - \frac{\nu}{\omega} F_1 = 0, \qquad
         K_2 = \dot \varphi_0 - \frac{\nu}{\omega} F_2 = 0.
         \]
       </p>

       <p>
         Минимизируемый функционал
         \[
         J_1 = \int\limits_{t_\text{н}}^{t_\text{к}} (u_1 + u_2) dt
         \]
         стоит переписать как функцию от точек переключения. Для этого учтём структуру
         управления, а также то, что и в начальный, и в конечный моменты времени
         управляющее воздействие не оказывается. Тогда
         \[
         \tag{26}
         J_1 = \nu
         \left[
         \sum\limits_{i=1}^{2r} (-1)^i \tau_i
         +
         \sum\limits_{i=1}^{2q} (-1)^i \tilde\tau_i
         \right].
         \]
       </p>

       <div class="derivation">
         <div class="todo">расписать?</div>
         Интегрируем по кускам, причём в начале каждого куска начальные условия &mdash;
         то состояние, какое получили на текущий момент.
       </div>

       <p>
         Далее будем решать задачу минимизации функционала $(26)$ при выполнении граничных
         условий $(25^*)$.
       </p>

       <p>
         Чтобы перейти к задаче безусловной минимизации, введём множители Лагранжа
         $\kappa_1$ и $\kappa_2$:
         \[
         R = J_1 + \kappa_1 K_1 + \kappa_2 K_2.
         \]
         Согласно формулам $(25^*)$ и $(26)$, этот функционал зависит от точек
         переключения и множителей Лагранжа:
         \[
         R = R(\kappa_1, \kappa_2, \tau_i, \tilde \tau_j),
         \qquad
         i = \overline{1, 2r}, \quad j = \overline{1, 2q}.
         \]
         Следовательно, необходимые условия минимума этой функции &mdash; условия
         экстремума функции многих переменных:
         \[
         \tag{27}
         \pd{R}{\kappa_1} = 0,
         \quad
         \pd{R}{\kappa_2} = 0,
         \quad
         \pd{R}{\tau_i} = 0,
         \quad
         \pd{R}{\tilde\tau_j} = 0.
         \]
         Заметим, что согласно полученной нами структуре управления (см. рисунок 2)
         ступени управления чередуются и не пересекаются (введённая нами структура
         управления $u(t)$ явно эту информацию не содержит). К тому же, зная точки
         включения $\tau_1$ и выключения $\tau_2$ первого управления, все остальные
         точки переключения можно выразить через них. Эти два факта можно записать в виде
         \[
         \tag{*}
         \begin{aligned}
         \tau_i &= \tilde \tau_i - \frac{\pi}{\omega} + \frac{2 \pi l}{\omega}, \\
         \tau_i &= \tau_{i+2} - \frac{2 \pi}{\omega} + \frac{2 \pi l}{\omega}.
         \end{aligned}
         \]

         С учётом этого первые два условия $(27)$ могут быть переписаны в следующем виде:
         \[
         \tag{28}
         \begin{aligned}
         K_1 &= \omega \varphi_0 + \frac{\nu}{\omega} (r + q)
         \left[ \cos \omega\tau_2 - \cos \omega\tau_1 \right] = 0, \\
         K_2 &= \phantom{\omega} \varphi_0 + \frac{\nu}{\omega} (r + q)
         \left[ \sin \omega\tau_2 - \sin \omega\tau_1 \right] = 0.
         \end{aligned}
         \]
       </p>

       <div class="todo">
         Во втором уравнении стоит $\varphi_0$ или $\dot\varphi_0$. У Потоцкой в конспекте
         скорее всего опечатка &mdash; стоит перепроверить самим.
       </div>

       <p>
         Заметим, что
         \[
         \tau_2 - \tau_1 = 2 \sigma.
         \]
         Пусть $t^*$ &mdash; средний момент ступени управления, тогда
         \[
         \tag{29}
         \tau_1 = t^* - \sigma, \qquad \tau_2 = t^* + \sigma.
         \]

         При подстановке формул $(29)$ в граничные условия $(28)$ приходим к следующим
         соотношениям:
         \[
         \tag{30}
         \begin{aligned}
         K_1 &= \omega \varphi_0 - \frac{2}{\omega} \nu (r + q)
         \sin \omega t^* \sin \omega \sigma = 0, \\
         K_1 &= \phantom{\omega} \dot\varphi_0 + \frac{2}{\omega} \nu (r + q)
         \cos \omega t^* \sin \omega \sigma = 0.
         \end{aligned}
         \]
         Функционал $J_1$ при подстановке $(*)$ и $(29)$ принимает вид
         \[
         \tag{31}
         J_1 = 2 \nu (r + q) \sigma,
         \]
         что полностью соответствует полученной структуре управления (рис. 2) и тому
         смыслу, что функционал представляет собой суммарную площадь всех ступеней
         управления &mdash; математическая модель адекватна.
       </p>

       <p>
         Теперь $J_1, K_1, K_2$ &mdash; функции от $t^*$ и $\sigma$, а исходная задача
         оптимизации свелась к безусловной задаче минимизации функционала
         \[
         R = J_1 + \kappa_1 K_1 + \kappa_2 K_2
         \]
         по переменным $t^*, \sigma, \kappa_1, \kappa_2$:
         \[
         \tag{27*}
         \pd{R}{t^*} = 0,
         \quad
         \pd{R}{\sigma} = 0,
         \quad
         \pd{R}{\kappa_1} = 0,
         \quad
         \pd{R}{\kappa_2} = 0.
         \]
         Два первых уравнения $(27^*)$ приводят к уравнениям
         \[
         \tag{32}
         \begin{aligned}
         \paren{ \kappa_1 \sin \omega t^* + \kappa_2 \cos \omega t^* }
         \cos \omega \sigma &= 1, \\
         \paren{ \kappa_1 \cos \omega t^* - \kappa_2 \sin \omega t^* }
         \sin \omega \sigma &= 0,
         \end{aligned}
         \]
         два последних же &mdash; к уравнениям $(30)$. Таким образом, уравнения
         $(30)$ и $(32)$ представляют собой систему из четырёх уравнений относительно
         четырёх неизвестных.
       </p>

       <p>
         Рассмотрим сначала уравнения $(32)$. Возможны два варианта:
       </p>
       <ol type="I">
         <li>
           $\sin \omega\sigma = 0$. Тогда $\cos \omega\sigma = \pm 1$. В этом случае либо
           $\sigma = 0$ (управление отсутствует), либо $\sigma = \frac{\pi}{\omega}$, и
           управление непрерывно (см. $(*)$). Оба варианта не удовлетворяют требованиям
           поставленной задачи.
         </li>

         <li>
           $\sin \omega\sigma \neq 0$.
         </li>
       </ol>

       <p>
         Первая из формул $(32)$ даёт $\cos \omega\sigma \neq 0$, поэтому можно записать
         \[
         \sin \omega\sigma = \sqrt{ 1 - \cos^2 \omega \sigma }.
         \]

         <div class="remark">
           Согласно рис. 2
           \[
           \omega \sigma \lt \frac{\pi}{2}.
           \]
         </div>

         Так как в этом случае
         \[
         \kappa_1 \cos \omega t^* - \kappa_2 \sin \omega t^* = 0,
         \]
         то из первой формулы $(32)$ получаем
         \[
         \begin{aligned}
         \sin \omega t^*
         &= \frac{\kappa_1}{\cos \omega \sigma (\kappa_1^2 + \kappa_2^2)}, \\
         \cos \omega t^*
         &= \frac{\kappa_2}{\cos \omega \sigma (\kappa_1^2 + \kappa_2^2)}.
         \end{aligned}
         \]

         После подстановки этих выражений в $(30)$ получаем соотношение
         \[
         \kappa_2 = - \frac{\dot \varphi_0}{\omega \varphi_0} \kappa_1.
         \]
         Учитывая его, из тех же граничных условий $(30)$ получаем уравнение для
         нахождения $\kappa_1$:
         \[
         \paren{ \dot\varphi_0^2 + \omega^2 \varphi_0^2 } \kappa_1
         =
         - \frac{2}{\omega} \nu (r + q)
         \sqrt{
         \kappa_1^2 \paren{ \dot\varphi_0^2 + \omega^2 \varphi_0^2 }
         - \omega^2 \varphi_0^2
         }.
         \]
         Отсюда
         \[
         \tag{33}
         \kappa_1^2 = \frac
         {4 \nu^2 (r + q)^2 \omega^2 \varphi_0^2}
         {Z^2 \paren{ 4 \nu^2 (r + q)^2 - \omega^2 Z^2 }},
         \quad \text{где}
         \quad Z^2 = \dot\varphi_0^2 + \omega^2 \varphi_0^2.
         \]

         Из второго уравнения $(32)$ следует, что если
         $\omega t^* \in [0; \pi/2) \cup (\pi/2; \pi]$, то $\omega t^*$ определяется
         однозначно:
         \[
         \tg \omega t^*
         = \frac{\kappa_1}{\kappa_2}
         = - \frac{\omega \varphi_0}{\dot \varphi_0}.
         \]
         Тогда из первой формулы $(32)$ получаем выражение для $\omega \sigma$:
         \[
         \tag{34}
         \cos \omega \sigma =
         \paren{ \kappa_1 \sin \omega t^* + \kappa_2 \cos \omega t^* }^{-1},
         \]
         где:
       </p>

       <ul>
         <li>
           $\kappa_1$ определяется формулой $(33)$,
         </li>

         <li>
           $\kappa_2 = - \dfrac{\dot \varphi_0}{\omega \varphi_0} \kappa_1$,
         </li>

         <li>
           имеют места равенства:
           \[
           \sin \omega t^* = \frac{\omega \varphi_0}{\xi Z},
           \qquad
           \cos \omega t^* = \frac{\dot\varphi_0}{\xi Z},
           \]
           где $\xi := \sign (\omega \varphi_0)$.
         </li>
       </ul>

       Так как $\omega \sigma \lt \dfrac{\pi}{2}$, то
       \[
       \cos \omega \sigma \gt 0, \quad \sin \omega \sigma \gt 0.
       \]
       Следовательно, с учётом $(34)$ и $(35)$ выражения для половины ширины ступени
       управления окончательно выписываются в следующем виде:
       \[
       \tag{36}
       \left\{
       \begin{aligned}
       \cos \omega \sigma &= \frac{\omega z_0 \xi}{\abs{\kappa_1} Z}, \\
       \sin \omega \sigma &= \frac
       {\sqrt{ Z^2 \kappa_1^2 - \omega^2 \varphi_0^2 }}
       {\abs{\kappa_1} Z}.
       \end{aligned}
       \right.
       \]

       <p>
         Таким образом, ширину ступени управления $2 \sigma$ удалось получить с помощью
         явных формул $(36)$ через начальные условия и заданные параметры управления
         (максимальную мощность двигателей $\nu$ и количество включений управления $r+q$).
         Средний момент первой ступени задаётся формулами $(35)$
       </p>

       <p>
         Зная значения $t^*$ и $\sigma$, можно найти момент первого включения управления
         $\tau_1$ и момент выключения первой ступени управления $\tau_2$ по формулам
         $(29)$:
         \[
         \tau_1 = t^* - \sigma, \qquad \tau_2 = t^* + \sigma.
         \]
         Остальные точки переключения $\tau_i$ и $\tilde \tau_i$ могут быть посчитаны
         с помощью $\tau_1$ и $\tau_2$ по формулам $(*)$:
         \[
         \begin{aligned}
         \tau_i &= \tilde \tau_i - \frac{\pi}{\omega} + \frac{2 \pi l}{\omega}, \\
         \tau_i &= \tau_{i+2} - \frac{2 \pi}{\omega} + \frac{2 \pi l}{\omega},
         & l = 0, 1, \dots
         \end{aligned}
         \]
       </p>
     </li>
   </ol>

   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
  </body>
</html>
